{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import{green}from\"@material-ui/core/colors\";import Button from\"@material-ui/core/Button\";import{Grid}from\"@material-ui/core\";import Dialog from\"@material-ui/core/Dialog\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import{i18n}from\"../../translate/i18n\";import TextField from\"@material-ui/core/TextField\";import api from\"../../services/api\";import{Autocomplete}from\"@mui/material\";import Chip from\"@mui/material/Chip\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"},textField:{marginRight:theme.spacing(1),flex:1},extraAttr:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\"},btnWrapper:{position:\"relative\"},buttonProgress:{color:green[500],position:\"absolute\",top:\"50%\",left:\"50%\",marginTop:-12,marginLeft:-12}}));const FlowBuilderAddSwitchFlowModal=_ref=>{let{open,onSave,onUpdate,data,close}=_ref;const classes=useStyles();const isMounted=useRef(true);const initialState={message:\"\",answerKey:\"\"};const[message,setMessage]=useState();const[activeModal,setActiveModal]=useState(false);const[integration,setIntegration]=useState();const[flowsData,setFlowsData]=useState();const[flowsDataObject,setFlowsDataObj]=useState();const[flowSelected,setFlowSelected]=useState();const[labels,setLabels]=useState({title:\"Adicionar Perguta ao fluxo\",btn:\"Adicionar\"});useEffect(()=>{getFlows();if(open===\"edit\"){var _data$data;setLabels({title:\"Editar Perguta do fluxo\",btn:\"Salvar\"});const existing=data===null||data===void 0?void 0:(_data$data=data.data)===null||_data$data===void 0?void 0:_data$data.flowSelected;const selectedName=typeof existing===\"string\"?existing:existing&&typeof existing===\"object\"?existing.name||\"\":\"\";setFlowSelected(selectedName);setActiveModal(true);}else if(open===\"create\"){setLabels({title:\"Cria Perguta no fluxo\",btn:\"Salvar\"});setFlowSelected(\"\");setActiveModal(true);}return()=>{isMounted.current=false;};},[open]);const handleClose=()=>{close(null);setActiveModal(false);};const getFlows=async()=>{return await api.get(\"/flowbuilder\").then(res=>{setFlowsData(res.data.flows.map(flow=>flow.name));setFlowsDataObj(res.data.flows);return res.data.flows;});};const handleSaveContact=values=>{if(open===\"edit\"){handleClose();const selected=flowsDataObject===null||flowsDataObject===void 0?void 0:flowsDataObject.find(flow=>flow.name===flowSelected);const flowSelectedObj=selected?{id:selected.id,name:selected.name}:{name:flowSelected||\"\"};onUpdate(_objectSpread(_objectSpread({},data),{},{data:_objectSpread(_objectSpread({},data.data),{},{flowSelected:flowSelectedObj})}));}else if(open===\"create\"){const selected=flowsDataObject===null||flowsDataObject===void 0?void 0:flowsDataObject.find(flow=>flow.name===flowSelected);const flowSelectedObj=selected?{id:selected.id,name:selected.name}:{name:flowSelected||\"\"};handleClose();onSave({flowSelected:flowSelectedObj});}};return/*#__PURE__*/_jsx(\"div\",{className:classes.root,children:/*#__PURE__*/_jsxs(Dialog,{open:activeModal,onClose:handleClose,fullWidth:true,maxWidth:\"md\",scroll:\"paper\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"form-dialog-title\",children:open===\"create\"?\"Adicionar Troca de Fluxo\":\"Editar Troca de Fluxo\"}),/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsx(Grid,{style:{with:\"100%\",marginTop:10,height:\"250px\"},children:flowsDataObject&&flowsDataObject.length&&/*#__PURE__*/_jsx(Autocomplete,{disablePortal:true,id:\"combo-box-demo\",value:flowSelected||\"\",options:flowsData||[],onChange:(event,newValue)=>{setFlowSelected(newValue);},sx:{width:\"100%\"},renderInput:params=>/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{variant:\"outlined\",placeholder:\"Escolha um fluxo\"})),renderTags:(value,getTagProps)=>value.map((option,index)=>/*#__PURE__*/_jsx(Chip,_objectSpread(_objectSpread({variant:\"outlined\",label:option},getTagProps({index})),{},{style:{borderRadius:\"8px\"}})))})})}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",variant:\"outlined\",children:i18n.t(\"contactModal.buttons.cancel\")}),/*#__PURE__*/_jsx(Button,{type:\"submit\",color:\"primary\",variant:\"contained\",className:classes.btnWrapper,onClick:handleSaveContact,children:open===\"create\"?\"Adicionar\":\"Editar\"})]})]})});};export default FlowBuilderAddSwitchFlowModal;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}