{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{makeStyles,Modal,Backdrop,Fade,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,IconButton}from\"@material-ui/core\";import DeleteIcon from\"@material-ui/icons/Delete\";import CloseIcon from\"@material-ui/icons/Close\";import api from\"../../services/api\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({modal:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},paper:{backgroundColor:theme.palette.background.paper,boxShadow:theme.shadows[5],padding:theme.spacing(2,4,3),borderRadius:\"8px\",overflow:\"auto\",maxHeight:\"80vh\"},closeButton:{position:\"absolute\",top:theme.spacing(1),right:theme.spacing(1)}}));const handleRemoveContactTag=async(contactId,tagId)=>{await api.delete(\"/tags-contacts/\".concat(tagId,\"/\").concat(contactId));};const ContactTagListModal=_ref=>{let{open,onClose,tag}=_ref;const classes=useStyles();const[tagList,setTagList]=useState(tag.contacts);const{user,socket}=useContext(AuthContext);useEffect(()=>{console.log(\"tagList\",tagList);},[tagList]);useEffect(()=>{// const socket = socketManager.GetSocket(user.companyId, user.id);\nconst onCompanyTags=data=>{if(data.action===\"update\"||data.action===\"create\"){var _data$tag,_data$tag$contacts,_data$tag2,_data$tag2$contacts;if(data.tag.id===tag.id&&((_data$tag=data.tag)===null||_data$tag===void 0?void 0:(_data$tag$contacts=_data$tag.contacts)===null||_data$tag$contacts===void 0?void 0:_data$tag$contacts.length)>0){setTagList(data.tag.contacts);}if(data.tag.id===tag.id&&((_data$tag2=data.tag)===null||_data$tag2===void 0?void 0:(_data$tag2$contacts=_data$tag2.contacts)===null||_data$tag2$contacts===void 0?void 0:_data$tag2$contacts.length)===0){setTagList([]);onClose();}}};socket.on(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);return()=>{socket.off(\"company\".concat(user.companyId,\"-tag\"),onCompanyTags);};},[]);// Dependência do estado auxiliar updateFlag\nreturn tagList.length>0?/*#__PURE__*/_jsx(Modal,{className:classes.modal,open:open,onClose:onClose,closeAfterTransition:true,BackdropComponent:Backdrop,BackdropProps:{timeout:500},children:/*#__PURE__*/_jsx(Fade,{in:open,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.paper,children:[/*#__PURE__*/_jsx(IconButton,{className:classes.closeButton,onClick:onClose,children:/*#__PURE__*/_jsx(CloseIcon,{})}),/*#__PURE__*/_jsxs(\"h2\",{id:\"transition-modal-title\",children:[tag.name,\" - Contatos\"]}),/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Nome\"}),/*#__PURE__*/_jsx(TableCell,{children:\"N\\xFAmero\"}),/*#__PURE__*/_jsx(TableCell,{children:\"A\\xE7\\xF5es\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:tagList===null||tagList===void 0?void 0:tagList.map(contact=>/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:contact.id}),/*#__PURE__*/_jsx(TableCell,{children:contact.name}),/*#__PURE__*/_jsx(TableCell,{children:contact.number}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleRemoveContactTag(contact.id,tag.id),children:/*#__PURE__*/_jsx(DeleteIcon,{})})})]},contact.id))})]})})]})})}):/*#__PURE__*/_jsx(_Fragment,{});};export default ContactTagListModal;","map":{"version":3,"names":["React","useContext","useEffect","useState","makeStyles","Modal","Backdrop","Fade","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","IconButton","DeleteIcon","CloseIcon","api","AuthContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useStyles","theme","modal","display","alignItems","justifyContent","paper","backgroundColor","palette","background","boxShadow","shadows","padding","spacing","borderRadius","overflow","maxHeight","closeButton","position","top","right","handleRemoveContactTag","contactId","tagId","delete","concat","ContactTagListModal","_ref","open","onClose","tag","classes","tagList","setTagList","contacts","user","socket","console","log","onCompanyTags","data","action","_data$tag","_data$tag$contacts","_data$tag2","_data$tag2$contacts","id","length","on","companyId","off","className","closeAfterTransition","BackdropComponent","BackdropProps","timeout","children","in","onClick","name","component","map","contact","number"],"sources":["/home/deploy/codigologlow/frontend/src/components/ContactTagListModal/index.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport {\n  makeStyles,\n  Modal,\n  Backdrop,\n  Fade,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  Paper,\n  IconButton,\n} from \"@material-ui/core\";\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport api from \"../../services/api\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nconst useStyles = makeStyles((theme) => ({\n  modal: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  paper: {\n    backgroundColor: theme.palette.background.paper,\n    boxShadow: theme.shadows[5],\n    padding: theme.spacing(2, 4, 3),\n    borderRadius: \"8px\",\n    overflow: \"auto\",\n    maxHeight: \"80vh\",\n  },\n  closeButton: {\n    position: \"absolute\",\n    top: theme.spacing(1),\n    right: theme.spacing(1),\n  },\n}));\n\nconst handleRemoveContactTag = async (contactId, tagId) => {\n  await api.delete(`/tags-contacts/${tagId}/${contactId}`);\n}\n\nconst ContactTagListModal = ({ open, onClose, tag }) => {\n  const classes = useStyles();\n  const [tagList, setTagList] = useState(tag.contacts);\n  const { user, socket } = useContext(AuthContext);\n\n  useEffect(() => {\n    console.log(\"tagList\", tagList)\n  }, [tagList])\n\n  useEffect(() => {\n    // const socket = socketManager.GetSocket(user.companyId, user.id);\n\n    const onCompanyTags = (data) => {\n      if (data.action === \"update\" || data.action === \"create\") {\n        if (data.tag.id === tag.id && data.tag?.contacts?.length > 0) {\n          setTagList(data.tag.contacts);\n        }\n        if (data.tag.id === tag.id && data.tag?.contacts?.length === 0) {\n          setTagList([]);\n          onClose();\n        }\n      }\n    };\n    socket.on(`company${user.companyId}-tag`, onCompanyTags);\n\n    return () => {\n      socket.off(`company${user.companyId}-tag`, onCompanyTags);\n    };\n  }, []); // Dependência do estado auxiliar updateFlag\n\n  return tagList.length > 0 ? (\n    <Modal\n      className={classes.modal}\n      open={open}\n      onClose={onClose}\n      closeAfterTransition\n      BackdropComponent={Backdrop}\n      BackdropProps={{\n        timeout: 500,\n      }}\n    >\n      <Fade in={open}>\n        <div className={classes.paper}>\n          <IconButton className={classes.closeButton} onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n          <h2 id=\"transition-modal-title\">{tag.name} - Contatos</h2>\n          <TableContainer component={Paper}>\n            <Table>\n              <TableHead>\n                <TableRow>\n                  <TableCell>ID</TableCell>\n                  <TableCell>Nome</TableCell>\n                  <TableCell>Número</TableCell>\n                  <TableCell>Ações</TableCell>\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {tagList?.map((contact) => (\n                  <TableRow key={contact.id}>\n                    <TableCell>{contact.id}</TableCell>\n                    <TableCell>{contact.name}</TableCell>\n                    <TableCell>{contact.number}</TableCell>\n                    <TableCell>\n                      <IconButton onClick={() => handleRemoveContactTag(contact.id, tag.id)}>\n                        <DeleteIcon />\n                      </IconButton>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </TableContainer>\n        </div>\n      </Fade>\n    </Modal>\n  ) : (\n    <></>\n  )\n};\n\nexport default ContactTagListModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}