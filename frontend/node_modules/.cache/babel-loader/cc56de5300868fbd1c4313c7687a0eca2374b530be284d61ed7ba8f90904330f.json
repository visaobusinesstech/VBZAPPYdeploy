{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useContext,useEffect,useMemo,useCallback}from\"react\";import clsx from\"clsx\";import{makeStyles,Drawer,AppBar,Toolbar,List,Typography,Divider,Button,MenuItem,IconButton,Menu,useTheme,useMediaQuery,Avatar,Badge,withStyles,Chip,Dialog,DialogTitle,DialogContent,DialogActions,ListItem,ListItemAvatar,ListItemText,FormControlLabel,Checkbox}from\"@material-ui/core\";import MenuIcon from\"@material-ui/icons/Menu\";import ChevronLeftIcon from\"@material-ui/icons/ChevronLeft\";import NotificationsIcon from\"@material-ui/icons/Notifications\";import CachedIcon from\"@material-ui/icons/Cached\";import api from\"../services/api\";import MainListItems from\"./MainListItems\";import NotificationsPopOver from\"../components/NotificationsPopOver\";import NotificationsVolume from\"../components/NotificationsVolume\";import UserModal from\"../components/UserModal\";import{AuthContext}from\"../context/Auth/AuthContext\";import BackdropLoading from\"../components/BackdropLoading\";import{i18n}from\"../translate/i18n\";import toastError from\"../errors/toastError\";import AnnouncementsPopover from\"../components/AnnouncementsPopover\";import BirthdayModal from\"../components/BirthdayModal\";import logo from\"../assets/logo.png\";import logoDark from\"../assets/logo-black.png\";import ChatPopover from\"../pages/Chat/ChatPopover\";import{useDate}from\"../hooks/useDate\";import ColorModeContext from\"../layout/themeContext\";import Brightness4Icon from\"@material-ui/icons/Brightness4\";import Brightness7Icon from\"@material-ui/icons/Brightness7\";import{getBackendUrl}from\"../config\";import useSettings from\"../hooks/useSettings\";import VersionControl from\"../components/VersionControl\";import useSocketListener from\"../hooks/useSocketListener\";import{FaGlobe}from\"react-icons/fa\";import{logInfo,logError}from\"../utils/logger\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const backendUrl=getBackendUrl();const drawerWidth=240;const useStyles=makeStyles(theme=>({root:{display:\"flex\",height:\"100vh\",[theme.breakpoints.down(\"sm\")]:{height:\"calc(100vh - 56px)\"},backgroundColor:theme.palette.fancyBackground,\"& .MuiButton-outlinedPrimary\":{color:theme.palette.primary.main,// Usa cor do tema\nborder:\"1px solid \".concat(theme.palette.primary.main,\"40\"),borderRadius:\"8px\",fontWeight:600,textTransform:\"none\",transition:\"all 0.3s ease\",\"&:hover\":{backgroundColor:\"\".concat(theme.palette.primary.main,\"10\"),borderColor:theme.palette.primary.main,transform:\"translateY(-1px)\",boxShadow:\"0 4px 12px \".concat(theme.palette.primary.main,\"30\")}},\"& .MuiTab-textColorPrimary.Mui-selected\":{color:theme.palette.primary.main,// Usa cor do tema\nfontWeight:700}},chip:{background:\"red\",color:\"white\"},avatar:{width:\"100%\"},toolbar:{paddingRight:24,color:theme.palette.dark.main,// Usa a cor primária do tema para o fundo do AppBar\nbackground:theme.palette.primary.main,// Mudança principal aqui\nboxShadow:\"0 2px 4px rgba(0, 0, 0, 0.1)\",// Sombra sutil\ntransition:\"all 0.3s ease\"},toolbarIcon:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\",padding:\"0 8px\",minHeight:\"48px\",[theme.breakpoints.down(\"sm\")]:{height:\"48px\"},// ALTERAÇÃO: Removido o gradiente e definido fundo branco\nbackgroundColor:\"#ffffff\",// Fundo branco fixo\nborderBottom:\"1px solid \".concat(theme.palette.divider),// Linha sutil para separação\ntransition:\"all 0.3s ease\"},appBar:{zIndex:theme.zIndex.drawer+1,transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen})},appBarShift:{marginLeft:drawerWidth,width:\"calc(100% - \".concat(drawerWidth,\"px)\"),transition:theme.transitions.create([\"width\",\"margin\"],{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),[theme.breakpoints.down(\"sm\")]:{display:\"none\"}},menuButtonHidden:{display:\"none\"},title:{flexGrow:1,fontSize:14,color:\"white\",fontWeight:600,letterSpacing:\"0.025em\"},drawerPaper:{position:\"relative\",whiteSpace:\"nowrap\",width:drawerWidth,transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.enteringScreen}),overflowX:\"hidden\",overflowY:\"hidden\",// Melhorias sutis no drawer\nborderRight:\"1px solid \".concat(theme.mode===\"light\"?\"#e0e0e0\":\"#424242\"),boxShadow:theme.mode===\"light\"?\"2px 0 8px rgba(0, 0, 0, 0.1)\":\"2px 0 8px rgba(0, 0, 0, 0.3)\"},drawerPaperClose:{overflowX:\"hidden\",overflowY:\"hidden\",transition:theme.transitions.create(\"width\",{easing:theme.transitions.easing.sharp,duration:theme.transitions.duration.leavingScreen}),width:theme.spacing(7),[theme.breakpoints.up(\"sm\")]:{width:theme.spacing(9)}},appBarSpacer:{minHeight:\"48px\"},content:{flex:1,overflow:\"auto\",padding:0,margin:0},container:{padding:0,margin:0,maxWidth:\"none\",width:\"100%\"},containerWithScroll:_objectSpread(_objectSpread({flex:1,overflowY:\"scroll\",overflowX:\"hidden\"},theme.scrollbarStyles),{},{borderRadius:\"8px\",border:\"2px solid transparent\",\"&::-webkit-scrollbar\":{display:\"none\"},\"-ms-overflow-style\":\"none\",\"scrollbar-width\":\"none\"}),NotificationsPopOver:{// Mantém original\n},logo:{width:\"100%\",//height: \"45px\",\nmaxWidth:180,[theme.breakpoints.down(\"sm\")]:{width:\"auto\",height:\"100%\",maxWidth:180},logo:theme.logo,content:\"url(\"+(theme.mode===\"light\"?theme.calculatedLogoLight():theme.calculatedLogoDark())+\")\",transition:\"all 0.3s ease\",// Transição suave\n\"&:hover\":{transform:\"scale(1.02)\"// Pequeno zoom no hover\n}},hideLogo:{display:\"none\"},avatar2:{width:theme.spacing(4),height:theme.spacing(4),cursor:\"pointer\",borderRadius:\"50%\",border:\"2px solid #ccc\",transition:\"all 0.3s ease\",\"&:hover\":{transform:\"scale(1.05)\",borderColor:theme.palette.primary.main// Usa cor do tema\n}},updateDiv:{display:\"flex\",flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\"},// Botões da toolbar melhorados\ntoolbarButton:{color:\"rgba(255, 255, 255, 0.9)\",borderRadius:\"8px\",padding:\"8px\",margin:\"0 2px\",transition:\"all 0.3s ease\",\"&:hover\":{backgroundColor:\"rgba(255, 255, 255, 0.1)\",transform:\"translateY(-1px)\"},\"&:active\":{transform:\"translateY(0)\"}},// Menu hambúrguer com animação sutil\nmenuButton:{color:\"white\",\"&:hover\":{backgroundColor:\"rgba(255, 255, 255, 0.1)\"},\"& .MuiSvgIcon-root\":{transition:\"transform 0.3s ease\"},\"&:hover .MuiSvgIcon-root\":{transform:\"rotate(90deg)\"}},// Seletor de idioma melhorado\nlanguageSelector:{position:\"relative\",display:\"inline-block\",\"& > button\":{background:\"rgba(255, 255, 255, 0.1)\",border:\"none\",borderRadius:\"8px\",color:\"rgba(255, 255, 255, 0.9)\",fontSize:\"18px\",padding:\"8px 12px\",cursor:\"pointer\",transition:\"all 0.3s ease\",\"&:hover\":{background:\"rgba(255, 255, 255, 0.2)\",transform:\"translateY(-1px)\"}},\"& > div\":{position:\"absolute\",top:\"45px\",left:\"0\",background:\"#fff\",boxShadow:\"0 4px 12px rgba(0, 0, 0, 0.15)\",borderRadius:\"8px\",padding:\"8px\",zIndex:1000,minWidth:\"120px\",\"& button\":{background:\"none\",border:\"none\",color:\"#374151\",display:\"block\",width:\"100%\",padding:\"8px 12px\",textAlign:\"left\",borderRadius:\"6px\",fontSize:\"14px\",fontWeight:500,transition:\"all 0.2s ease\",\"&:hover\":{background:\"\".concat(theme.palette.primary.main,\"10\"),// Usa cor do tema\ncolor:theme.palette.primary.main,// Usa cor do tema\ntransform:\"none\"}}}},// Badge animado\nanimatedBadge:{\"& .MuiBadge-badge\":{animation:\"$heartbeat 2s infinite\"}},\"@keyframes heartbeat\":{\"0%\":{transform:\"scale(1)\"},\"14%\":{transform:\"scale(1.1)\"},\"28%\":{transform:\"scale(1)\"},\"42%\":{transform:\"scale(1.1)\"},\"70%\":{transform:\"scale(1)\"}}}));const StyledBadge=withStyles(theme=>({badge:{backgroundColor:\"#44b700\",color:\"#44b700\",boxShadow:\"0 0 0 2px \".concat(theme.palette.background.paper),\"&::after\":{position:\"absolute\",top:0,left:0,width:\"100%\",height:\"100%\",borderRadius:\"50%\",animation:\"$ripple 1.2s infinite ease-in-out\",border:\"1px solid currentColor\",content:'\"\"'}},\"@keyframes ripple\":{\"0%\":{transform:\"scale(.8)\",opacity:1},\"100%\":{transform:\"scale(2.4)\",opacity:0}}}))(Badge);const SmallAvatar=withStyles(theme=>({root:{width:22,height:22,border:\"2px solid \".concat(theme.palette.background.paper)}}))(Avatar);const LoggedInLayout=_ref=>{var _user$company,_user$company2,_user$company3,_user$company4;let{children,themeToggle,hideMenu=false}=_ref;const classes=useStyles();const[userModalOpen,setUserModalOpen]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const[menuOpen,setMenuOpen]=useState(false);const{handleLogout,loading,user,socket}=useContext(AuthContext);const[drawerOpen,setDrawerOpen]=useState(false);const[drawerVariant,setDrawerVariant]=useState(\"permanent\");const[showOptions,setShowOptions]=useState(false);const[showAnnouncementsModal,setShowAnnouncementsModal]=useState(false);const[announcements,setAnnouncements]=useState([]);const[selectedAnnouncement,setSelectedAnnouncement]=useState(null);const[ackChecked,setAckChecked]=useState(false);const[showBirthdayModal,setShowBirthdayModal]=useState(false);const theme=useTheme();const{colorMode}=useContext(ColorModeContext);const greaterThenSm=useMediaQuery(theme.breakpoints.up(\"sm\"));const[volume,setVolume]=useState(localStorage.getItem(\"volume\")||1);const{dateToClient}=useDate();const[profileUrl,setProfileUrl]=useState(null);const[updateInProgress,setUpdateInProgress]=useState(false);// eslint-disable-next-line react-hooks/exhaustive-deps\nconst mainListItems=useMemo(()=>/*#__PURE__*/_jsx(MainListItems,{drawerOpen:drawerOpen,collapsed:!drawerOpen}),[user,drawerOpen]);const settings=useSettings();const fetchAnnouncements=useCallback(async()=>{try{const{data}=await api.get(\"/announcements/for-company\",{params:{status:true,pageNumber:\"1\"}});// Filtra apenas os informativos ativos e não expirados\nconst activeAnnouncementsRaw=data.records.filter(announcement=>{const isActive=announcement.status===true||announcement.status===\"true\";const isNotExpired=!announcement.expiresAt||new Date(announcement.expiresAt)>new Date();return isActive&&isNotExpired;});// Backend já filtra por empresa excluindo os reconhecidos\nconst activeAnnouncements=activeAnnouncementsRaw;setAnnouncements(activeAnnouncements);setShowAnnouncementsModal(activeAnnouncements.length>0);}catch(err){toastError(err);}},[user===null||user===void 0?void 0:user.id]);useEffect(()=>{if(user!==null&&user!==void 0&&user.id){fetchAnnouncements();}},[user===null||user===void 0?void 0:user.id,fetchAnnouncements]);// Atualiza checkbox ao trocar de aviso\nuseEffect(()=>{if(!selectedAnnouncement){setAckChecked(false);return;}// Não precisamos mais ler localStorage; tratamos via backend\nsetAckChecked(false);},[selectedAnnouncement,user===null||user===void 0?void 0:user.companyId]);const handleToggleAcknowledge=async(announcementId,checked)=>{try{if(checked){await api.post(\"/announcements/\".concat(announcementId,\"/ack\"));// Remove este aviso da lista\nsetAnnouncements(prev=>prev.filter(a=>a.id!==announcementId));setSelectedAnnouncement(null);}else{await api.delete(\"/announcements/\".concat(announcementId,\"/ack\"));// Opcional: recarregar lista para reexibir (se desejar permitir desfazer)\nawait fetchAnnouncements();}// Fecha modal se não restarem avisos\nsetShowAnnouncementsModal(prev=>{return announcements.length-1>0;});}catch(err){toastError(err);}};useEffect(()=>{if(document.body.offsetWidth>600){if(user.defaultMenu===\"closed\"){setDrawerOpen(false);}else{setDrawerOpen(true);}}if(user.defaultTheme===\"dark\"&&theme.mode===\"light\"){colorMode.toggleColorMode();}},[user.defaultMenu,document.body.offsetWidth]);useEffect(()=>{if(document.body.offsetWidth<600){setDrawerVariant(\"temporary\");}else{setDrawerVariant(\"permanent\");}},[drawerOpen]);useEffect(()=>{const companyId=user===null||user===void 0?void 0:user.companyId;if(companyId){const buildProfileUrl=()=>{const savedProfileImage=localStorage.getItem(\"profileImage\");const currentProfileImage=savedProfileImage||user.profileImage;if(currentProfileImage){return\"\".concat(backendUrl,\"/public/company\").concat(companyId,\"/user/\").concat(currentProfileImage);}return\"\".concat(backendUrl,\"/public/app/noimage.png\");};setProfileUrl(buildProfileUrl());}},[user===null||user===void 0?void 0:user.companyId,user===null||user===void 0?void 0:user.profileImage,backendUrl]);// Callbacks dos eventos\nconst handleAuthEvent=useCallback(data=>{if(data.user.id===+(user===null||user===void 0?void 0:user.id)){toastError(\"Sua conta foi acessada em outro computador.\");setTimeout(()=>{localStorage.clear();window.location.reload();},1000);}},[user===null||user===void 0?void 0:user.id]);const handleUserUpdate=useCallback(data=>{if(data.action===\"update\"&&data.user.id===+(user===null||user===void 0?void 0:user.id)){if(data.user.profileImage){const newProfileUrl=\"\".concat(backendUrl,\"/public/company\").concat(user===null||user===void 0?void 0:user.companyId,\"/user/\").concat(data.user.profileImage);setProfileUrl(newProfileUrl);localStorage.setItem(\"profileImage\",data.user.profileImage);}}},[user===null||user===void 0?void 0:user.companyId,user===null||user===void 0?void 0:user.id,backendUrl]);// Callbacks para eventos de aniversário\nconst handleUserBirthday=useCallback(data=>{logInfo(\"Evento de aniversário de usuário recebido\",{data});if(data.userId===+(user===null||user===void 0?void 0:user.id)){setShowBirthdayModal(true);}},[user===null||user===void 0?void 0:user.id]);const handleContactBirthday=useCallback(data=>{logInfo(\"Evento de aniversário de contato recebido\",{data});},[]);// Verificar aniversários no login\nconst checkBirthdaysOnLogin=useCallback(async()=>{if(user!==null&&user!==void 0&&user.id&&user!==null&&user!==void 0&&user.companyId){try{const{data}=await api.get(\"/birthdays/today\");const birthdayData=data.data;// Verificar se o usuário atual faz aniversário hoje\nconst userBirthday=birthdayData.users.find(u=>u.id===+user.id);if(userBirthday){logInfo(\"Usuário faz aniversário hoje; exibindo modal\");setShowBirthdayModal(true);}// Se há aniversariantes, mostrar notificação\nif(birthdayData.users.length>0||birthdayData.contacts.length>0){logInfo(\"Há aniversariantes hoje\",{birthdayData});}}catch(error){logError(\"Erro ao verificar aniversários\",error);}}},[user===null||user===void 0?void 0:user.id,user===null||user===void 0?void 0:user.companyId]);// Registrar listeners\nuseSocketListener(socket,user,'auth',handleAuthEvent);useSocketListener(socket,user,'user',handleUserUpdate);useSocketListener(socket,user,'user-birthday',handleUserBirthday);useSocketListener(socket,user,'contact-birthday',handleContactBirthday);// Verificar aniversários quando o usuário faz login\nuseEffect(()=>{if(user!==null&&user!==void 0&&user.id&&user!==null&&user!==void 0&&user.companyId){// Pequeno delay para garantir que o socket esteja conectado\nconst timer=setTimeout(()=>{checkBirthdaysOnLogin();},1000);return()=>clearTimeout(timer);}},[user===null||user===void 0?void 0:user.id,user===null||user===void 0?void 0:user.companyId,checkBirthdaysOnLogin]);// Status do usuário\nuseEffect(()=>{if(socket!==null&&socket!==void 0&&socket.emit&&user!==null&&user!==void 0&&user.companyId){socket.emit(\"userStatus\");const interval=setInterval(()=>{(socket===null||socket===void 0?void 0:socket.emit)&&socket.emit(\"userStatus\");},1000*60*5);return()=>clearInterval(interval);}},[socket,user===null||user===void 0?void 0:user.companyId]);const handleUpdateStart=()=>{setUpdateInProgress(true);};const handleUpdateComplete=()=>{setUpdateInProgress(false);};const handleMenu=event=>{setAnchorEl(event.currentTarget);setMenuOpen(true);};const handleCloseMenu=()=>{setAnchorEl(null);setMenuOpen(false);};const handleOpenUserModal=()=>{setUserModalOpen(true);handleCloseMenu();};const handleClickLogout=()=>{handleCloseMenu();handleLogout();};const drawerClose=()=>{if(document.body.offsetWidth<600||user.defaultMenu===\"closed\"){setDrawerOpen(false);}};const handleRefreshPage=()=>{window.location.reload(false);};const handleMenuItemClick=()=>{const{innerWidth:width}=window;if(width<=600){setDrawerOpen(false);}};const handleLanguageChange=lng=>{i18n.changeLanguage(lng);localStorage.setItem(\"language\",lng);window.location.reload();};const LANGUAGE_OPTIONS=[{code:\"pt-BR\",label:\"Português\"},{code:\"en\",label:\"English\"},{code:\"es\",label:\"Spanish\"},{code:\"ar\",label:\"عربي\"}];const[enabledLanguages,setEnabledLanguages]=useState([\"pt-BR\",\"en\"]);const{getAll}=useSettings();useEffect(()=>{async function fetchSettings(){try{var _settings$find;const settings=await getAll();const enabledLanguagesSetting=(_settings$find=settings.find(s=>s.key===\"enabledLanguages\"))===null||_settings$find===void 0?void 0:_settings$find.value;let langs=[\"pt-BR\",\"en\"];try{if(enabledLanguagesSetting){langs=JSON.parse(enabledLanguagesSetting);}}catch(_unused){}console.log(\"Layout - enabledLanguages carregadas:\",langs,\"para companyId:\",user===null||user===void 0?void 0:user.companyId);setEnabledLanguages(langs);}catch(error){console.log(\"Layout - erro ao carregar enabledLanguages:\",error);}}fetchSettings();},[user===null||user===void 0?void 0:user.companyId]);const filteredLanguageOptions=LANGUAGE_OPTIONS.filter(lang=>enabledLanguages.includes(lang.code));if(loading||updateInProgress){return/*#__PURE__*/_jsx(BackdropLoading,{});}return/*#__PURE__*/_jsxs(\"div\",{className:clsx(classes.root,\"logged-in-layout\"),children:[!hideMenu&&/*#__PURE__*/_jsxs(Drawer,{variant:drawerVariant,className:drawerOpen?classes.drawerPaper:classes.drawerPaperClose,classes:{paper:clsx(classes.drawerPaper,!drawerOpen&&classes.drawerPaperClose)},open:drawerOpen,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.toolbarIcon,children:[/*#__PURE__*/_jsx(\"img\",{className:drawerOpen?classes.logo:classes.hideLogo,style:{display:\"block\",margin:\"0 auto\",//height: \"50px\",\nwidth:\"100%\"},alt:\"logo\"}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setDrawerOpen(!drawerOpen),children:/*#__PURE__*/_jsx(ChevronLeftIcon,{})})]}),/*#__PURE__*/_jsx(List,{className:classes.containerWithScroll,children:/*#__PURE__*/_jsx(MainListItems,{collapsed:!drawerOpen})}),/*#__PURE__*/_jsx(Divider,{})]}),/*#__PURE__*/_jsx(AppBar,{position:\"absolute\",className:clsx(classes.appBar,!hideMenu&&drawerOpen&&classes.appBarShift),color:\"primary\",children:/*#__PURE__*/_jsxs(Toolbar,{variant:\"dense\",className:classes.toolbar,children:[!hideMenu&&/*#__PURE__*/_jsx(IconButton,{edge:\"start\",variant:\"contained\",\"aria-label\":\"open drawer\",style:{color:\"white\"},onClick:()=>setDrawerOpen(!drawerOpen),className:clsx(drawerOpen&&classes.menuButtonHidden),children:/*#__PURE__*/_jsx(MenuIcon,{})}),/*#__PURE__*/_jsx(Typography,{component:\"h2\",variant:\"h6\",color:\"inherit\",noWrap:true,className:classes.title,children:greaterThenSm&&(user===null||user===void 0?void 0:user.profile)===\"admin\"&&user!==null&&user!==void 0&&(_user$company=user.company)!==null&&_user$company!==void 0&&_user$company.dueDate?/*#__PURE__*/_jsxs(_Fragment,{children:[i18n.t(\"mainDrawer.appBar.user.message\"),\" \",/*#__PURE__*/_jsx(\"b\",{children:user.name}),\",\",\" \",i18n.t(\"mainDrawer.appBar.user.messageEnd\"),\" \",/*#__PURE__*/_jsx(\"b\",{children:user===null||user===void 0?void 0:(_user$company2=user.company)===null||_user$company2===void 0?void 0:_user$company2.name}),\"! (\",i18n.t(\"mainDrawer.appBar.user.active\"),\" \",dateToClient(user===null||user===void 0?void 0:(_user$company3=user.company)===null||_user$company3===void 0?void 0:_user$company3.dueDate),\")\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[i18n.t(\"mainDrawer.appBar.user.message\"),\" \",/*#__PURE__*/_jsx(\"b\",{children:user.name}),\",\",\" \",i18n.t(\"mainDrawer.appBar.user.messageEnd\"),\" \",/*#__PURE__*/_jsx(\"b\",{children:user===null||user===void 0?void 0:(_user$company4=user.company)===null||_user$company4===void 0?void 0:_user$company4.name}),\"!\"]})}),!hideMenu&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(VersionControl,{onUpdateStart:handleUpdateStart,onUpdateComplete:handleUpdateComplete}),/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\",display:\"inline-block\"},className:\"language-dropdown\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowOptions(!showOptions),style:{background:\"none\",border:\"none\",color:\"white\",cursor:\"pointer\",fontSize:\"22px\",paddingRight:\"20px\",paddingTop:\"8px\"},children:/*#__PURE__*/_jsx(FaGlobe,{})}),showOptions&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:\"35px\",left:\"0\",background:\"#fff\",boxShadow:\"0 2px 6px rgba(0,0,0,0.2)\",borderRadius:\"8px\",padding:\"8px\",zIndex:1000,minWidth:\"120px\",maxWidth:\"200px\"},children:filteredLanguageOptions.map(lang=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLanguageChange(lang.code),style:{background:\"none\",border:\"none\",cursor:\"pointer\",display:\"block\",width:\"100%\",padding:\"4px\"},children:lang.label},lang.code))})]}),/*#__PURE__*/_jsx(IconButton,{edge:\"start\",onClick:colorMode.toggleColorMode,children:theme.mode===\"dark\"?/*#__PURE__*/_jsx(Brightness7Icon,{style:{color:\"white\"}}):/*#__PURE__*/_jsx(Brightness4Icon,{style:{color:\"white\"}})}),/*#__PURE__*/_jsx(NotificationsVolume,{setVolume:setVolume,volume:volume}),/*#__PURE__*/_jsx(IconButton,{onClick:handleRefreshPage,\"aria-label\":i18n.t(\"mainDrawer.appBar.refresh\"),color:\"inherit\",children:/*#__PURE__*/_jsx(CachedIcon,{style:{color:\"white\"}})}),user.id&&/*#__PURE__*/_jsx(NotificationsPopOver,{volume:volume}),/*#__PURE__*/_jsx(AnnouncementsPopover,{}),/*#__PURE__*/_jsx(ChatPopover,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-menu-wrapper\",children:[/*#__PURE__*/_jsx(StyledBadge,{overlap:\"circular\",anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},variant:\"dot\",onClick:handleMenu,children:/*#__PURE__*/_jsx(Avatar,{alt:\"wChat\",className:classes.avatar2,src:profileUrl})}),/*#__PURE__*/_jsx(UserModal,{open:userModalOpen,onClose:()=>setUserModalOpen(false),onImageUpdate:newProfileUrl=>setProfileUrl(newProfileUrl),userId:user===null||user===void 0?void 0:user.id}),/*#__PURE__*/_jsxs(Menu,{id:\"menu-appbar\",anchorEl:anchorEl,getContentAnchorEl:null,anchorOrigin:{vertical:\"bottom\",horizontal:\"right\"},transformOrigin:{vertical:\"top\",horizontal:\"right\"},open:menuOpen,onClose:handleCloseMenu,PaperProps:{style:{minWidth:\"150px\",maxWidth:\"200px\",width:\"auto\"}},children:[/*#__PURE__*/_jsx(MenuItem,{onClick:handleOpenUserModal,children:i18n.t(\"mainDrawer.appBar.user.profile\")}),/*#__PURE__*/_jsx(MenuItem,{onClick:handleClickLogout,children:i18n.t(\"mainDrawer.appBar.user.logout\")})]})]})]})]})}),/*#__PURE__*/_jsxs(\"main\",{className:classes.content,children:[/*#__PURE__*/_jsx(\"div\",{className:classes.appBarSpacer}),children?children:null]}),/*#__PURE__*/_jsxs(Dialog,{open:showAnnouncementsModal,onClose:()=>setShowAnnouncementsModal(false),maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Informativos\"}),/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:selectedAnnouncement?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:selectedAnnouncement.title}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",style:{whiteSpace:'pre-line'},children:selectedAnnouncement.text}),/*#__PURE__*/_jsx(FormControlLabel,{style:{marginTop:12},control:/*#__PURE__*/_jsx(Checkbox,{color:\"primary\",checked:ackChecked,onChange:e=>{const checked=e.target.checked;setAckChecked(checked);handleToggleAcknowledge(selectedAnnouncement.id,checked);}}),label:\"Estou ciente e n\\xE3o mostrar novamente\"}),selectedAnnouncement.mediaPath&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:16},children:/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(backendUrl,\"/public/company\").concat(user.companyId).concat(selectedAnnouncement.mediaPath),alt:\"Anexo\",style:{maxWidth:'100%'}})}),/*#__PURE__*/_jsx(Button,{onClick:()=>setSelectedAnnouncement(null),style:{marginTop:16},variant:\"outlined\",children:\"Voltar para lista\"})]}):/*#__PURE__*/_jsx(List,{children:announcements.map(announcement=>/*#__PURE__*/_jsxs(ListItem,{button:true,onClick:()=>setSelectedAnnouncement(announcement),children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{children:/*#__PURE__*/_jsx(NotificationsIcon,{})})}),/*#__PURE__*/_jsx(ListItemText,{primary:announcement.title,secondary:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Typography,{component:\"span\",variant:\"body2\",color:\"textPrimary\",children:[\"Prioridade: \",announcement.priority===1?'Alta':announcement.priority===2?'Média':'Baixa']}),\" \\u2014 \".concat(new Date(announcement.createdAt).toLocaleDateString())]})})]},announcement.id))})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:()=>setShowAnnouncementsModal(false),color:\"primary\",children:\"Fechar\"})})]}),/*#__PURE__*/_jsx(BirthdayModal,{open:showBirthdayModal,onClose:()=>setShowBirthdayModal(false),user:user})]});};export default LoggedInLayout;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}