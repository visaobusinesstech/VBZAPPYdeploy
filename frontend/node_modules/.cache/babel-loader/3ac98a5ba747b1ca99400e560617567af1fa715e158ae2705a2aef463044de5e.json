{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/**\n * Utilitários para processamento de variáveis globais no Flow Builder\n *//**\n * Substitui todas as referências de variáveis ${nome} em um texto pelo valor correspondente\n * @param {string} text - Texto com referências de variáveis para substituir\n * @returns {string} - Texto com as variáveis substituídas pelos seus valores\n */export const processVariablesInText=text=>{if(!text||typeof text!=='string'||!text.includes('${')){return text;}try{// Regex para encontrar referências no formato ${variavel}\nconst regex=/\\$\\{([^}]+)\\}/g;// Verifica se o objeto de variáveis globais existe\nif(!window.flowVariables){console.warn('window.flowVariables não foi inicializado');return text;}// Mostra as variáveis disponíveis no console para debug\nconsole.log('Variáveis disponíveis:',window.flowVariables);console.log('Texto para processar:',text);// Substitui cada referência pelo valor da variável global\nconst processedText=text.replace(regex,(match,varName)=>{// Verifica se a variável existe no objeto global\nconst varValue=window.flowVariables[varName];console.log(\"Substituindo \".concat(match,\" por\"),varValue);// Se encontrou a variável, substitui pelo valor\nif(varValue!==undefined){return typeof varValue==='object'?JSON.stringify(varValue):String(varValue);}// Se não encontrou, mantém o placeholder original\nconsole.warn(\"Vari\\xE1vel '\".concat(varName,\"' n\\xE3o encontrada\"));return match;});console.log('Texto processado:',processedText);return processedText;}catch(error){console.error('Erro ao processar variáveis no texto:',error);return text;// Em caso de erro, retorna o texto original\n}};/**\n   * Avalia uma expressão JavaScript em um contexto seguro usando as variáveis globais do flow\n   * @param {string} expression - Expressão a ser avaliada\n   * @returns {any} - Resultado da avaliação ou undefined em caso de erro\n   */export const evaluateExpression=expression=>{if(!expression)return undefined;try{// Cria um contexto com todas as variáveis globais\nconst evalContext=_objectSpread({},window.flowVariables);// Cria uma função que avalia a expressão com acesso às variáveis\nconst evalFunc=new Function(...Object.keys(evalContext),\"return \".concat(expression));// Executa a função com os valores das variáveis\nreturn evalFunc(...Object.values(evalContext));}catch(error){console.error(\"Erro ao avaliar express\\xE3o: \".concat(expression),error);return undefined;}};/**\n   * Helper para recuperar valor de variável em qualquer lugar\n   * @param {string} name - Nome da variável\n   * @returns {any} - Valor da variável ou undefined se não existir\n   */export const getFlowVariable=name=>{if(!window.flowVariables)return undefined;return window.flowVariables[name];};/**\n   * Helper para definir valor de variável em qualquer lugar\n   * @param {string} name - Nome da variável\n   * @param {any} value - Valor a ser armazenado\n   * @returns {any} - Valor armazenado\n   */export const setFlowVariable=(name,value)=>{window.flowVariables=window.flowVariables||{};window.flowVariables[name]=value;console.log(\"Vari\\xE1vel \\\"\".concat(name,\"\\\" definida:\"),value);return value;};","map":{"version":3,"names":["processVariablesInText","text","includes","regex","window","flowVariables","console","warn","log","processedText","replace","match","varName","varValue","concat","undefined","JSON","stringify","String","error","evaluateExpression","expression","evalContext","_objectSpread","evalFunc","Function","Object","keys","values","getFlowVariable","name","setFlowVariable","value"],"sources":["/home/deploy/atendechatop/frontend/src/utils/variableUtils.js"],"sourcesContent":["/**\n * Utilitários para processamento de variáveis globais no Flow Builder\n */\n\n/**\n * Substitui todas as referências de variáveis ${nome} em um texto pelo valor correspondente\n * @param {string} text - Texto com referências de variáveis para substituir\n * @returns {string} - Texto com as variáveis substituídas pelos seus valores\n */\nexport const processVariablesInText = (text) => {\n    if (!text || typeof text !== 'string' || !text.includes('${')) {\n      return text;\n    }\n  \n    try {\n      // Regex para encontrar referências no formato ${variavel}\n      const regex = /\\$\\{([^}]+)\\}/g;\n      \n      // Verifica se o objeto de variáveis globais existe\n      if (!window.flowVariables) {\n        console.warn('window.flowVariables não foi inicializado');\n        return text;\n      }\n      \n      // Mostra as variáveis disponíveis no console para debug\n      console.log('Variáveis disponíveis:', window.flowVariables);\n      console.log('Texto para processar:', text);\n      \n      // Substitui cada referência pelo valor da variável global\n      const processedText = text.replace(regex, (match, varName) => {\n        // Verifica se a variável existe no objeto global\n        const varValue = window.flowVariables[varName];\n        console.log(`Substituindo ${match} por`, varValue);\n        \n        // Se encontrou a variável, substitui pelo valor\n        if (varValue !== undefined) {\n          return typeof varValue === 'object' ? JSON.stringify(varValue) : String(varValue);\n        }\n        \n        // Se não encontrou, mantém o placeholder original\n        console.warn(`Variável '${varName}' não encontrada`);\n        return match;\n      });\n      \n      console.log('Texto processado:', processedText);\n      return processedText;\n    } catch (error) {\n      console.error('Erro ao processar variáveis no texto:', error);\n      return text; // Em caso de erro, retorna o texto original\n    }\n  };\n  \n  /**\n   * Avalia uma expressão JavaScript em um contexto seguro usando as variáveis globais do flow\n   * @param {string} expression - Expressão a ser avaliada\n   * @returns {any} - Resultado da avaliação ou undefined em caso de erro\n   */\n  export const evaluateExpression = (expression) => {\n    if (!expression) return undefined;\n    \n    try {\n      // Cria um contexto com todas as variáveis globais\n      const evalContext = { ...window.flowVariables };\n      \n      // Cria uma função que avalia a expressão com acesso às variáveis\n      const evalFunc = new Function(\n        ...Object.keys(evalContext),\n        `return ${expression}`\n      );\n      \n      // Executa a função com os valores das variáveis\n      return evalFunc(...Object.values(evalContext));\n    } catch (error) {\n      console.error(`Erro ao avaliar expressão: ${expression}`, error);\n      return undefined;\n    }\n  };\n  \n  /**\n   * Helper para recuperar valor de variável em qualquer lugar\n   * @param {string} name - Nome da variável\n   * @returns {any} - Valor da variável ou undefined se não existir\n   */\n  export const getFlowVariable = (name) => {\n    if (!window.flowVariables) return undefined;\n    return window.flowVariables[name];\n  };\n  \n  /**\n   * Helper para definir valor de variável em qualquer lugar\n   * @param {string} name - Nome da variável\n   * @param {any} value - Valor a ser armazenado\n   * @returns {any} - Valor armazenado\n   */\n  export const setFlowVariable = (name, value) => {\n    window.flowVariables = window.flowVariables || {};\n    window.flowVariables[name] = value;\n    console.log(`Variável \"${name}\" definida:`, value);\n    return value;\n  };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}