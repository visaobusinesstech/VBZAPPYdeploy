{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _objectWithoutProperties from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";const _excluded=[\"component\",\"isPrivate\"];import React,{useContext}from\"react\";import{Route as RouterRoute,Redirect}from\"react-router-dom\";import moment from\"moment\";import{AuthContext}from\"../context/Auth/AuthContext\";import BackdropLoading from\"../components/BackdropLoading\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const Route=_ref=>{let{component:Component,isPrivate=false}=_ref,rest=_objectWithoutProperties(_ref,_excluded);const{isAuth,loading,user}=useContext(AuthContext);// Verificar se a empresa está vencida\nconst isCompanyExpired=()=>{if(!user||!user.company||user.company.id===1){return false;// Empresa ID 1 nunca expira\n}const dueDate=user.company.dueDate;if(!dueDate)return false;// Comparar apenas as datas (sem horas) para permitir acesso até 23h59 do dia do vencimento\nconst hojeInicio=moment().startOf('day');const vencimentoInicio=moment(dueDate).startOf('day');// Empresa está vencida apenas após o dia do vencimento\nreturn hojeInicio.isAfter(vencimentoInicio,'day');};if(!isAuth&&isPrivate){return/*#__PURE__*/_jsxs(_Fragment,{children:[loading&&/*#__PURE__*/_jsx(BackdropLoading,{}),/*#__PURE__*/_jsx(Redirect,{to:{pathname:\"/login\",state:{from:rest.location}}})]});}if(isAuth&&!isPrivate){return/*#__PURE__*/_jsxs(_Fragment,{children:[loading&&/*#__PURE__*/_jsx(BackdropLoading,{}),/*#__PURE__*/_jsx(Redirect,{to:{pathname:\"/\",state:{from:rest.location}}}),\";\"]});}// Se está autenticado e a empresa está vencida\nif(isAuth&&isPrivate&&isCompanyExpired()){// Permite acesso apenas ao /financeiro-aberto\nif(rest.path!==\"/financeiro-aberto\"){return/*#__PURE__*/_jsxs(_Fragment,{children:[loading&&/*#__PURE__*/_jsx(BackdropLoading,{}),/*#__PURE__*/_jsx(Redirect,{to:{pathname:\"/financeiro-aberto\",state:{from:rest.location}}})]});}}return/*#__PURE__*/_jsxs(_Fragment,{children:[loading&&/*#__PURE__*/_jsx(BackdropLoading,{}),/*#__PURE__*/_jsx(RouterRoute,_objectSpread(_objectSpread({},rest),{},{component:Component}))]});};export default Route;","map":{"version":3,"names":["React","useContext","Route","RouterRoute","Redirect","moment","AuthContext","BackdropLoading","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","_ref","component","Component","isPrivate","rest","_objectWithoutProperties","_excluded","isAuth","loading","user","isCompanyExpired","company","id","dueDate","hojeInicio","startOf","vencimentoInicio","isAfter","children","to","pathname","state","from","location","path","_objectSpread"],"sources":["/home/deploy/atendechatop/frontend/src/routes/Route.js"],"sourcesContent":["import React, { useContext } from \"react\";\nimport { Route as RouterRoute, Redirect } from \"react-router-dom\";\nimport moment from \"moment\";\n\nimport { AuthContext } from \"../context/Auth/AuthContext\";\nimport BackdropLoading from \"../components/BackdropLoading\";\n\nconst Route = ({ component: Component, isPrivate = false, ...rest }) => {\n\tconst { isAuth, loading, user } = useContext(AuthContext);\n\n\t// Verificar se a empresa está vencida\n\tconst isCompanyExpired = () => {\n\t\tif (!user || !user.company || user.company.id === 1) {\n\t\t\treturn false; // Empresa ID 1 nunca expira\n\t\t}\n\n\t\tconst dueDate = user.company.dueDate;\n\t\tif (!dueDate) return false;\n\n\t\t// Comparar apenas as datas (sem horas) para permitir acesso até 23h59 do dia do vencimento\n\t\tconst hojeInicio = moment().startOf('day');\n\t\tconst vencimentoInicio = moment(dueDate).startOf('day');\n\t\t\n\t\t// Empresa está vencida apenas após o dia do vencimento\n\t\treturn hojeInicio.isAfter(vencimentoInicio, 'day');\n\t};\n\n\tif (!isAuth && isPrivate) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{loading && <BackdropLoading />}\n\t\t\t\t<Redirect to={{ pathname: \"/login\", state: { from: rest.location } }} />\n\t\t\t</>\n\t\t);\n\t}\n\n\tif (isAuth && !isPrivate) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{loading && <BackdropLoading />}\n\t\t\t\t<Redirect to={{ pathname: \"/\", state: { from: rest.location } }} />;\n\t\t\t</>\n\t\t);\n\t}\n\n\t// Se está autenticado e a empresa está vencida\n\tif (isAuth && isPrivate && isCompanyExpired()) {\n\t\t// Permite acesso apenas ao /financeiro-aberto\n\t\tif (rest.path !== \"/financeiro-aberto\") {\n\t\t\treturn (\n\t\t\t\t<>\n\t\t\t\t\t{loading && <BackdropLoading />}\n\t\t\t\t\t<Redirect to={{ pathname: \"/financeiro-aberto\", state: { from: rest.location } }} />\n\t\t\t\t</>\n\t\t\t);\n\t\t}\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{loading && <BackdropLoading />}\n\t\t\t<RouterRoute {...rest} component={Component} />\n\t\t</>\n\t);\n};\n\nexport default Route;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}