{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useEffect,useReducer,useRef,useState}from\"react\";import{makeStyles}from\"@material-ui/core/styles\";import toastError from\"../../errors/toastError\";import Popover from\"@material-ui/core/Popover\";import{MdOutlineForum}from\"react-icons/md\";import{Badge,IconButton,List,ListItem,ListItemText,Paper,Typography,MenuItem,DialogTitle,DialogContent,DialogActions,Button,TextField}from\"@material-ui/core\";import api from\"../../services/api\";import{isArray}from\"lodash\";import{useDate}from\"../../hooks/useDate\";import{AuthContext}from\"../../context/Auth/AuthContext\";import notifySound from\"../../assets/chat_notify.mp3\";import useSound from\"use-sound\";import{i18n}from\"../../translate/i18n\";import{useHistory}from\"react-router-dom\";import{format}from\"date-fns\";import{socketConnection}from\"../../services/socket\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({mainPaper:_objectSpread({flex:1,maxHeight:300,maxWidth:500,padding:theme.spacing(1),overflowY:\"scroll\"},theme.scrollbarStyles)}));const reducer=(state,action)=>{if(action.type===\"LOAD_CHATS\"){const chats=action.payload;const newChats=[];if(isArray(chats)){chats.forEach(chat=>{const chatIndex=state.findIndex(u=>u.id===chat.id);if(chatIndex!==-1){state[chatIndex]=chat;}else{newChats.push(chat);}});}return[...state,...newChats];}if(action.type===\"UPDATE_CHATS\"){const chat=action.payload;const chatIndex=state.findIndex(u=>u.id===chat.id);if(chatIndex!==-1){state[chatIndex]=chat;return[...state];}else{return[chat,...state];}}if(action.type===\"DELETE_CHAT\"){const chatId=action.payload;const chatIndex=state.findIndex(u=>u.id===chatId);if(chatIndex!==-1){state.splice(chatIndex,1);}return[...state];}if(action.type===\"RESET\"){return[];}if(action.type===\"CHANGE_CHAT\"){const changedChats=state.map(chat=>{if(chat.id===action.payload.chat.id){return action.payload.chat;}return chat;});return changedChats;}};export default function ChatPopover(volume){const classes=useStyles();//   const socketManager = useContext(SocketContext);\nconst{user:loggedUser,socket}=useContext(AuthContext);const history=useHistory();const historyRef=useRef(history);const[loading,setLoading]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const[pageNumber,setPageNumber]=useState(1);const[hasMore,setHasMore]=useState(false);const[searchParam]=useState(\"\");const[chats,dispatch]=useReducer(reducer,[]);const[invisible,setInvisible]=useState(true);const{datetimeToClient}=useDate();const[play]=useSound(notifySound,volume);const soundAlertRef=useRef();useEffect(()=>{soundAlertRef.current=play;if(!(\"Notification\"in window)){console.log(\"This browser doesn't support notifications\");}else{Notification.requestPermission();}},[play]);useEffect(()=>{dispatch({type:\"RESET\"});setPageNumber(1);},[searchParam]);useEffect(()=>{setLoading(true);const delayDebounceFn=setTimeout(()=>{fetchChats();},500);return()=>clearTimeout(delayDebounceFn);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[searchParam,pageNumber]);useEffect(()=>{if(loggedUser.id){const companyId=loggedUser.companyId;const socket=socketConnection({companyId,userId:loggedUser.id});const onCompanyChatPopover=data=>{if(data.action===\"new-message\"){dispatch({type:\"CHANGE_CHAT\",payload:data});console.log(data);if(data.newMessage.senderId!==loggedUser.id&&data.chat.users.find(user=>user.userId===loggedUser.id)){soundAlertRef.current();// Check if notifications are permitted\nif(Notification.permission===\"granted\"){const notification=new Notification(\"Chat interno nº \"+data.newMessage.chatId,{body:\"\".concat(data.newMessage.sender.name,\": \").concat(data.newMessage.message,\" - \").concat(format(new Date(),\"HH:mm\")),icon:data.newMessage.sender.profileImage});notification.onclick=e=>{e.preventDefault();window.focus();historyRef.current.push(\"/chats/\".concat(data.newMessage.chatId));};}}}if(data.action===\"update\"){dispatch({type:\"CHANGE_CHAT\",payload:data});}};socket.on(\"company-\".concat(companyId,\"-chat\"),onCompanyChatPopover);return()=>{socket.off(\"company-\".concat(companyId,\"-chat\"),onCompanyChatPopover);};}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[loggedUser.id,loggedUser.companyId]);useEffect(()=>{let unreadsCount=0;if(chats.length>0){for(let chat of chats){for(let chatUser of chat.users){if(chatUser.userId===loggedUser.id){unreadsCount+=chatUser.unreads;}}}}if(unreadsCount>0){setInvisible(false);}else{setInvisible(true);}},[chats,loggedUser.id]);const fetchChats=async()=>{try{const{data}=await api.get(\"/chats/\",{params:{searchParam,pageNumber}});dispatch({type:\"LOAD_CHATS\",payload:data.records});setHasMore(data.hasMore);setLoading(false);}catch(err){toastError(err);}};const loadMore=()=>{setPageNumber(prevState=>prevState+1);};const handleScroll=e=>{if(!hasMore||loading)return;const{scrollTop,scrollHeight,clientHeight}=e.currentTarget;if(scrollHeight-(scrollTop+100)<clientHeight){loadMore();}};const handleClick=event=>{setAnchorEl(event.currentTarget);setInvisible(true);};const handleClose=()=>{setAnchorEl(null);};const goToMessages=chat=>{window.location.href=\"/chats/\".concat(chat.uuid);};const open=Boolean(anchorEl);const id=open?\"simple-popover\":undefined;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(IconButton,{\"aria-describedby\":id,variant:\"contained\",color:invisible?\"default\":\"inherit\",onClick:handleClick,style:{color:\"white\"},size:\"large\",children:/*#__PURE__*/_jsx(Badge,{color:\"secondary\",variant:\"dot\",invisible:invisible,children:/*#__PURE__*/_jsx(MdOutlineForum,{size:18})})}),/*#__PURE__*/_jsx(Popover,{id:id,open:open,anchorEl:anchorEl,onClose:handleClose,anchorOrigin:{vertical:\"bottom\",horizontal:\"center\"},transformOrigin:{vertical:\"top\",horizontal:\"center\"},children:/*#__PURE__*/_jsx(Paper,{variant:\"outlined\",onScroll:handleScroll,className:classes.mainPaper,children:/*#__PURE__*/_jsxs(List,{component:\"nav\",\"aria-label\":\"main mailbox folders\",style:{minWidth:300},children:[isArray(chats)&&chats.map((item,key)=>{var _item$lastMessage,_item$lastMessage$sen,_item$lastMessage2;return/*#__PURE__*/_jsx(ListItem,{style:{background:key%2===0?\"#ededed\":\"white\",border:\"1px solid #eee\",cursor:\"pointer\"},onClick:()=>goToMessages(item),button:true,children:/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:\"column\"},children:[/*#__PURE__*/_jsx(Typography,{component:\"span\",style:{fontWeight:\"bold\",fontSize:13},children:typeof item.lastMessage===\"string\"?item.title||\"Chat\":((_item$lastMessage=item.lastMessage)===null||_item$lastMessage===void 0?void 0:(_item$lastMessage$sen=_item$lastMessage.sender)===null||_item$lastMessage$sen===void 0?void 0:_item$lastMessage$sen.name)||item.title||\"Chat\"}),/*#__PURE__*/_jsx(Typography,{component:\"span\",style:{fontSize:12,color:\"#666\"},children:typeof item.lastMessage===\"string\"?item.lastMessage:((_item$lastMessage2=item.lastMessage)===null||_item$lastMessage2===void 0?void 0:_item$lastMessage2.message)||\"Nenhuma mensagem\"})]}),secondary:/*#__PURE__*/_jsx(Typography,{component:\"span\",style:{fontSize:12},children:datetimeToClient(item.updatedAt)})})},key);}),isArray(chats)&&chats.length===0&&/*#__PURE__*/_jsx(ListItemText,{primary:i18n.t(\"mainDrawer.appBar.notRegister\")})]})})})]});}","map":{"version":3,"names":["React","useContext","useEffect","useReducer","useRef","useState","makeStyles","toastError","Popover","MdOutlineForum","Badge","IconButton","List","ListItem","ListItemText","Paper","Typography","MenuItem","DialogTitle","DialogContent","DialogActions","Button","TextField","api","isArray","useDate","AuthContext","notifySound","useSound","i18n","useHistory","format","socketConnection","jsx","_jsx","jsxs","_jsxs","useStyles","theme","mainPaper","_objectSpread","flex","maxHeight","maxWidth","padding","spacing","overflowY","scrollbarStyles","reducer","state","action","type","chats","payload","newChats","forEach","chat","chatIndex","findIndex","u","id","push","chatId","splice","changedChats","map","ChatPopover","volume","classes","user","loggedUser","socket","history","historyRef","loading","setLoading","anchorEl","setAnchorEl","pageNumber","setPageNumber","hasMore","setHasMore","searchParam","dispatch","invisible","setInvisible","datetimeToClient","play","soundAlertRef","current","window","console","log","Notification","requestPermission","delayDebounceFn","setTimeout","fetchChats","clearTimeout","companyId","userId","onCompanyChatPopover","data","newMessage","senderId","users","find","permission","notification","body","concat","sender","name","message","Date","icon","profileImage","onclick","e","preventDefault","focus","on","off","unreadsCount","length","chatUser","unreads","get","params","records","err","loadMore","prevState","handleScroll","scrollTop","scrollHeight","clientHeight","currentTarget","handleClick","event","handleClose","goToMessages","location","href","uuid","open","Boolean","undefined","children","variant","color","onClick","style","size","onClose","anchorOrigin","vertical","horizontal","transformOrigin","onScroll","className","component","minWidth","item","key","_item$lastMessage","_item$lastMessage$sen","_item$lastMessage2","background","border","cursor","button","primary","display","flexDirection","fontWeight","fontSize","lastMessage","title","secondary","updatedAt","t"],"sources":["/home/deploy/atendechatop/frontend/src/pages/Chat/ChatPopover.js"],"sourcesContent":["import React, {\n  useContext,\n  useEffect,\n  useReducer,\n  useRef,\n  useState,\n} from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport toastError from \"../../errors/toastError\";\nimport Popover from \"@material-ui/core/Popover\";\nimport { MdOutlineForum } from \"react-icons/md\";\nimport {\n  Badge,\n  IconButton,\n  List,\n  ListItem,\n  ListItemText,\n  Paper,\n  Typography,\n  MenuItem,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n} from \"@material-ui/core\";\nimport api from \"../../services/api\";\nimport { isArray } from \"lodash\";\nimport { useDate } from \"../../hooks/useDate\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\n\nimport notifySound from \"../../assets/chat_notify.mp3\";\nimport useSound from \"use-sound\";\nimport { i18n } from \"../../translate/i18n\";\nimport { useHistory } from \"react-router-dom\";\nimport { format } from \"date-fns\";\nimport { socketConnection } from \"../../services/socket\";\n\nconst useStyles = makeStyles((theme) => ({\n  mainPaper: {\n    flex: 1,\n    maxHeight: 300,\n    maxWidth: 500,\n    padding: theme.spacing(1),\n    overflowY: \"scroll\",\n    ...theme.scrollbarStyles,\n  },\n}));\n\nconst reducer = (state, action) => {\n  if (action.type === \"LOAD_CHATS\") {\n    const chats = action.payload;\n    const newChats = [];\n\n    if (isArray(chats)) {\n      chats.forEach((chat) => {\n        const chatIndex = state.findIndex((u) => u.id === chat.id);\n        if (chatIndex !== -1) {\n          state[chatIndex] = chat;\n        } else {\n          newChats.push(chat);\n        }\n      });\n    }\n\n    return [...state, ...newChats];\n  }\n\n  if (action.type === \"UPDATE_CHATS\") {\n    const chat = action.payload;\n    const chatIndex = state.findIndex((u) => u.id === chat.id);\n\n    if (chatIndex !== -1) {\n      state[chatIndex] = chat;\n      return [...state];\n    } else {\n      return [chat, ...state];\n    }\n  }\n\n  if (action.type === \"DELETE_CHAT\") {\n    const chatId = action.payload;\n\n    const chatIndex = state.findIndex((u) => u.id === chatId);\n    if (chatIndex !== -1) {\n      state.splice(chatIndex, 1);\n    }\n    return [...state];\n  }\n\n  if (action.type === \"RESET\") {\n    return [];\n  }\n\n  if (action.type === \"CHANGE_CHAT\") {\n    const changedChats = state.map((chat) => {\n      if (chat.id === action.payload.chat.id) {\n        return action.payload.chat;\n      }\n      return chat;\n    });\n    return changedChats;\n  }\n};\n\nexport default function ChatPopover(volume) {\n  const classes = useStyles();\n\n  //   const socketManager = useContext(SocketContext);\n  const { user: loggedUser, socket } = useContext(AuthContext);\n  const history = useHistory();\n\n  const historyRef = useRef(history);\n  const [loading, setLoading] = useState(false);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [pageNumber, setPageNumber] = useState(1);\n  const [hasMore, setHasMore] = useState(false);\n  const [searchParam] = useState(\"\");\n  const [chats, dispatch] = useReducer(reducer, []);\n  const [invisible, setInvisible] = useState(true);\n  const { datetimeToClient } = useDate();\n  const [play] = useSound(notifySound, volume);\n  const soundAlertRef = useRef();\n\n  useEffect(() => {\n    soundAlertRef.current = play;\n\n    if (!(\"Notification\" in window)) {\n      console.log(\"This browser doesn't support notifications\");\n    } else {\n      Notification.requestPermission();\n    }\n  }, [play]);\n\n  useEffect(() => {\n    dispatch({ type: \"RESET\" });\n    setPageNumber(1);\n  }, [searchParam]);\n\n  useEffect(() => {\n    setLoading(true);\n    const delayDebounceFn = setTimeout(() => {\n      fetchChats();\n    }, 500);\n    return () => clearTimeout(delayDebounceFn);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [searchParam, pageNumber]);\n\n  useEffect(() => {\n    if (loggedUser.id) {\n      const companyId = loggedUser.companyId;\n      const socket = socketConnection({ companyId, userId: loggedUser.id });\n\n      const onCompanyChatPopover = (data) => {\n        if (data.action === \"new-message\") {\n          dispatch({ type: \"CHANGE_CHAT\", payload: data });\n          console.log(data);\n          if (\n            data.newMessage.senderId !== loggedUser.id &&\n            data.chat.users.find((user) => user.userId === loggedUser.id)\n          ) {\n            soundAlertRef.current();\n\n            // Check if notifications are permitted\n            if (Notification.permission === \"granted\") {\n              const notification = new Notification(\n                \"Chat interno nº \" + data.newMessage.chatId,\n                {\n                  body: `${data.newMessage.sender.name}: ${\n                    data.newMessage.message\n                  } - ${format(new Date(), \"HH:mm\")}`,\n                  icon: data.newMessage.sender.profileImage,\n                }\n              );\n\n              notification.onclick = (e) => {\n                e.preventDefault();\n                window.focus();\n                historyRef.current.push(`/chats/${data.newMessage.chatId}`);\n              };\n            }\n          }\n        }\n        if (data.action === \"update\") {\n          dispatch({ type: \"CHANGE_CHAT\", payload: data });\n        }\n      };\n\n      socket.on(`company-${companyId}-chat`, onCompanyChatPopover);\n\n      return () => {\n        socket.off(`company-${companyId}-chat`, onCompanyChatPopover);\n      };\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [loggedUser.id, loggedUser.companyId]);\n\n  useEffect(() => {\n    let unreadsCount = 0;\n    if (chats.length > 0) {\n      for (let chat of chats) {\n        for (let chatUser of chat.users) {\n          if (chatUser.userId === loggedUser.id) {\n            unreadsCount += chatUser.unreads;\n          }\n        }\n      }\n    }\n    if (unreadsCount > 0) {\n      setInvisible(false);\n    } else {\n      setInvisible(true);\n    }\n  }, [chats, loggedUser.id]);\n\n  const fetchChats = async () => {\n    try {\n      const { data } = await api.get(\"/chats/\", {\n        params: { searchParam, pageNumber },\n      });\n      dispatch({ type: \"LOAD_CHATS\", payload: data.records });\n      setHasMore(data.hasMore);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n\n  const loadMore = () => {\n    setPageNumber((prevState) => prevState + 1);\n  };\n\n  const handleScroll = (e) => {\n    if (!hasMore || loading) return;\n    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\n    if (scrollHeight - (scrollTop + 100) < clientHeight) {\n      loadMore();\n    }\n  };\n\n  const handleClick = (event) => {\n    setAnchorEl(event.currentTarget);\n    setInvisible(true);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const goToMessages = (chat) => {\n    window.location.href = `/chats/${chat.uuid}`;\n  };\n\n  const open = Boolean(anchorEl);\n  const id = open ? \"simple-popover\" : undefined;\n\n  return (\n    <div>\n      <IconButton\n        aria-describedby={id}\n        variant=\"contained\"\n        color={invisible ? \"default\" : \"inherit\"}\n        onClick={handleClick}\n        style={{ color: \"white\" }}\n        size=\"large\"\n      >\n        <Badge color=\"secondary\" variant=\"dot\" invisible={invisible}>\n          <MdOutlineForum size={18} />\n        </Badge>\n      </IconButton>\n      <Popover\n        id={id}\n        open={open}\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\",\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\",\n        }}\n      >\n        <Paper\n          variant=\"outlined\"\n          onScroll={handleScroll}\n          className={classes.mainPaper}\n        >\n          <List\n            component=\"nav\"\n            aria-label=\"main mailbox folders\"\n            style={{ minWidth: 300 }}\n          >\n            {isArray(chats) &&\n              chats.map((item, key) => (\n                <ListItem\n                  key={key}\n                  style={{\n                    background: key % 2 === 0 ? \"#ededed\" : \"white\",\n                    border: \"1px solid #eee\",\n                    cursor: \"pointer\",\n                  }}\n                  onClick={() => goToMessages(item)}\n                  button\n                >\n                  <ListItemText\n                    primary={\n                      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n                        <Typography\n                          component=\"span\"\n                          style={{ fontWeight: \"bold\", fontSize: 13 }}\n                        >\n                          {typeof item.lastMessage === \"string\"\n                            ? item.title || \"Chat\"\n                            : item.lastMessage?.sender?.name ||\n                              item.title ||\n                              \"Chat\"}\n                        </Typography>\n                        <Typography\n                          component=\"span\"\n                          style={{ fontSize: 12, color: \"#666\" }}\n                        >\n                          {typeof item.lastMessage === \"string\"\n                            ? item.lastMessage\n                            : item.lastMessage?.message || \"Nenhuma mensagem\"}\n                        </Typography>\n                      </div>\n                    }\n                    secondary={\n                      <Typography component=\"span\" style={{ fontSize: 12 }}>\n                        {datetimeToClient(item.updatedAt)}\n                      </Typography>\n                    }\n                  />\n                </ListItem>\n              ))}\n            {isArray(chats) && chats.length === 0 && (\n              <ListItemText primary={i18n.t(\"mainDrawer.appBar.notRegister\")} />\n            )}\n          </List>\n        </Paper>\n      </Popover>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}