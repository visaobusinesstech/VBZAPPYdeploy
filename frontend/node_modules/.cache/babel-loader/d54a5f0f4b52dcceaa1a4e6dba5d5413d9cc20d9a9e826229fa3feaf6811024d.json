{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useState}from\"react\";import{Chip,IconButton,List,ListItem,ListItemSecondaryAction,ListItemText,ListItemAvatar,Avatar,makeStyles,Typography,Menu,MenuItem,Dialog,DialogTitle,DialogContent,DialogActions,Button,TextField,CircularProgress}from\"@material-ui/core\";import{useHistory,useParams}from\"react-router-dom\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{useDate}from\"../../hooks/useDate\";import useOnlineUsers from\"../../hooks/useOnlineUsers\";import{getBackendUrl}from\"../../config\";import{i18n}from\"../../translate/i18n\";import DeleteIcon from\"@material-ui/icons/Delete\";import EditIcon from\"@material-ui/icons/Edit\";import MoreVertIcon from\"@material-ui/icons/MoreVert\";import AddIcon from\"@material-ui/icons/Add\";import SearchIcon from\"@material-ui/icons/Search\";import ConfirmationModal from\"../../components/ConfirmationModal\";import api from\"../../services/api\";import UserStatusIcon from\"../../components/UserModal/statusIcon\";import{toast}from\"react-toastify\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({mainContainer:{display:\"flex\",flexDirection:\"column\",position:\"relative\",flex:1,height:\"calc(100% - 58px)\",overflow:\"hidden\",borderRadius:0,backgroundColor:theme.mode===\"light\"?\"#f2f2f2\":\"#7f7f7f\"},chatList:_objectSpread({display:\"flex\",flexDirection:\"column\",position:\"relative\",flex:1,overflowY:\"scroll\"},theme.scrollbarStyles),listItemActive:{cursor:\"pointer\",backgroundColor:theme.palette.background.paper,borderLeft:\"6px solid #002d6e\"},listItem:{cursor:\"pointer\",backgroundColor:theme.palette.background.color,borderBottom:\"1px solid #eee\",\"&:hover\":{backgroundColor:\"#f5f5f5\"}},avatar:{width:40,height:40,marginRight:10},onlineIndicator:{width:10,height:10,borderRadius:\"50%\",backgroundColor:\"#4CAF50\",position:\"absolute\",bottom:0,right:0,border:\"2px solid white\"},offlineIndicator:{width:10,height:10,borderRadius:\"50%\",backgroundColor:\"#999\",position:\"absolute\",bottom:0,right:0,border:\"2px solid white\"},lastSeen:{fontSize:\"0.75rem\",color:\"#999\"},lastMessage:{fontSize:\"0.875rem\",color:\"#666\",whiteSpace:\"nowrap\",overflow:\"hidden\",textOverflow:\"ellipsis\",maxWidth:\"200px\"},listItemContent:{display:\"flex\",alignItems:\"center\",gap:\"12px\",position:\"relative\",height:\"auto\"},userName:{fontWeight:\"bold\",display:\"flex\",alignItems:\"center\",gap:\"6px\"},messageCount:{marginLeft:\"auto\",fontSize:\"0.75rem\",backgroundColor:\"#1976d2\",color:\"#fff\",borderRadius:\"12px\",padding:\"2px 8px\",minWidth:\"20px\",textAlign:\"center\"}}));export default function ChatList(_ref){var _selectedChat$users;let{chats,handleSelectChat,handleDeleteChat,handleEditChat,pageInfo,loading,findChats}=_ref;const classes=useStyles();const history=useHistory();const{user:loggedInUser,users}=useContext(AuthContext);const{datetimeToClient}=useDate();const[confirmationModal,setConfirmModalOpen]=useState(false);const[selectedChat,setSelectedChat]=useState({});const[anchorEl,setAnchorEl]=useState(null);const[searchTerm,setSearchTerm]=useState(\"\");const[detailsModalOpen,setDetailsModalOpen]=useState(false);const[createChatModalOpen,setCreateChatModalOpen]=useState(false);const[availableUsers,setAvailableUsers]=useState([]);const[usersLoading,setUsersLoading]=useState(false);const[userSearchTerm,setUserSearchTerm]=useState(\"\");const{id}=useParams();// Ordena os chats pelo campo updatedAt antes de filtrar\nconst orderedChats=[...chats].sort((a,b)=>new Date(b.updatedAt)-new Date(a.updatedAt));const filteredChats=orderedChats.filter(chat=>{var _otherUser$user;const isGroup=chat.isGroup;const otherUser=!isGroup&&chat.users.find(u=>u.userId!==loggedInUser.id);const name=isGroup?chat.title:(otherUser===null||otherUser===void 0?void 0:(_otherUser$user=otherUser.user)===null||_otherUser$user===void 0?void 0:_otherUser$user.name)||\"\";const matchesSearch=name.toLowerCase().includes(searchTerm.toLowerCase());return matchesSearch;});const isShowingOnlyGroups=filteredChats.every(chat=>chat.isGroup);const goToMessages=async chat=>{if(unreadMessages(chat)>0){try{await api.post(\"/chats/\".concat(chat.id,\"/read\"),{userId:loggedInUser.id});}catch(err){}}handleSelectChat(chat);if(id!==chat.uuid){history.push(\"/chats/\".concat(chat.uuid));}};const handleDelete=()=>{handleDeleteChat(selectedChat);handleClose();};const unreadMessages=chat=>{const currentUser=chat.users.find(u=>u.userId===loggedInUser.id);return currentUser.unreads;};const getPrimaryText=chat=>{var _otherUser$user2;const isGroup=chat.isGroup;const otherUser=!isGroup&&chat.users.find(u=>u.userId!==loggedInUser.id);const mainText=chat.title;const userName=otherUser===null||otherUser===void 0?void 0:(_otherUser$user2=otherUser.user)===null||_otherUser$user2===void 0?void 0:_otherUser$user2.name;const unreads=unreadMessages(chat);return/*#__PURE__*/_jsxs(_Fragment,{children:[isGroup?mainText:userName,unreads>0&&/*#__PURE__*/_jsx(Chip,{size:\"small\",style:{marginLeft:5},label:unreads,color:\"secondary\"})]});};const getSecondaryText=chat=>{// Prioriza o campo lastMessage retornado do backend\nlet msg=\"\";if(chat.lastMessage&&typeof chat.lastMessage===\"object\"){if(chat.lastMessage.isDeleted){msg=i18n.t(\"chatMessages.deleted\");}else if(chat.lastMessage.mediaType===\"audio\"){msg=\"[Áudio]\";}else if(chat.lastMessage.mediaType===\"image\"){msg=\"[Imagem]\";}else if(chat.lastMessage.mediaType===\"video\"){msg=\"[Vídeo]\";}else if(chat.lastMessage.mediaType&&chat.lastMessage.mediaName){msg=\"[Arquivo] \".concat(chat.lastMessage.mediaName);}else if(chat.lastMessage.message){msg=chat.lastMessage.message;}}else if(typeof chat.lastMessage===\"string\"){msg=chat.lastMessage;}else if(chat.messages&&chat.messages.length>0){const lastMsg=chat.messages[chat.messages.length-1];msg=lastMsg.message;}else{msg=i18n.t(\"chatList.noMessages\");}// Limita o texto a 80 caracteres\nif(msg&&msg.length>40){return msg.substring(0,40)+\"...\";}return msg;};const handleClick=(event,chat)=>{setAnchorEl(event.currentTarget);setSelectedChat(chat);};const handleClose=()=>{setAnchorEl(null);};const handleOpenDetails=()=>{setDetailsModalOpen(true);handleClose();};const handleCloseDetails=()=>{setDetailsModalOpen(false);};const formatLastSeen=date=>{if(!date)return\"\";const lastSeen=new Date(date);const now=new Date();const diff=now-lastSeen;if(diff<60000)return i18n.t(\"chatList.now\");if(diff<3600000)return i18n.t(\"chatList.minutesAgo\",{count:Math.floor(diff/60000)});if(diff<86400000)return i18n.t(\"chatList.hoursAgo\",{count:Math.floor(diff/3600000)});return lastSeen.toLocaleDateString();};const loadUsers=async()=>{try{setUsersLoading(true);const{data}=await api.get(\"/users/list\");// Filtrar o usuário logado da lista\nconst filteredUsers=data.filter(user=>user.id!==loggedInUser.id);setAvailableUsers(filteredUsers);}catch(err){console.error(err);toast.error(\"Erro ao carregar usuários\");}finally{setUsersLoading(false);}};const handleOpenCreateChat=()=>{setCreateChatModalOpen(true);setUserSearchTerm(\"\");loadUsers();};const handleCloseCreateChat=()=>{setCreateChatModalOpen(false);setUserSearchTerm(\"\");};const handleCreateChatWithUser=async selectedUser=>{try{// Verificar se já existe um chat com este usuário\nconst existingChat=chats.find(c=>{const hasSelectedUser=c.users.some(u=>u.userId===selectedUser.id);const hasLoggedInUser=c.users.some(u=>u.userId===loggedInUser.id);const isIndividualChat=!c.isGroup&&c.users.length===2;return isIndividualChat&&hasSelectedUser&&hasLoggedInUser;});if(existingChat){toast.info(\"Chat com este usuário já existe!\");handleSelectChat(existingChat);handleCloseCreateChat();return;}// Criar novo chat\nconst{data}=await api.post(\"/chats\",{users:[{id:selectedUser.id}],isGroup:false});toast.success(\"Chat criado com sucesso!\");// Atualizar a lista de chats\nif(findChats){await findChats();}handleSelectChat(data);handleCloseCreateChat();}catch(err){console.error(err);toast.error(\"Erro ao criar chat\");}};const filteredAvailableUsers=availableUsers.filter(user=>user.name.toLowerCase().includes(userSearchTerm.toLowerCase()));return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Menu,{id:\"simple-menu\",anchorEl:anchorEl,keepMounted:true,open:Boolean(anchorEl),onClose:handleClose,children:[selectedChat.ownerId===loggedInUser.id&&selectedChat.isGroup&&/*#__PURE__*/_jsx(MenuItem,{onClick:()=>handleEditChat(selectedChat),children:i18n.t(\"chatList.edit\")}),loggedInUser.profile===\"admin\"&&/*#__PURE__*/_jsx(MenuItem,{onClick:()=>handleDeleteChat(selectedChat),children:i18n.t(\"chatList.delete\")}),selectedChat.isGroup&&/*#__PURE__*/_jsx(MenuItem,{onClick:handleOpenDetails,children:i18n.t(\"chatList.details\")})]}),/*#__PURE__*/_jsx(ConfirmationModal,{title:i18n.t(\"chatList.deleteChat\"),open:confirmationModal,onClose:()=>setConfirmModalOpen(false),onConfirm:handleDelete,children:i18n.t(\"chatList.deleteChatConfirm\")}),/*#__PURE__*/_jsx(ConfirmationModal,{title:i18n.t(\"chatList.detailsTitle\"),open:detailsModalOpen,onClose:handleCloseDetails,children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"20px\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:\"center\",marginBottom:\"20px\"},children:[/*#__PURE__*/_jsx(Avatar,{src:selectedChat!==null&&selectedChat!==void 0&&selectedChat.groupImage?selectedChat.groupImage.startsWith(\"http\")?selectedChat.groupImage:\"\".concat(getBackendUrl()).concat(selectedChat.groupImage):null,style:{width:100,height:100,margin:\"0 auto\"}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",style:{marginTop:\"10px\"},children:selectedChat===null||selectedChat===void 0?void 0:selectedChat.title}),(selectedChat===null||selectedChat===void 0?void 0:selectedChat.description)&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",children:selectedChat.description})]}),/*#__PURE__*/_jsx(List,{children:selectedChat===null||selectedChat===void 0?void 0:(_selectedChat$users=selectedChat.users)===null||_selectedChat$users===void 0?void 0:_selectedChat$users.map(user=>{var _user$user,_user$user2;return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{src:(_user$user=user.user)!==null&&_user$user!==void 0&&_user$user.profileImage?\"\".concat(getBackendUrl(),\"/public/company\").concat(user.user.companyId,\"/user/\").concat(user.user.profileImage):null})}),/*#__PURE__*/_jsx(ListItemText,{primary:(_user$user2=user.user)===null||_user$user2===void 0?void 0:_user$user2.name,secondary:user.userId===selectedChat.ownerId?i18n.t(\"chatList.admin\"):i18n.t(\"chatList.member\")})]},user.userId);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.mainContainer,children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"10px\",display:\"flex\",gap:\"10px\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:i18n.t(\"chatList.searchChat\"),value:searchTerm,onChange:e=>setSearchTerm(e.target.value),style:{flex:1,padding:\"8px 12px\",borderRadius:\"20px\",border:\"1px solid #ccc\",outline:\"none\"}}),!isShowingOnlyGroups&&/*#__PURE__*/_jsx(IconButton,{onClick:handleOpenCreateChat,style:{backgroundColor:\"#1976d2\",color:\"white\",width:\"40px\",height:\"40px\"},title:i18n.t(\"chatList.createNewChat\"),children:/*#__PURE__*/_jsx(AddIcon,{})})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.chatList,children:/*#__PURE__*/_jsxs(List,{children:[console.log(\"Renderizando lista com\",filteredChats.length,\"chats\"),filteredChats.map((chat,key)=>{var _otherUser$user3,_chat$users;const isGroup=chat.isGroup;const otherUser=!isGroup&&chat.users.find(u=>u.userId!==loggedInUser.id);const isOnline=!isGroup&&otherUser&&(availableUsers===null||availableUsers===void 0?void 0:availableUsers.some(u=>u.id===otherUser.user.id));console.log(\"Renderizando chat \".concat(key,\":\"),{id:chat.id,uuid:chat.uuid,isGroup:isGroup,title:chat.title,name:otherUser===null||otherUser===void 0?void 0:(_otherUser$user3=otherUser.user)===null||_otherUser$user3===void 0?void 0:_otherUser$user3.name,users:(_chat$users=chat.users)===null||_chat$users===void 0?void 0:_chat$users.length});return/*#__PURE__*/_jsxs(ListItem,{button:true,onClick:()=>goToMessages(chat),className:chat.uuid===id?classes.listItemActive:classes.listItem,children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(\"div\",{style:{position:\"relative\"},children:/*#__PURE__*/_jsx(Avatar,{src:isGroup?chat.groupImage?chat.groupImage.startsWith(\"http\")?chat.groupImage:\"\".concat(getBackendUrl()).concat(chat.groupImage):undefined:otherUser&&otherUser.user&&otherUser.user.profileImage?otherUser.user.profileImage.startsWith(\"http\")?otherUser.user.profileImage:\"\".concat(getBackendUrl(),\"/public/company\").concat(otherUser.user.companyId,\"/user/\").concat(otherUser.user.profileImage):undefined,className:classes.avatar,children:isGroup?chat.title?chat.title.charAt(0):\"G\":otherUser&&otherUser.user&&otherUser.user.name?otherUser.user.name.charAt(0):\"?\"})})}),/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsxs(\"div\",{className:classes.listItemContent,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.userName,children:[/*#__PURE__*/_jsx(Typography,{component:\"div\",variant:\"subtitle1\",className:classes.userName,children:isGroup?chat.title||\"Grupo\":otherUser&&otherUser.user&&otherUser.user.name?otherUser.user.name:\"Usuário\"}),!isGroup&&/*#__PURE__*/_jsx(UserStatusIcon,{user:otherUser===null||otherUser===void 0?void 0:otherUser.user})]}),unreadMessages(chat)>0&&/*#__PURE__*/_jsx(\"div\",{style:{width:16,height:16,borderRadius:\"50%\",background:\"red\",color:\"white\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",fontSize:12,marginLeft:8},children:unreadMessages(chat)})]}),secondary:/*#__PURE__*/_jsx(Typography,{component:\"div\",variant:\"body2\",style:{color:\"gray\"},children:getSecondaryText(chat)})}),(loggedInUser.profile===\"admin\"||selectedChat.ownerId===loggedInUser.id&&selectedChat.isGroup)&&/*#__PURE__*/_jsx(IconButton,{edge:\"end\",\"aria-label\":\"more\",onClick:e=>handleClick(e,chat),children:/*#__PURE__*/_jsx(MoreVertIcon,{})})]},key);})]})})]}),/*#__PURE__*/_jsxs(Dialog,{open:createChatModalOpen,onClose:handleCloseCreateChat,maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:\"10px\"},children:[/*#__PURE__*/_jsx(AddIcon,{style:{color:\"#1976d2\"}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",children:i18n.t(\"chatList.createNewChat\")})]})}),/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:i18n.t(\"chatList.searchUser\"),value:userSearchTerm,onChange:e=>setUserSearchTerm(e.target.value),style:{marginBottom:\"20px\",marginTop:\"10px\"},InputProps:{startAdornment:/*#__PURE__*/_jsx(SearchIcon,{style:{marginRight:\"8px\",color:\"#666\"}})}}),usersLoading?/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\",justifyContent:\"center\",padding:\"20px\"},children:/*#__PURE__*/_jsx(CircularProgress,{})}):/*#__PURE__*/_jsxs(List,{style:{maxHeight:\"400px\",overflow:\"auto\"},children:[filteredAvailableUsers.map(user=>{var _user$profileImage;return/*#__PURE__*/_jsxs(ListItem,{button:true,onClick:()=>handleCreateChatWithUser(user),style:{borderRadius:\"8px\",marginBottom:\"4px\"},children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{src:user!==null&&user!==void 0&&(_user$profileImage=user.profileImage)!==null&&_user$profileImage!==void 0&&_user$profileImage.startsWith(\"http\")?user.profileImage:\"\".concat(getBackendUrl(),\"/public/company\").concat(user.companyId,\"/user/\").concat(user.profileImage)})}),/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",alignItems:\"center\",gap:\"8px\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:user.name}),/*#__PURE__*/_jsx(UserStatusIcon,{user:user})]}),secondary:user.email})]},user.userId);}),filteredAvailableUsers.length===0&&!usersLoading&&/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"center\",padding:\"20px\",color:\"#666\"},children:userSearchTerm?i18n.t(\"chatList.noUserFound\"):i18n.t(\"chatList.noUserAvailable\")})]})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleCloseCreateChat,color:\"secondary\",children:i18n.t(\"chatList.cancel\")})})]})]});}","map":{"version":3,"names":["React","useContext","useState","Chip","IconButton","List","ListItem","ListItemSecondaryAction","ListItemText","ListItemAvatar","Avatar","makeStyles","Typography","Menu","MenuItem","Dialog","DialogTitle","DialogContent","DialogActions","Button","TextField","CircularProgress","useHistory","useParams","AuthContext","useDate","useOnlineUsers","getBackendUrl","i18n","DeleteIcon","EditIcon","MoreVertIcon","AddIcon","SearchIcon","ConfirmationModal","api","UserStatusIcon","toast","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","useStyles","theme","mainContainer","display","flexDirection","position","flex","height","overflow","borderRadius","backgroundColor","mode","chatList","_objectSpread","overflowY","scrollbarStyles","listItemActive","cursor","palette","background","paper","borderLeft","listItem","color","borderBottom","avatar","width","marginRight","onlineIndicator","bottom","right","border","offlineIndicator","lastSeen","fontSize","lastMessage","whiteSpace","textOverflow","maxWidth","listItemContent","alignItems","gap","userName","fontWeight","messageCount","marginLeft","padding","minWidth","textAlign","ChatList","_ref","_selectedChat$users","chats","handleSelectChat","handleDeleteChat","handleEditChat","pageInfo","loading","findChats","classes","history","user","loggedInUser","users","datetimeToClient","confirmationModal","setConfirmModalOpen","selectedChat","setSelectedChat","anchorEl","setAnchorEl","searchTerm","setSearchTerm","detailsModalOpen","setDetailsModalOpen","createChatModalOpen","setCreateChatModalOpen","availableUsers","setAvailableUsers","usersLoading","setUsersLoading","userSearchTerm","setUserSearchTerm","id","orderedChats","sort","a","b","Date","updatedAt","filteredChats","filter","chat","_otherUser$user","isGroup","otherUser","find","u","userId","name","title","matchesSearch","toLowerCase","includes","isShowingOnlyGroups","every","goToMessages","unreadMessages","post","concat","err","uuid","push","handleDelete","handleClose","currentUser","unreads","getPrimaryText","_otherUser$user2","mainText","children","size","style","label","getSecondaryText","msg","isDeleted","t","mediaType","mediaName","message","messages","length","lastMsg","substring","handleClick","event","currentTarget","handleOpenDetails","handleCloseDetails","formatLastSeen","date","now","diff","count","Math","floor","toLocaleDateString","loadUsers","data","get","filteredUsers","console","error","handleOpenCreateChat","handleCloseCreateChat","handleCreateChatWithUser","selectedUser","existingChat","c","hasSelectedUser","some","hasLoggedInUser","isIndividualChat","info","success","filteredAvailableUsers","keepMounted","open","Boolean","onClose","ownerId","onClick","profile","onConfirm","marginBottom","src","groupImage","startsWith","margin","variant","marginTop","description","map","_user$user","_user$user2","profileImage","companyId","primary","secondary","className","type","placeholder","value","onChange","e","target","outline","log","key","_otherUser$user3","_chat$users","isOnline","button","undefined","charAt","component","justifyContent","edge","fullWidth","InputProps","startAdornment","maxHeight","_user$profileImage","email"],"sources":["/home/deploy/atendechatop/frontend/src/pages/Chat/ChatList.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport {\n  Chip,\n  IconButton,\n  List,\n  ListItem,\n  ListItemSecondaryAction,\n  ListItemText,\n  ListItemAvatar,\n  Avatar,\n  makeStyles,\n  Typography,\n  Menu,\n  MenuItem,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  Button,\n  TextField,\n  CircularProgress,\n} from \"@material-ui/core\";\n\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { useDate } from \"../../hooks/useDate\";\nimport useOnlineUsers from \"../../hooks/useOnlineUsers\";\nimport { getBackendUrl } from \"../../config\";\nimport { i18n } from \"../../translate/i18n\";\n\nimport DeleteIcon from \"@material-ui/icons/Delete\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport MoreVertIcon from \"@material-ui/icons/MoreVert\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport SearchIcon from \"@material-ui/icons/Search\";\n\nimport ConfirmationModal from \"../../components/ConfirmationModal\";\nimport api from \"../../services/api\";\nimport UserStatusIcon from \"../../components/UserModal/statusIcon\";\nimport { toast } from \"react-toastify\";\n\nconst useStyles = makeStyles((theme) => ({\n  mainContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    position: \"relative\",\n    flex: 1,\n    height: \"calc(100% - 58px)\",\n    overflow: \"hidden\",\n    borderRadius: 0,\n    backgroundColor: theme.mode === \"light\" ? \"#f2f2f2\" : \"#7f7f7f\",\n  },\n  chatList: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    position: \"relative\",\n    flex: 1,\n    overflowY: \"scroll\",\n    ...theme.scrollbarStyles,\n  },\n  listItemActive: {\n    cursor: \"pointer\",\n    backgroundColor: theme.palette.background.paper,\n    borderLeft: \"6px solid #002d6e\",\n  },\n  listItem: {\n    cursor: \"pointer\",\n    backgroundColor: theme.palette.background.color,\n    borderBottom: \"1px solid #eee\",\n    \"&:hover\": {\n      backgroundColor: \"#f5f5f5\",\n    },\n  },\n  avatar: {\n    width: 40,\n    height: 40,\n    marginRight: 10,\n  },\n  onlineIndicator: {\n    width: 10,\n    height: 10,\n    borderRadius: \"50%\",\n    backgroundColor: \"#4CAF50\",\n    position: \"absolute\",\n    bottom: 0,\n    right: 0,\n    border: \"2px solid white\",\n  },\n  offlineIndicator: {\n    width: 10,\n    height: 10,\n    borderRadius: \"50%\",\n    backgroundColor: \"#999\",\n    position: \"absolute\",\n    bottom: 0,\n    right: 0,\n    border: \"2px solid white\",\n  },\n  lastSeen: {\n    fontSize: \"0.75rem\",\n    color: \"#999\",\n  },\n  lastMessage: {\n    fontSize: \"0.875rem\",\n    color: \"#666\",\n    whiteSpace: \"nowrap\",\n    overflow: \"hidden\",\n    textOverflow: \"ellipsis\",\n    maxWidth: \"200px\",\n  },\n  listItemContent: {\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: \"12px\",\n    position: \"relative\",\n    height: \"auto\",\n  },\n\n  userName: {\n    fontWeight: \"bold\",\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: \"6px\",\n  },\n\n  messageCount: {\n    marginLeft: \"auto\",\n    fontSize: \"0.75rem\",\n    backgroundColor: \"#1976d2\",\n    color: \"#fff\",\n    borderRadius: \"12px\",\n    padding: \"2px 8px\",\n    minWidth: \"20px\",\n    textAlign: \"center\",\n  },\n}));\n\nexport default function ChatList({\n  chats,\n  handleSelectChat,\n  handleDeleteChat,\n  handleEditChat,\n  pageInfo,\n  loading,\n  findChats,\n}) {\n  const classes = useStyles();\n  const history = useHistory();\n  const { user: loggedInUser, users } = useContext(AuthContext);\n  const { datetimeToClient } = useDate();\n\n  const [confirmationModal, setConfirmModalOpen] = useState(false);\n  const [selectedChat, setSelectedChat] = useState({});\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [detailsModalOpen, setDetailsModalOpen] = useState(false);\n  const [createChatModalOpen, setCreateChatModalOpen] = useState(false);\n  const [availableUsers, setAvailableUsers] = useState([]);\n  const [usersLoading, setUsersLoading] = useState(false);\n  const [userSearchTerm, setUserSearchTerm] = useState(\"\");\n\n  const { id } = useParams();\n\n  // Ordena os chats pelo campo updatedAt antes de filtrar\n  const orderedChats = [...chats].sort(\n    (a, b) => new Date(b.updatedAt) - new Date(a.updatedAt)\n  );\n\n  const filteredChats = orderedChats.filter((chat) => {\n    const isGroup = chat.isGroup;\n    const otherUser =\n      !isGroup && chat.users.find((u) => u.userId !== loggedInUser.id);\n    const name = isGroup ? chat.title : otherUser?.user?.name || \"\";\n    const matchesSearch = name.toLowerCase().includes(searchTerm.toLowerCase());\n\n    return matchesSearch;\n  });\n\n  const isShowingOnlyGroups = filteredChats.every((chat) => chat.isGroup);\n\n  const goToMessages = async (chat) => {\n    if (unreadMessages(chat) > 0) {\n      try {\n        await api.post(`/chats/${chat.id}/read`, { userId: loggedInUser.id });\n      } catch (err) {}\n    }\n    handleSelectChat(chat);\n    if (id !== chat.uuid) {\n      history.push(`/chats/${chat.uuid}`);\n    }\n  };\n\n  const handleDelete = () => {\n    handleDeleteChat(selectedChat);\n    handleClose();\n  };\n\n  const unreadMessages = (chat) => {\n    const currentUser = chat.users.find((u) => u.userId === loggedInUser.id);\n    return currentUser.unreads;\n  };\n\n  const getPrimaryText = (chat) => {\n    const isGroup = chat.isGroup;\n\n    const otherUser =\n      !isGroup && chat.users.find((u) => u.userId !== loggedInUser.id);\n\n    const mainText = chat.title;\n    const userName = otherUser?.user?.name;\n\n    const unreads = unreadMessages(chat);\n\n    return (\n      <>\n        {isGroup ? mainText : userName}\n        {unreads > 0 && (\n          <Chip\n            size=\"small\"\n            style={{ marginLeft: 5 }}\n            label={unreads}\n            color=\"secondary\"\n          />\n        )}\n      </>\n    );\n  };\n\n  const getSecondaryText = (chat) => {\n    // Prioriza o campo lastMessage retornado do backend\n    let msg = \"\";\n    if (chat.lastMessage && typeof chat.lastMessage === \"object\") {\n      if (chat.lastMessage.isDeleted) {\n        msg = i18n.t(\"chatMessages.deleted\");\n      } else if (chat.lastMessage.mediaType === \"audio\") {\n        msg = \"[Áudio]\";\n      } else if (chat.lastMessage.mediaType === \"image\") {\n        msg = \"[Imagem]\";\n      } else if (chat.lastMessage.mediaType === \"video\") {\n        msg = \"[Vídeo]\";\n      } else if (chat.lastMessage.mediaType && chat.lastMessage.mediaName) {\n        msg = `[Arquivo] ${chat.lastMessage.mediaName}`;\n      } else if (chat.lastMessage.message) {\n        msg = chat.lastMessage.message;\n      }\n    } else if (typeof chat.lastMessage === \"string\") {\n      msg = chat.lastMessage;\n    } else if (chat.messages && chat.messages.length > 0) {\n      const lastMsg = chat.messages[chat.messages.length - 1];\n      msg = lastMsg.message;\n    } else {\n      msg = i18n.t(\"chatList.noMessages\");\n    }\n    // Limita o texto a 80 caracteres\n    if (msg && msg.length > 40) {\n      return msg.substring(0, 40) + \"...\";\n    }\n    return msg;\n  };\n\n  const handleClick = (event, chat) => {\n    setAnchorEl(event.currentTarget);\n    setSelectedChat(chat);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  const handleOpenDetails = () => {\n    setDetailsModalOpen(true);\n    handleClose();\n  };\n\n  const handleCloseDetails = () => {\n    setDetailsModalOpen(false);\n  };\n\n  const formatLastSeen = (date) => {\n    if (!date) return \"\";\n    const lastSeen = new Date(date);\n    const now = new Date();\n    const diff = now - lastSeen;\n    if (diff < 60000) return i18n.t(\"chatList.now\");\n    if (diff < 3600000)\n      return i18n.t(\"chatList.minutesAgo\", { count: Math.floor(diff / 60000) });\n    if (diff < 86400000)\n      return i18n.t(\"chatList.hoursAgo\", { count: Math.floor(diff / 3600000) });\n    return lastSeen.toLocaleDateString();\n  };\n\n  const loadUsers = async () => {\n    try {\n      setUsersLoading(true);\n      const { data } = await api.get(\"/users/list\");\n      // Filtrar o usuário logado da lista\n      const filteredUsers = data.filter((user) => user.id !== loggedInUser.id);\n      setAvailableUsers(filteredUsers);\n    } catch (err) {\n      console.error(err);\n      toast.error(\"Erro ao carregar usuários\");\n    } finally {\n      setUsersLoading(false);\n    }\n  };\n\n  const handleOpenCreateChat = () => {\n    setCreateChatModalOpen(true);\n    setUserSearchTerm(\"\");\n    loadUsers();\n  };\n\n  const handleCloseCreateChat = () => {\n    setCreateChatModalOpen(false);\n    setUserSearchTerm(\"\");\n  };\n\n  const handleCreateChatWithUser = async (selectedUser) => {\n    try {\n      // Verificar se já existe um chat com este usuário\n      const existingChat = chats.find((c) => {\n        const hasSelectedUser = c.users.some(\n          (u) => u.userId === selectedUser.id\n        );\n        const hasLoggedInUser = c.users.some(\n          (u) => u.userId === loggedInUser.id\n        );\n        const isIndividualChat = !c.isGroup && c.users.length === 2;\n\n        return isIndividualChat && hasSelectedUser && hasLoggedInUser;\n      });\n\n      if (existingChat) {\n        toast.info(\"Chat com este usuário já existe!\");\n        handleSelectChat(existingChat);\n        handleCloseCreateChat();\n        return;\n      }\n\n      // Criar novo chat\n      const { data } = await api.post(\"/chats\", {\n        users: [{ id: selectedUser.id }],\n        isGroup: false,\n      });\n\n      toast.success(\"Chat criado com sucesso!\");\n\n      // Atualizar a lista de chats\n      if (findChats) {\n        await findChats();\n      }\n\n      handleSelectChat(data);\n      handleCloseCreateChat();\n    } catch (err) {\n      console.error(err);\n      toast.error(\"Erro ao criar chat\");\n    }\n  };\n\n  const filteredAvailableUsers = availableUsers.filter((user) =>\n    user.name.toLowerCase().includes(userSearchTerm.toLowerCase())\n  );\n\n  return (\n    <>\n      <Menu\n        id=\"simple-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        {selectedChat.ownerId === loggedInUser.id && selectedChat.isGroup && (\n          <MenuItem onClick={() => handleEditChat(selectedChat)}>\n            {i18n.t(\"chatList.edit\")}\n          </MenuItem>\n        )}\n        {loggedInUser.profile === \"admin\" && (\n          <MenuItem onClick={() => handleDeleteChat(selectedChat)}>\n            {i18n.t(\"chatList.delete\")}\n          </MenuItem>\n        )}\n        {selectedChat.isGroup && (\n          <MenuItem onClick={handleOpenDetails}>\n            {i18n.t(\"chatList.details\")}\n          </MenuItem>\n        )}\n      </Menu>\n      <ConfirmationModal\n        title={i18n.t(\"chatList.deleteChat\")}\n        open={confirmationModal}\n        onClose={() => setConfirmModalOpen(false)}\n        onConfirm={handleDelete}\n      >\n        {i18n.t(\"chatList.deleteChatConfirm\")}\n      </ConfirmationModal>\n      <ConfirmationModal\n        title={i18n.t(\"chatList.detailsTitle\")}\n        open={detailsModalOpen}\n        onClose={handleCloseDetails}\n      >\n        <div style={{ padding: \"20px\" }}>\n          <div style={{ textAlign: \"center\", marginBottom: \"20px\" }}>\n            <Avatar\n              src={\n                selectedChat?.groupImage\n                  ? selectedChat.groupImage.startsWith(\"http\")\n                    ? selectedChat.groupImage\n                    : `${getBackendUrl()}${selectedChat.groupImage}`\n                  : null\n              }\n              style={{ width: 100, height: 100, margin: \"0 auto\" }}\n            />\n            <Typography variant=\"h6\" style={{ marginTop: \"10px\" }}>\n              {selectedChat?.title}\n            </Typography>\n            {selectedChat?.description && (\n              <Typography variant=\"body2\" color=\"textSecondary\">\n                {selectedChat.description}\n              </Typography>\n            )}\n          </div>\n          <List>\n            {selectedChat?.users?.map((user) => (\n              <ListItem key={user.userId}>\n                <ListItemAvatar>\n                  <Avatar\n                    src={\n                      user.user?.profileImage\n                        ? `${getBackendUrl()}/public/company${\n                            user.user.companyId\n                          }/user/${user.user.profileImage}`\n                        : null\n                    }\n                  />\n                </ListItemAvatar>\n                <ListItemText\n                  primary={user.user?.name}\n                  secondary={\n                    user.userId === selectedChat.ownerId\n                      ? i18n.t(\"chatList.admin\")\n                      : i18n.t(\"chatList.member\")\n                  }\n                />\n              </ListItem>\n            ))}\n          </List>\n        </div>\n      </ConfirmationModal>\n      <div className={classes.mainContainer}>\n        <div\n          style={{\n            padding: \"10px\",\n            display: \"flex\",\n            gap: \"10px\",\n            alignItems: \"center\",\n          }}\n        >\n          <input\n            type=\"text\"\n            placeholder={i18n.t(\"chatList.searchChat\")}\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            style={{\n              flex: 1,\n              padding: \"8px 12px\",\n              borderRadius: \"20px\",\n              border: \"1px solid #ccc\",\n              outline: \"none\",\n            }}\n          />\n          {!isShowingOnlyGroups && (\n            <IconButton\n              onClick={handleOpenCreateChat}\n              style={{\n                backgroundColor: \"#1976d2\",\n                color: \"white\",\n                width: \"40px\",\n                height: \"40px\",\n              }}\n              title={i18n.t(\"chatList.createNewChat\")}\n            >\n              <AddIcon />\n            </IconButton>\n          )}\n        </div>\n\n        <div className={classes.chatList}>\n          <List>\n            {console.log(\n              \"Renderizando lista com\",\n              filteredChats.length,\n              \"chats\"\n            )}\n            {filteredChats.map((chat, key) => {\n              const isGroup = chat.isGroup;\n              const otherUser =\n                !isGroup &&\n                chat.users.find((u) => u.userId !== loggedInUser.id);\n              const isOnline =\n                !isGroup &&\n                otherUser &&\n                availableUsers?.some((u) => u.id === otherUser.user.id);\n\n              console.log(`Renderizando chat ${key}:`, {\n                id: chat.id,\n                uuid: chat.uuid,\n                isGroup: isGroup,\n                title: chat.title,\n                name: otherUser?.user?.name,\n                users: chat.users?.length,\n              });\n\n              return (\n                <ListItem\n                  key={key}\n                  button\n                  onClick={() => goToMessages(chat)}\n                  className={\n                    chat.uuid === id ? classes.listItemActive : classes.listItem\n                  }\n                >\n                  <ListItemAvatar>\n                    <div style={{ position: \"relative\" }}>\n                      <Avatar\n                        src={\n                          isGroup\n                            ? chat.groupImage\n                              ? chat.groupImage.startsWith(\"http\")\n                                ? chat.groupImage\n                                : `${getBackendUrl()}${chat.groupImage}`\n                              : undefined\n                            : otherUser &&\n                              otherUser.user &&\n                              otherUser.user.profileImage\n                            ? otherUser.user.profileImage.startsWith(\"http\")\n                              ? otherUser.user.profileImage\n                              : `${getBackendUrl()}/public/company${\n                                  otherUser.user.companyId\n                                }/user/${otherUser.user.profileImage}`\n                            : undefined\n                        }\n                        className={classes.avatar}\n                      >\n                        {isGroup\n                          ? chat.title\n                            ? chat.title.charAt(0)\n                            : \"G\"\n                          : otherUser && otherUser.user && otherUser.user.name\n                          ? otherUser.user.name.charAt(0)\n                          : \"?\"}\n                      </Avatar>\n                    </div>\n                  </ListItemAvatar>\n\n                  <ListItemText\n                    primary={\n                      <div className={classes.listItemContent}>\n                        <div className={classes.userName}>\n                          <Typography\n                            component=\"div\"\n                            variant=\"subtitle1\"\n                            className={classes.userName}\n                          >\n                            {isGroup\n                              ? chat.title || \"Grupo\"\n                              : otherUser &&\n                                otherUser.user &&\n                                otherUser.user.name\n                              ? otherUser.user.name\n                              : \"Usuário\"}\n                          </Typography>\n                          {!isGroup && (\n                            <UserStatusIcon user={otherUser?.user} />\n                          )}\n                        </div>\n                        {unreadMessages(chat) > 0 && (\n                          <div\n                            style={{\n                              width: 16,\n                              height: 16,\n                              borderRadius: \"50%\",\n                              background: \"red\",\n                              color: \"white\",\n                              display: \"flex\",\n                              alignItems: \"center\",\n                              justifyContent: \"center\",\n                              fontSize: 12,\n                              marginLeft: 8,\n                            }}\n                          >\n                            {unreadMessages(chat)}\n                          </div>\n                        )}\n                      </div>\n                    }\n                    secondary={\n                      <Typography\n                        component=\"div\"\n                        variant=\"body2\"\n                        style={{ color: \"gray\" }}\n                      >\n                        {getSecondaryText(chat)}\n                      </Typography>\n                    }\n                  />\n\n                  {(loggedInUser.profile === \"admin\" ||\n                    (selectedChat.ownerId === loggedInUser.id &&\n                      selectedChat.isGroup)) && (\n                    <IconButton\n                      edge=\"end\"\n                      aria-label=\"more\"\n                      onClick={(e) => handleClick(e, chat)}\n                    >\n                      <MoreVertIcon />\n                    </IconButton>\n                  )}\n                </ListItem>\n              );\n            })}\n          </List>\n        </div>\n      </div>\n      <Dialog\n        open={createChatModalOpen}\n        onClose={handleCloseCreateChat}\n        maxWidth=\"sm\"\n        fullWidth\n      >\n        <DialogTitle>\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: \"10px\" }}>\n            <AddIcon style={{ color: \"#1976d2\" }} />\n            <Typography variant=\"h6\">\n              {i18n.t(\"chatList.createNewChat\")}\n            </Typography>\n          </div>\n        </DialogTitle>\n        <DialogContent>\n          <TextField\n            fullWidth\n            placeholder={i18n.t(\"chatList.searchUser\")}\n            value={userSearchTerm}\n            onChange={(e) => setUserSearchTerm(e.target.value)}\n            style={{ marginBottom: \"20px\", marginTop: \"10px\" }}\n            InputProps={{\n              startAdornment: (\n                <SearchIcon style={{ marginRight: \"8px\", color: \"#666\" }} />\n              ),\n            }}\n          />\n\n          {usersLoading ? (\n            <div\n              style={{\n                display: \"flex\",\n                justifyContent: \"center\",\n                padding: \"20px\",\n              }}\n            >\n              <CircularProgress />\n            </div>\n          ) : (\n            <List style={{ maxHeight: \"400px\", overflow: \"auto\" }}>\n              {filteredAvailableUsers.map((user) => (\n                <ListItem\n                  key={user.userId}\n                  button\n                  onClick={() => handleCreateChatWithUser(user)}\n                  style={{ borderRadius: \"8px\", marginBottom: \"4px\" }}\n                >\n                  <ListItemAvatar>\n                    <Avatar\n                      src={\n                        user?.profileImage?.startsWith(\"http\")\n                          ? user.profileImage\n                          : `${getBackendUrl()}/public/company${\n                              user.companyId\n                            }/user/${user.profileImage}`\n                      }\n                    >\n                      {/* {!user.profileImage && user.name.charAt(0)} */}\n                    </Avatar>\n                  </ListItemAvatar>\n                  <ListItemText\n                    primary={\n                      <div\n                        style={{\n                          display: \"flex\",\n                          alignItems: \"center\",\n                          gap: \"8px\",\n                        }}\n                      >\n                        <Typography variant=\"subtitle1\">{user.name}</Typography>\n                        <UserStatusIcon user={user} />\n                      </div>\n                    }\n                    secondary={user.email}\n                  />\n                </ListItem>\n              ))}\n              {filteredAvailableUsers.length === 0 && !usersLoading && (\n                <div\n                  style={{\n                    textAlign: \"center\",\n                    padding: \"20px\",\n                    color: \"#666\",\n                  }}\n                >\n                  {userSearchTerm\n                    ? i18n.t(\"chatList.noUserFound\")\n                    : i18n.t(\"chatList.noUserAvailable\")}\n                </div>\n              )}\n            </List>\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseCreateChat} color=\"secondary\">\n            {i18n.t(\"chatList.cancel\")}\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}