{"ast":null,"code":"import React,{createContext,useState,useEffect,useContext}from\"react\";import api from\"../../services/api\";import useWhatsApps from\"../../hooks/useWhatsApps\";import WavoipPhoneWidget from\"../../components/WavoipCall\";import{AuthContext}from\"../Auth/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const WhatsAppsContext=/*#__PURE__*/createContext();const WhatsAppsProvider=_ref=>{var _user$company;let{children}=_ref;// Add fallback values to prevent destructuring errors\nconst whatsAppData=useWhatsApps();const{loading=false,whatsApps=[]}=whatsAppData||{};const{user}=useContext(AuthContext);const[wavoipToken,setWavoipToken]=useState(null);const[loadingSession,setLoadingSession]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchSession=async()=>{try{var _data$whatsapp;const{data}=await api.get(\"/call/historical/user/whatsapp\");// let wavoipToken  = \"\";\n// for(const d of data){\n//   if(d?.wavoip){\n//     wavoipToken = d.wavoip;\n//     break;\n//   }\n// }\nconsole.log('whavoip token',data);setWavoipToken((data===null||data===void 0?void 0:(_data$whatsapp=data.whatsapp)===null||_data$whatsapp===void 0?void 0:_data$whatsapp.wavoip)||null);}catch(err){console.error(\"Erro fetchSession:\",err);setWavoipToken(null);}finally{setLoadingSession(false);}};fetchSession();},[]);// Log error state for debugging\nif(error){console.warn(\"WhatsAppsProvider error:\",error);}return/*#__PURE__*/_jsxs(WhatsAppsContext.Provider,{value:{whatsApps,loading,error},children:[children,wavoipToken&&/*#__PURE__*/_jsx(WavoipPhoneWidget,{token:wavoipToken,position:\"bottom-right\",name:(user===null||user===void 0?void 0:(_user$company=user.company)===null||_user$company===void 0?void 0:_user$company.name)||\"waVoip\",country:\"BR\",autoConnect:true,onCallStarted:data=>console.log(\"Chamada iniciada:\",data),onCallEnded:data=>console.log(\"Chamada finalizada:\",data),onConnectionStatus:status=>console.log(\"Status:\",status),onError:error=>console.error(\"Erro:\",error)})]});};export{WhatsAppsContext,WhatsAppsProvider};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}