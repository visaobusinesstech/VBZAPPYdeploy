{"ast":null,"code":"import{Divider}from'@material-ui/core';import{FileCopyOutlined,Language,Phone}from'@material-ui/icons';import{makeStyles}from'@material-ui/core/styles';import React from'react';import MarkdownWrapper from'../MarkdownWrapper';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({buttonTemplate:{backgroundColor:\"transparent\",border:'none',color:'#0CADE3','&:hover':{backgroundColor:theme.palette.primary.dark}}}));// Componente para renderizar os botões dinamicamente \nconst Template=_ref=>{let{message}=_ref;const classes=useStyles();const urlRegex=/(https?:\\/\\/[^\\s]+(\\.jpg|\\.jpeg|\\.png|\\.gif|\\.mp4|\\.webm|\\.ogg))/g;// Separar a parte do texto dos botões usando '||||'\nconst[text,buttonsJson]=message.body.split('||||');// Encontra a URL de mídia no texto (se existir)\nconst mediaUrls=text.match(urlRegex);const mediaUrl=mediaUrls?mediaUrls[0]:null;// Considerando a primeira URL encontrada\n// Remove a URL de mídia do texto para não duplicar\nconst textWithoutMediaUrl=text.replace(urlRegex,'').trim();// Funções para verificar se é uma imagem ou vídeo\nconst isImage=url=>/\\.(jpeg|jpg|gif|png)$/i.test(url);const isVideo=url=>/\\.(mp4|webm|ogg)$/i.test(url);const ButtonRenderer=_ref2=>{let{buttons}=_ref2;return/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'10px',padding:'10px',display:'flex',flexDirection:'column',alignItems:'center',gap:'10px'},children:buttons.map((button,index)=>{if(button.type==='URL'){return/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.open(button.url,'_blank'),className:classes.buttonTemplate,children:/*#__PURE__*/_jsxs(\"span\",{style:{color:'blue-light',display:'flex',alignItems:'center',textAlign:'center',gap:'5px'},children:[/*#__PURE__*/_jsx(Language,{}),\" \",button.text]})},index);}else if(button.type==='PHONE_NUMBER'){return/*#__PURE__*/_jsx(\"span\",{style:{color:'blue',display:'flex',alignItems:'center',textAlign:'center',gap:'5px'},children:/*#__PURE__*/_jsxs(\"button\",{className:classes.buttonTemplate,onClick:()=>window.open(\"https://wa.me/\".concat(button.phone_number),'_blank'),children:[/*#__PURE__*/_jsx(Phone,{}),\" \",button.text]},index)});}else if(button.type==='COPY_CODE'){return/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigator.clipboard.writeText(button.example[0]),className:classes.buttonTemplate,children:/*#__PURE__*/_jsxs(\"span\",{style:{color:'blue-light',display:'flex',alignItems:'center',textAlign:'center',gap:'5px'},children:[/*#__PURE__*/_jsx(FileCopyOutlined,{}),\" \",button.text]})},index);}return null;})});};// Parse adicional da string aninhada\nlet buttons=[];if(buttonsJson&&buttonsJson!==\"[]\"){try{if(typeof buttonsJson==='string'){buttons=JSON.parse(JSON.parse(buttonsJson));// Parse adicional aqui\n}else if(typeof buttonsJson==='object'){buttons=Object.values(buttonsJson);}}catch(e){console.log(buttonsJson);console.error('Erro ao fazer parse dos botões:',e);}}return/*#__PURE__*/_jsxs(_Fragment,{children:[mediaUrl&&/*#__PURE__*/_jsx(_Fragment,{children:isImage(mediaUrl)?/*#__PURE__*/_jsx(\"img\",{src:mediaUrl,alt:\"media content\",style:{maxWidth:'100%',height:'auto'}}):isVideo(mediaUrl)?/*#__PURE__*/_jsx(\"video\",{src:mediaUrl,controls:true,style:{maxWidth:'100%',height:'auto'}}):/*#__PURE__*/_jsx(\"p\",{children:\"Unsupported media type\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(MarkdownWrapper,{children:textWithoutMediaUrl}),buttons.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(ButtonRenderer,{buttons:buttons})]})]})]});};export default Template;","map":{"version":3,"names":["Divider","FileCopyOutlined","Language","Phone","makeStyles","React","MarkdownWrapper","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useStyles","theme","buttonTemplate","backgroundColor","border","color","palette","primary","dark","Template","_ref","message","classes","urlRegex","text","buttonsJson","body","split","mediaUrls","match","mediaUrl","textWithoutMediaUrl","replace","trim","isImage","url","test","isVideo","ButtonRenderer","_ref2","buttons","style","marginTop","padding","display","flexDirection","alignItems","gap","children","map","button","index","type","onClick","window","open","className","textAlign","concat","phone_number","navigator","clipboard","writeText","example","JSON","parse","Object","values","e","console","log","error","src","alt","maxWidth","height","controls","length"],"sources":["/home/deploy/atendechatop/frontend/src/components/MessagesList/templates.js"],"sourcesContent":["import { Divider } from '@material-ui/core';\nimport { FileCopyOutlined, Language, Phone } from '@material-ui/icons';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\nimport MarkdownWrapper from '../MarkdownWrapper';\n\nconst useStyles = makeStyles((theme) => ({\n  buttonTemplate: {\n    backgroundColor: \"transparent\",\n    border: 'none',\n    color: '#0CADE3',\n    '&:hover': {\n      backgroundColor: theme.palette.primary.dark,\n    },\n  },\n}));\n// Componente para renderizar os botões dinamicamente \n\n\nconst Template = ({ message }) => {\n  const classes = useStyles();\n  const urlRegex = /(https?:\\/\\/[^\\s]+(\\.jpg|\\.jpeg|\\.png|\\.gif|\\.mp4|\\.webm|\\.ogg))/g;\n\n  // Separar a parte do texto dos botões usando '||||'\n  const [text, buttonsJson] = message.body.split('||||');\n\n  // Encontra a URL de mídia no texto (se existir)\n  const mediaUrls = text.match(urlRegex);\n  const mediaUrl = mediaUrls ? mediaUrls[0] : null; // Considerando a primeira URL encontrada\n\n  // Remove a URL de mídia do texto para não duplicar\n  const textWithoutMediaUrl = text.replace(urlRegex, '').trim();\n\n  // Funções para verificar se é uma imagem ou vídeo\n  const isImage = (url) => /\\.(jpeg|jpg|gif|png)$/i.test(url);\n  const isVideo = (url) => /\\.(mp4|webm|ogg)$/i.test(url);\n\n  const ButtonRenderer = ({ buttons }) => {\n    return (\n      <div style={{ marginTop: '10px', padding: '10px', display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '10px' }}>\n        {buttons.map((button, index) => {\n          if (button.type === 'URL') {\n            return (\n              <button key={index} onClick={() => window.open(button.url, '_blank')} className={classes.buttonTemplate}>\n                <span style={{ color: 'blue-light', display: 'flex', alignItems: 'center', textAlign: 'center', gap: '5px' }}><Language /> {button.text}</span>\n              </button>\n            );\n          } else if (button.type === 'PHONE_NUMBER') {\n            return (\n              <span style={{ color: 'blue', display: 'flex', alignItems: 'center', textAlign: 'center', gap: '5px' }}>\n                <button className={classes.buttonTemplate} key={index} onClick={() => window.open(`https://wa.me/${button.phone_number}`, '_blank')}>\n                  <Phone /> {button.text}\n                </button>\n              </span>\n            );\n          } else if (button.type === 'COPY_CODE') {\n            return (\n              <button key={index} onClick={() => navigator.clipboard.writeText(button.example[0])} className={classes.buttonTemplate}>\n                <span style={{ color: 'blue-light', display: 'flex', alignItems: 'center', textAlign: 'center', gap: '5px' }}><FileCopyOutlined /> {button.text}</span>\n              </button>\n            );\n          }\n          return null;\n        })}\n      </div>\n    );\n  };\n  // Parse adicional da string aninhada\n  let buttons = [];\n  if (buttonsJson && buttonsJson !== \"[]\") {\n    try {\n      if (typeof buttonsJson === 'string') {\n        buttons = JSON.parse(JSON.parse(buttonsJson)); // Parse adicional aqui\n      } else if (typeof buttonsJson === 'object') {\n        buttons = Object.values(buttonsJson);\n      }\n    } catch (e) {\n      console.log(buttonsJson)\n      console.error('Erro ao fazer parse dos botões:', e);\n    }\n  }\n\n  return (\n    <>\n      {/* Renderiza a mídia se houver uma URL de imagem ou vídeo */}\n      {mediaUrl && (\n        <>\n          {isImage(mediaUrl) ? (\n            <img src={mediaUrl} alt=\"media content\" style={{ maxWidth: '100%', height: 'auto' }} />\n          ) : isVideo(mediaUrl) ? (\n            <video src={mediaUrl} controls style={{ maxWidth: '100%', height: 'auto' }} />\n          ) : (\n            <p>Unsupported media type</p>\n          )}\n        </>\n      )}\n      <div>\n\n        {/* Renderiza o texto principal */}\n        <MarkdownWrapper>{textWithoutMediaUrl}</MarkdownWrapper>\n\n        {/* Renderiza os botões se houver */}\n        {buttons.length > 0 && (\n          <>\n            <Divider />\n            <ButtonRenderer buttons={buttons} />\n          </>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default Template;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}