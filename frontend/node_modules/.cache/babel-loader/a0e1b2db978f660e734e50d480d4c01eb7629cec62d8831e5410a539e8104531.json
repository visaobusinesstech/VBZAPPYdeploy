{"ast":null,"code":"import _objectSpread from\"/home/deploy/codigologlow/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useState,useEffect,useRef}from\"react\";import*as Yup from\"yup\";import{Formik,Form,Field,getIn}from\"formik\";import{toast}from\"react-toastify\";import{makeStyles}from\"@material-ui/core/styles\";import{green}from\"@material-ui/core/colors\";import Button from\"@material-ui/core/Button\";import TextField from\"@material-ui/core/TextField\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import CircularProgress from\"@material-ui/core/CircularProgress\";import AttachFileIcon from\"@material-ui/icons/AttachFile\";import MicIcon from\"@material-ui/icons/Mic\";import DeleteOutlineIcon from\"@material-ui/icons/DeleteOutline\";import EditIcon from\"@material-ui/icons/Edit\";import IconButton from\"@material-ui/core/IconButton\";import{i18n}from\"../../translate/i18n\";import{head}from\"lodash\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";import{AuthContext}from\"../../context/Auth/AuthContext\";import MessageVariablesPicker from\"../MessageVariablesPicker\";import{DataGrid}from\"@material-ui/data-grid\";import AudioRecorder from\"../AudioRecorder\";import{FormControl,Grid,InputLabel,MenuItem,Select,Tab,Tabs,Box,Typography,Chip,Divider,FormControlLabel,Checkbox}from\"@material-ui/core\";import ConfirmationModal from\"../ConfirmationModal\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"},multFieldLine:{display:\"flex\",\"& > *:not(:last-child)\":{marginRight:theme.spacing(1)}},btnWrapper:{position:\"relative\"},buttonProgress:{color:green[500],position:\"absolute\",top:\"50%\",left:\"50%\",marginTop:-12,marginLeft:-12},formControl:{margin:theme.spacing(1),minWidth:120},colorAdorment:{width:20,height:20},mediaContainer:{display:'flex',flexDirection:'column',gap:theme.spacing(2),padding:theme.spacing(2),border:\"1px solid \".concat(theme.palette.divider),borderRadius:theme.shape.borderRadius,marginBottom:theme.spacing(2)},mediaOptions:{display:'flex',gap:theme.spacing(1),justifyContent:'center',flexWrap:'wrap'},mediaInfo:{display:'flex',alignItems:'center',justifyContent:'space-between',padding:theme.spacing(1),backgroundColor:theme.palette.grey[100],borderRadius:theme.shape.borderRadius},existingMediaActions:{display:'flex',gap:theme.spacing(1),alignItems:'center'},mediaPreview:{maxWidth:'100%',maxHeight:200,borderRadius:theme.shape.borderRadius,marginTop:theme.spacing(1)}}));const QuickeMessageSchema=Yup.object().shape({shortcode:Yup.string().required(\"Obrigat√≥rio\"),isOficial:Yup.boolean(),components:Yup.array().when(\"isOficial\",{is:true,then:Yup.array().of(Yup.object().shape({text:Yup.string().trim().required(\"Obrigat√≥rio\")})),otherwise:Yup.array().notRequired()})});const QuickMessageDialog=_ref=>{let{open,onClose,quickemessageId,reload}=_ref;const classes=useStyles();const{user}=useContext(AuthContext);const messageInputRef=useRef();const initialState={shortcode:\"\",message:\"\",geral:true,visao:true,isOficial:false,status:\"\",language:\"\",category:\"\",metaID:\"\"};const[confirmationOpen,setConfirmationOpen]=useState(false);const[quickemessage,setQuickemessage]=useState(initialState);const[attachment,setAttachment]=useState(null);const[audioBlob,setAudioBlob]=useState(null);const[tabIndex,setTabIndex]=useState(0);const[mediaMode,setMediaMode]=useState(null);// 'file', 'audio', 'edit', null\nconst[isEditingMedia,setIsEditingMedia]=useState(false);const attachmentFile=useRef(null);useEffect(()=>{try{(async()=>{if(!quickemessageId)return;const{data}=await api.get(\"/quick-messages/\".concat(quickemessageId));setQuickemessage(prevState=>{return _objectSpread(_objectSpread({},prevState),data);});// Reset media editing state when loading existing message\nsetIsEditingMedia(false);setMediaMode(null);})();}catch(err){toastError(err);}},[quickemessageId,open]);const handleClose=()=>{setQuickemessage(initialState);setAttachment(null);setAudioBlob(null);setMediaMode(null);setIsEditingMedia(false);onClose();};const handleAttachmentFile=e=>{const file=head(e.target.files);if(file){setAttachment(file);setAudioBlob(null);// Limpar √°udio se existir\nsetMediaMode('file');setIsEditingMedia(true);}};const handleAudioRecorded=blob=>{setAudioBlob(blob);setAttachment(null);// Limpar arquivo se existir\nsetMediaMode('audio');setIsEditingMedia(true);};const handleAudioDeleted=()=>{setAudioBlob(null);setMediaMode(null);setIsEditingMedia(false);};const handleCancelEdit=()=>{setAttachment(null);setAudioBlob(null);setMediaMode(null);setIsEditingMedia(false);if(attachmentFile.current){attachmentFile.current.value=null;}};const handleEditExistingMedia=()=>{setIsEditingMedia(true);setMediaMode('edit');};const getBasename=filepath=>{if(!filepath)return'';// Remove query strings e hashes\nconst cleanPath=filepath.split('?')[0].split('#')[0];// Pega o √∫ltimo segmento ap√≥s /\nconst segments=cleanPath.split('/');return segments[segments.length-1];};const handleSaveQuickeMessage=async values=>{const quickemessageData=_objectSpread(_objectSpread({},values),{},{isMedia:!!(attachment||audioBlob||quickemessage.mediaPath&&!isEditingMedia),mediaPath:attachment?String(attachment.name).replace(/ /g,\"_\"):values.mediaPath?getBasename(values.mediaPath).replace(/ /g,\"_\"):null,isOficial:quickemessageId?values.isOficial:false});// Inclui componentes editados (template oficial)\nif(Array.isArray(values.components)){quickemessageData.components=values.components.map(c=>({id:c.id,text:c.text}));}try{let quickMessageRecord;if(quickemessageId){quickMessageRecord=await api.put(\"/quick-messages/\".concat(quickemessageId),quickemessageData);}else{const{data}=await api.post(\"/quick-messages\",quickemessageData);quickMessageRecord={data};}const messageId=quickemessageId||quickMessageRecord.data.id;// Se est√° editando m√≠dia, primeiro remover a m√≠dia antiga\nif(isEditingMedia&&quickemessage.mediaPath){await api.delete(\"/quick-messages/\".concat(messageId,\"/media-upload\"));}// Upload de arquivo comum\nif(attachment){const formData=new FormData();formData.append(\"typeArch\",\"quickMessage\");// ‚úÖ IMPORTANTE\nformData.append(\"file\",attachment);console.log(\"üì§ Enviando arquivo:\",{name:attachment.name,type:attachment.type,size:attachment.size});await api.post(\"/quick-messages/\".concat(messageId,\"/media-upload\"),formData);}// ‚úÖ CORRE√á√ÉO: Upload de √°udio gravado\nif(audioBlob){const formData=new FormData();formData.append(\"typeArch\",\"quickMessage\");// ‚úÖ IMPORTANTE para o multer\nformData.append(\"audio\",audioBlob,\"audio_\".concat(Date.now(),\".webm\"));// ‚úÖ fieldname = 'audio'\nconsole.log(\"üéµ Enviando √°udio gravado:\",{size:audioBlob.size,type:audioBlob.type});const response=await api.post(\"/quick-messages/\".concat(messageId,\"/audio-upload\"),formData);console.log(\"‚úÖ Resposta do upload de √°udio:\",response.data);}toast.success(i18n.t(\"quickMessages.toasts.success\"));if(typeof reload===\"function\"){reload();}}catch(err){console.error(\"‚ùå Erro ao salvar quick message:\",err);toastError(err);}handleClose();};const rowsWithIds=((quickemessage===null||quickemessage===void 0?void 0:quickemessage.components)||[]).map((component,index)=>_objectSpread({id:index},component));const deleteMedia=async()=>{if(attachment){setAttachment(null);attachmentFile.current.value=null;}if(audioBlob){setAudioBlob(null);}if(quickemessage.mediaPath){await api.delete(\"/quick-messages/\".concat(quickemessage.id,\"/media-upload\"));setQuickemessage(prev=>_objectSpread(_objectSpread({},prev),{},{mediaPath:null,mediaName:null,mediaType:null}));toast.success(i18n.t(\"quickMessages.toasts.deleted\"));if(typeof reload===\"function\"){reload();}}setMediaMode(null);setIsEditingMedia(false);};const handleClickMsgVar=async(msgVar,setValueFunc)=>{const el=messageInputRef.current;const firstHalfText=el.value.substring(0,el.selectionStart);const secondHalfText=el.value.substring(el.selectionEnd);const newCursorPos=el.selectionStart+msgVar.length;setValueFunc(\"message\",\"\".concat(firstHalfText).concat(msgVar).concat(secondHalfText));await new Promise(r=>setTimeout(r,100));messageInputRef.current.setSelectionRange(newCursorPos,newCursorPos);};const handleTabChange=(event,newValue)=>{setTabIndex(newValue);};const getMediaTypeIcon=mediaType=>{switch(mediaType){case'audio':return'üéµ';case'image':return'üñºÔ∏è';case'video':return'üé•';default:return'üìé';}};const getMediaPreview=quickmessage=>{if(!quickmessage.mediaPath)return null;const mediaUrl=\"\".concat(process.env.REACT_APP_BACKEND_URL||'http://localhost:8080',\"/public/company\").concat(user.companyId,\"/quickMessage/\").concat(quickmessage.mediaName);if(quickmessage.mediaType==='image'){return/*#__PURE__*/_jsx(\"img\",{src:mediaUrl,alt:quickmessage.mediaName,className:classes.mediaPreview,onError:e=>{e.target.style.display='none';}});}//if (quickmessage.mediaType === 'audio') {\n//  return (\n//    <audio \n//      controls \n//      className={classes.mediaPreview}\n//      src={mediaUrl}\n//   >\n//      Seu navegador n√£o suporta o elemento de √°udio.\n//    </audio>\n//  );\n//}\nif(quickmessage.mediaType==='video'){return/*#__PURE__*/_jsx(\"video\",{controls:true,className:classes.mediaPreview,src:mediaUrl,children:\"Seu navegador n\\xE3o suporta o elemento de v\\xEDdeo.\"});}return null;};// Verificar se h√° nova m√≠dia sendo adicionada\nconst hasNewMedia=attachment||audioBlob;// Verificar se h√° m√≠dia existente (e n√£o est√° sendo editada)\nconst hasExistingMedia=quickemessage.mediaPath&&!isEditingMedia;// Verificar se h√° qualquer tipo de m√≠dia\nconst hasAnyMedia=hasNewMedia||hasExistingMedia;return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(ConfirmationModal,{title:i18n.t(\"quickMessages.confirmationModal.deleteTitle\"),open:confirmationOpen,onClose:()=>setConfirmationOpen(false),onConfirm:deleteMedia,children:i18n.t(\"quickMessages.confirmationModal.deleteMessage\")}),/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,maxWidth:\"xl\",fullWidth:true,scroll:\"paper\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"form-dialog-title\",children:quickemessageId?\"\".concat(i18n.t(\"quickMessages.dialog.edit\")):\"\".concat(i18n.t(\"quickMessages.dialog.add\"))}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"none\"},children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt\",ref:attachmentFile,onChange:e=>handleAttachmentFile(e)})}),/*#__PURE__*/_jsx(Formik,{initialValues:_objectSpread(_objectSpread({},quickemessage),{},{isStarter:(quickemessage===null||quickemessage===void 0?void 0:quickemessage.isStarter)||false}),enableReinitialize:true,validationSchema:QuickeMessageSchema,onSubmit:(values,actions)=>{setTimeout(()=>{handleSaveQuickeMessage(values);actions.setSubmitting(false);},400);},children:_ref2=>{let{touched,errors,isSubmitting,setFieldValue,values}=_ref2;// Fun√ß√£o para verificar se os campos est√£o desabilitados\nconst isDisabled=quickemessageId&&values.visao&&!values.geral&&values.userId!==user.id;return/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsxs(Tabs,{value:tabIndex,onChange:handleTabChange,indicatorColor:\"primary\",textColor:\"primary\",centered:true,children:[/*#__PURE__*/_jsx(Tab,{label:i18n.t(\"quickMessages.dialog.general\")}),values.isOficial&&/*#__PURE__*/_jsx(Tab,{label:\"Oficial\"})]}),tabIndex===0&&/*#__PURE__*/_jsxs(Grid,{spacing:2,container:true,children:[/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,autoFocus:true,label:i18n.t(\"quickMessages.dialog.shortcode\"),name:\"shortcode\",disabled:isDisabled,error:touched.shortcode&&Boolean(errors.shortcode),helperText:touched.shortcode&&errors.shortcode,variant:\"outlined\",margin:\"dense\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,label:i18n.t(\"quickMessages.dialog.message\"),name:\"message\",inputRef:messageInputRef,error:touched.message&&Boolean(errors.message),helperText:touched.message&&errors.message,variant:\"outlined\",margin:\"dense\",disabled:isDisabled,multiline:true,rows:7,fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,xl:12,children:/*#__PURE__*/_jsx(MessageVariablesPicker,{disabled:isSubmitting||isDisabled,showSchedulingVars:true,onClick:value=>handleClickMsgVar(value,setFieldValue)})}),/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsxs(Box,{className:classes.mediaContainer,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"Anexar M\\xEDdia\"}),hasExistingMedia&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Box,{className:classes.mediaInfo,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"span\",{children:getMediaTypeIcon(quickemessage.mediaType)}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:quickemessage.mediaName}),quickemessage.mediaType&&/*#__PURE__*/_jsx(Chip,{size:\"small\",label:quickemessage.mediaType,variant:\"outlined\"})]}),/*#__PURE__*/_jsxs(Box,{className:classes.existingMediaActions,children:[/*#__PURE__*/_jsx(IconButton,{onClick:handleEditExistingMedia,color:\"primary\",size:\"small\",title:\"Editar m\\xEDdia\",disabled:isDisabled,children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setConfirmationOpen(true),color:\"secondary\",size:\"small\",title:\"Remover m\\xEDdia\",disabled:isDisabled,children:/*#__PURE__*/_jsx(DeleteOutlineIcon,{})})]})]}),getMediaPreview(quickemessage)]}),attachment&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{className:classes.mediaInfo,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(AttachFileIcon,{}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:attachment.name}),/*#__PURE__*/_jsx(Chip,{size:\"small\",label:\"Novo Arquivo\",color:\"primary\"})]}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>{setAttachment(null);setMediaMode(null);setIsEditingMedia(false);if(attachmentFile.current){attachmentFile.current.value=null;}},color:\"secondary\",size:\"small\",children:/*#__PURE__*/_jsx(DeleteOutlineIcon,{})})]})}),audioBlob&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{className:classes.mediaInfo,children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(MicIcon,{}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"Novo \\xE1udio gravado\"}),/*#__PURE__*/_jsx(Chip,{size:\"small\",label:\"Novo \\xC1udio\",color:\"secondary\"})]}),/*#__PURE__*/_jsx(IconButton,{onClick:handleAudioDeleted,color:\"secondary\",size:\"small\",children:/*#__PURE__*/_jsx(DeleteOutlineIcon,{})})]})}),(!hasAnyMedia||isEditingMedia)&&/*#__PURE__*/_jsxs(_Fragment,{children:[isEditingMedia&&hasExistingMedia&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",align:\"center\",children:\"Escolha uma nova m\\xEDdia para substituir:\"})]}),!hasAnyMedia&&/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",align:\"center\",children:\"Escolha uma op\\xE7\\xE3o para anexar m\\xEDdia:\"}),/*#__PURE__*/_jsxs(Box,{className:classes.mediaOptions,children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(AttachFileIcon,{}),onClick:()=>attachmentFile.current.click(),disabled:isSubmitting||isDisabled,children:\"Anexar Arquivo\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",startIcon:/*#__PURE__*/_jsx(MicIcon,{}),onClick:()=>setMediaMode('audio'),disabled:isSubmitting||isDisabled,children:\"Gravar \\xC1udio\"}),isEditingMedia&&/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:handleCancelEdit,disabled:isSubmitting,children:\"Cancelar Edi\\xE7\\xE3o\"})]})]}),mediaMode==='audio'&&!audioBlob&&/*#__PURE__*/_jsx(AudioRecorder,{onAudioRecorded:handleAudioRecorded,onAudioDeleted:handleAudioDeleted,disabled:isSubmitting||isDisabled})]})}),/*#__PURE__*/_jsxs(Grid,{xs:12,item:true,children:[/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"geral-selection-label\",children:i18n.t(\"quickMessages.dialog.visao\")}),/*#__PURE__*/_jsxs(Field,{as:Select,label:i18n.t(\"quickMessages.dialog.visao\"),placeholder:i18n.t(\"quickMessages.dialog.visao\"),labelId:\"visao-selection-label\",id:\"visao\",disabled:isDisabled,name:\"visao\",onChange:e=>{setFieldValue(\"visao\",e.target.value===\"true\");},error:touched.visao&&Boolean(errors.visao),value:values.visao?\"true\":\"false\",children:[/*#__PURE__*/_jsx(MenuItem,{value:\"true\",children:i18n.t(\"announcements.active\")}),/*#__PURE__*/_jsx(MenuItem,{value:\"false\",children:i18n.t(\"announcements.inactive\")})]})]}),values.visao===true&&/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"geral-selection-label\",children:i18n.t(\"quickMessages.dialog.geral\")}),/*#__PURE__*/_jsxs(Field,{as:Select,label:i18n.t(\"quickMessages.dialog.geral\"),placeholder:i18n.t(\"quickMessages.dialog.geral\"),labelId:\"novo-item-selection-label\",id:\"geral\",name:\"geral\",disabled:isDisabled,value:values.geral?\"true\":\"false\",error:touched.geral&&Boolean(errors.geral),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"true\",children:i18n.t(\"announcements.active\")}),/*#__PURE__*/_jsx(MenuItem,{value:\"false\",children:i18n.t(\"announcements.inactive\")})]})]})]})]}),tabIndex===1&&/*#__PURE__*/_jsxs(_Fragment,{children:[values.isOficial&&/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Field,{name:\"isStarter\",type:\"checkbox\",as:Checkbox,color:\"primary\"}),label:\"Template inicia conversa com o cliente\"})})}),/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsx(DataGrid,{rows:rowsWithIds||[],columns:[{field:\"type\",headerName:\"Tipo\",width:150},{field:\"text\",headerName:\"Valor\",width:400}],pageSize:5,disableSelectionOnClick:true,autoHeight:true})}),values.isOficial&&/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:(values.components||[]).map((comp,idx)=>/*#__PURE__*/_jsxs(Grid,{xs:12,item:true,children:[/*#__PURE__*/_jsx(Box,{display:\"flex\",alignItems:\"center\",gap:8,children:/*#__PURE__*/_jsx(Chip,{size:\"small\",label:comp.type||\"component\"})}),/*#__PURE__*/_jsx(Field,{as:TextField,label:\"Texto (\".concat(comp.type||'component',\")\"),name:\"components.\".concat(idx,\".text\"),variant:\"outlined\",margin:\"dense\",fullWidth:true,error:Boolean(getIn(touched,\"components.\".concat(idx,\".text\"))&&getIn(errors,\"components.\".concat(idx,\".text\"))),helperText:getIn(touched,\"components.\".concat(idx,\".text\"))&&getIn(errors,\"components.\".concat(idx,\".text\"))})]},comp.id||idx))}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{xl:6,md:6,sm:12,xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,autoFocus:true,label:i18n.t(\"quickMessages.dialog.status\"),name:\"status\",disabled:values.isOficial,error:touched.status&&Boolean(errors.status),helperText:touched.status&&errors.status,variant:\"outlined\",margin:\"dense\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{xl:6,md:6,sm:12,xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,autoFocus:true,label:i18n.t(\"quickMessages.dialog.language\"),name:\"language\",disabled:values.isOficial,error:touched.language&&Boolean(errors.language),helperText:touched.language&&errors.language,variant:\"outlined\",margin:\"dense\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{xl:6,md:6,sm:12,xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,autoFocus:true,label:i18n.t(\"quickMessages.dialog.category\"),name:\"category\",disabled:values.isOficial,error:touched.category&&Boolean(errors.category),helperText:touched.category&&errors.category,variant:\"outlined\",margin:\"dense\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{xl:6,md:6,sm:12,xs:12,item:true,children:/*#__PURE__*/_jsx(Field,{as:TextField,autoFocus:true,label:i18n.t(\"quickMessages.dialog.metaID\"),name:\"metaID\",disabled:values.isOficial,error:touched.metaID&&Boolean(errors.metaID),helperText:touched.metaID&&errors.metaID,variant:\"outlined\",margin:\"dense\",fullWidth:true})})]})]})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",disabled:isSubmitting,variant:\"outlined\",children:i18n.t(\"quickMessages.buttons.cancel\")}),/*#__PURE__*/_jsxs(Button,{type:\"submit\",color:\"primary\",disabled:isSubmitting||isDisabled,variant:\"contained\",className:classes.btnWrapper,children:[quickemessageId?\"\".concat(i18n.t(\"quickMessages.buttons.edit\")):\"\".concat(i18n.t(\"quickMessages.buttons.add\")),isSubmitting&&/*#__PURE__*/_jsx(CircularProgress,{size:24,className:classes.buttonProgress})]})]})]});}})]})]});};export default QuickMessageDialog;","map":{"version":3,"names":["React","useContext","useState","useEffect","useRef","Yup","Formik","Form","Field","getIn","toast","makeStyles","green","Button","TextField","Dialog","DialogActions","DialogContent","DialogTitle","CircularProgress","AttachFileIcon","MicIcon","DeleteOutlineIcon","EditIcon","IconButton","i18n","head","api","toastError","AuthContext","MessageVariablesPicker","DataGrid","AudioRecorder","FormControl","Grid","InputLabel","MenuItem","Select","Tab","Tabs","Box","Typography","Chip","Divider","FormControlLabel","Checkbox","ConfirmationModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","useStyles","theme","root","display","flexWrap","multFieldLine","marginRight","spacing","btnWrapper","position","buttonProgress","color","top","left","marginTop","marginLeft","formControl","margin","minWidth","colorAdorment","width","height","mediaContainer","flexDirection","gap","padding","border","concat","palette","divider","borderRadius","shape","marginBottom","mediaOptions","justifyContent","mediaInfo","alignItems","backgroundColor","grey","existingMediaActions","mediaPreview","maxWidth","maxHeight","QuickeMessageSchema","object","shortcode","string","required","isOficial","boolean","components","array","when","is","then","of","text","trim","otherwise","notRequired","QuickMessageDialog","_ref","open","onClose","quickemessageId","reload","classes","user","messageInputRef","initialState","message","geral","visao","status","language","category","metaID","confirmationOpen","setConfirmationOpen","quickemessage","setQuickemessage","attachment","setAttachment","audioBlob","setAudioBlob","tabIndex","setTabIndex","mediaMode","setMediaMode","isEditingMedia","setIsEditingMedia","attachmentFile","data","get","prevState","_objectSpread","err","handleClose","handleAttachmentFile","e","file","target","files","handleAudioRecorded","blob","handleAudioDeleted","handleCancelEdit","current","value","handleEditExistingMedia","getBasename","filepath","cleanPath","split","segments","length","handleSaveQuickeMessage","values","quickemessageData","isMedia","mediaPath","String","name","replace","Array","isArray","map","c","id","quickMessageRecord","put","post","messageId","delete","formData","FormData","append","console","log","type","size","Date","now","response","success","t","error","rowsWithIds","component","index","deleteMedia","prev","mediaName","mediaType","handleClickMsgVar","msgVar","setValueFunc","el","firstHalfText","substring","selectionStart","secondHalfText","selectionEnd","newCursorPos","Promise","r","setTimeout","setSelectionRange","handleTabChange","event","newValue","getMediaTypeIcon","getMediaPreview","quickmessage","mediaUrl","process","env","REACT_APP_BACKEND_URL","companyId","src","alt","className","onError","style","controls","children","hasNewMedia","hasExistingMedia","hasAnyMedia","title","onConfirm","fullWidth","scroll","accept","ref","onChange","initialValues","isStarter","enableReinitialize","validationSchema","onSubmit","actions","setSubmitting","_ref2","touched","errors","isSubmitting","setFieldValue","isDisabled","userId","dividers","indicatorColor","textColor","centered","label","container","xs","item","as","autoFocus","disabled","Boolean","helperText","variant","inputRef","multiline","rows","md","xl","showSchedulingVars","onClick","gutterBottom","align","startIcon","click","onAudioRecorded","onAudioDeleted","placeholder","labelId","control","columns","field","headerName","pageSize","disableSelectionOnClick","autoHeight","comp","idx","sm"],"sources":["/home/deploy/codigologlow/frontend/src/components/QuickMessageDialog/index.js"],"sourcesContent":["import React, { useContext, useState, useEffect, useRef } from \"react\";\n\nimport * as Yup from \"yup\";\nimport { Formik, Form, Field, getIn } from \"formik\";\nimport { toast } from \"react-toastify\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { green } from \"@material-ui/core/colors\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport AttachFileIcon from \"@material-ui/icons/AttachFile\";\nimport MicIcon from \"@material-ui/icons/Mic\";\nimport DeleteOutlineIcon from \"@material-ui/icons/DeleteOutline\";\nimport EditIcon from \"@material-ui/icons/Edit\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { i18n } from \"../../translate/i18n\";\nimport { head } from \"lodash\";\nimport api from \"../../services/api\";\nimport toastError from \"../../errors/toastError\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport MessageVariablesPicker from \"../MessageVariablesPicker\";\nimport { DataGrid } from \"@material-ui/data-grid\";\nimport AudioRecorder from \"../AudioRecorder\";\n\nimport {\n  FormControl,\n  Grid,\n  InputLabel,\n  MenuItem,\n  Select,\n  Tab,\n  Tabs,\n  Box,\n  Typography,\n  Chip,\n  Divider,\n  FormControlLabel,\n  Checkbox\n} from \"@material-ui/core\";\nimport ConfirmationModal from \"../ConfirmationModal\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  },\n  multFieldLine: {\n    display: \"flex\",\n    \"& > *:not(:last-child)\": {\n      marginRight: theme.spacing(1),\n    },\n  },\n\n  btnWrapper: {\n    position: \"relative\",\n  },\n\n  buttonProgress: {\n    color: green[500],\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    marginTop: -12,\n    marginLeft: -12,\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n  colorAdorment: {\n    width: 20,\n    height: 20,\n  },\n  mediaContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    gap: theme.spacing(2),\n    padding: theme.spacing(2),\n    border: `1px solid ${theme.palette.divider}`,\n    borderRadius: theme.shape.borderRadius,\n    marginBottom: theme.spacing(2)\n  },\n  mediaOptions: {\n    display: 'flex',\n    gap: theme.spacing(1),\n    justifyContent: 'center',\n    flexWrap: 'wrap'\n  },\n  mediaInfo: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    padding: theme.spacing(1),\n    backgroundColor: theme.palette.grey[100],\n    borderRadius: theme.shape.borderRadius\n  },\n  existingMediaActions: {\n    display: 'flex',\n    gap: theme.spacing(1),\n    alignItems: 'center'\n  },\n  mediaPreview: {\n    maxWidth: '100%',\n    maxHeight: 200,\n    borderRadius: theme.shape.borderRadius,\n    marginTop: theme.spacing(1)\n  }\n}));\n\nconst QuickeMessageSchema = Yup.object().shape({\n  shortcode: Yup.string().required(\"Obrigat√≥rio\"),\n  isOficial: Yup.boolean(),\n  components: Yup.array().when(\"isOficial\", {\n    is: true,\n    then: Yup.array().of(\n      Yup.object().shape({\n        text: Yup.string().trim().required(\"Obrigat√≥rio\"),\n      })\n    ),\n    otherwise: Yup.array().notRequired(),\n  }),\n});\n\nconst QuickMessageDialog = ({ open, onClose, quickemessageId, reload }) => {\n  const classes = useStyles();\n  const { user } = useContext(AuthContext);\n\n  const messageInputRef = useRef();\n\n  const initialState = {\n    shortcode: \"\",\n    message: \"\",\n    geral: true,\n    visao: true,\n    isOficial: false,\n    status: \"\",\n    language: \"\",\n    category: \"\",\n    metaID: \"\",\n  };\n\n  const [confirmationOpen, setConfirmationOpen] = useState(false);\n  const [quickemessage, setQuickemessage] = useState(initialState);\n  const [attachment, setAttachment] = useState(null);\n  const [audioBlob, setAudioBlob] = useState(null);\n  const [tabIndex, setTabIndex] = useState(0);\n  const [mediaMode, setMediaMode] = useState(null); // 'file', 'audio', 'edit', null\n  const [isEditingMedia, setIsEditingMedia] = useState(false);\n  const attachmentFile = useRef(null);\n\n  useEffect(() => {\n    try {\n      (async () => {\n        if (!quickemessageId) return;\n\n        const { data } = await api.get(`/quick-messages/${quickemessageId}`);\n\n        setQuickemessage((prevState) => {\n          return { ...prevState, ...data };\n        });\n\n        // Reset media editing state when loading existing message\n        setIsEditingMedia(false);\n        setMediaMode(null);\n      })();\n    } catch (err) {\n      toastError(err);\n    }\n  }, [quickemessageId, open]);\n\n  const handleClose = () => {\n    setQuickemessage(initialState);\n    setAttachment(null);\n    setAudioBlob(null);\n    setMediaMode(null);\n    setIsEditingMedia(false);\n    onClose();\n  };\n\n  const handleAttachmentFile = (e) => {\n    const file = head(e.target.files);\n    if (file) {\n      setAttachment(file);\n      setAudioBlob(null); // Limpar √°udio se existir\n      setMediaMode('file');\n      setIsEditingMedia(true);\n    }\n  };\n\n  const handleAudioRecorded = (blob) => {\n    setAudioBlob(blob);\n    setAttachment(null); // Limpar arquivo se existir\n    setMediaMode('audio');\n    setIsEditingMedia(true);\n  };\n\n  const handleAudioDeleted = () => {\n    setAudioBlob(null);\n    setMediaMode(null);\n    setIsEditingMedia(false);\n  };\n\n  const handleCancelEdit = () => {\n    setAttachment(null);\n    setAudioBlob(null);\n    setMediaMode(null);\n    setIsEditingMedia(false);\n    if (attachmentFile.current) {\n      attachmentFile.current.value = null;\n    }\n  };\n\n  const handleEditExistingMedia = () => {\n    setIsEditingMedia(true);\n    setMediaMode('edit');\n  };\n\n  const getBasename = (filepath) => {\n    if (!filepath) return '';\n    // Remove query strings e hashes\n    const cleanPath = filepath.split('?')[0].split('#')[0];\n    // Pega o √∫ltimo segmento ap√≥s /\n    const segments = cleanPath.split('/');\n    return segments[segments.length - 1];\n  };\n\n  const handleSaveQuickeMessage = async (values) => {\n    const quickemessageData = {\n      ...values,\n      isMedia: !!(attachment || audioBlob || (quickemessage.mediaPath && !isEditingMedia)),\n      mediaPath: attachment\n        ? String(attachment.name).replace(/ /g, \"_\")\n        : values.mediaPath\n          ? getBasename(values.mediaPath).replace(/ /g, \"_\")\n          : null,\n      isOficial: quickemessageId ? values.isOficial : false,\n    };\n\n    // Inclui componentes editados (template oficial)\n    if (Array.isArray(values.components)) {\n      quickemessageData.components = values.components.map(c => ({ id: c.id, text: c.text }));\n    }\n\n    try {\n      let quickMessageRecord;\n\n      if (quickemessageId) {\n        quickMessageRecord = await api.put(`/quick-messages/${quickemessageId}`, quickemessageData);\n      } else {\n        const { data } = await api.post(\"/quick-messages\", quickemessageData);\n        quickMessageRecord = { data };\n      }\n\n      const messageId = quickemessageId || quickMessageRecord.data.id;\n\n      // Se est√° editando m√≠dia, primeiro remover a m√≠dia antiga\n      if (isEditingMedia && quickemessage.mediaPath) {\n        await api.delete(`/quick-messages/${messageId}/media-upload`);\n      }\n\n      // Upload de arquivo comum\n      if (attachment) {\n        const formData = new FormData();\n        formData.append(\"typeArch\", \"quickMessage\"); // ‚úÖ IMPORTANTE\n        formData.append(\"file\", attachment);\n\n        console.log(\"üì§ Enviando arquivo:\", {\n          name: attachment.name,\n          type: attachment.type,\n          size: attachment.size\n        });\n\n        await api.post(`/quick-messages/${messageId}/media-upload`, formData);\n      }\n\n      // ‚úÖ CORRE√á√ÉO: Upload de √°udio gravado\n      if (audioBlob) {\n        const formData = new FormData();\n        formData.append(\"typeArch\", \"quickMessage\"); // ‚úÖ IMPORTANTE para o multer\n        formData.append(\"audio\", audioBlob, `audio_${Date.now()}.webm`); // ‚úÖ fieldname = 'audio'\n\n        console.log(\"üéµ Enviando √°udio gravado:\", {\n          size: audioBlob.size,\n          type: audioBlob.type\n        });\n\n        const response = await api.post(`/quick-messages/${messageId}/audio-upload`, formData);\n        console.log(\"‚úÖ Resposta do upload de √°udio:\", response.data);\n      }\n\n      toast.success(i18n.t(\"quickMessages.toasts.success\"));\n      if (typeof reload === \"function\") {\n        reload();\n      }\n    } catch (err) {\n      console.error(\"‚ùå Erro ao salvar quick message:\", err);\n      toastError(err);\n    }\n    handleClose();\n  };\n\n  const rowsWithIds = (quickemessage?.components || []).map((component, index) => ({\n    id: index,\n    ...component,\n  }));\n\n  const deleteMedia = async () => {\n    if (attachment) {\n      setAttachment(null);\n      attachmentFile.current.value = null;\n    }\n\n    if (audioBlob) {\n      setAudioBlob(null);\n    }\n\n    if (quickemessage.mediaPath) {\n      await api.delete(`/quick-messages/${quickemessage.id}/media-upload`);\n      setQuickemessage((prev) => ({\n        ...prev,\n        mediaPath: null,\n        mediaName: null,\n        mediaType: null\n      }));\n      toast.success(i18n.t(\"quickMessages.toasts.deleted\"));\n      if (typeof reload === \"function\") {\n        reload();\n      }\n    }\n\n    setMediaMode(null);\n    setIsEditingMedia(false);\n  };\n\n  const handleClickMsgVar = async (msgVar, setValueFunc) => {\n    const el = messageInputRef.current;\n    const firstHalfText = el.value.substring(0, el.selectionStart);\n    const secondHalfText = el.value.substring(el.selectionEnd);\n    const newCursorPos = el.selectionStart + msgVar.length;\n\n    setValueFunc(\"message\", `${firstHalfText}${msgVar}${secondHalfText}`);\n\n    await new Promise((r) => setTimeout(r, 100));\n    messageInputRef.current.setSelectionRange(newCursorPos, newCursorPos);\n  };\n\n  const handleTabChange = (event, newValue) => {\n    setTabIndex(newValue);\n  };\n\n  const getMediaTypeIcon = (mediaType) => {\n    switch (mediaType) {\n      case 'audio': return 'üéµ';\n      case 'image': return 'üñºÔ∏è';\n      case 'video': return 'üé•';\n      default: return 'üìé';\n    }\n  };\n\n  const getMediaPreview = (quickmessage) => {\n    if (!quickmessage.mediaPath) return null;\n\n    const mediaUrl = `${process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080'}/public/company${user.companyId}/quickMessage/${quickmessage.mediaName}`;\n\n    if (quickmessage.mediaType === 'image') {\n      return (\n        <img\n          src={mediaUrl}\n          alt={quickmessage.mediaName}\n          className={classes.mediaPreview}\n          onError={(e) => { e.target.style.display = 'none'; }}\n        />\n      );\n    }\n\n    //if (quickmessage.mediaType === 'audio') {\n    //  return (\n    //    <audio \n    //      controls \n    //      className={classes.mediaPreview}\n    //      src={mediaUrl}\n    //   >\n    //      Seu navegador n√£o suporta o elemento de √°udio.\n    //    </audio>\n    //  );\n    //}\n\n    if (quickmessage.mediaType === 'video') {\n      return (\n        <video\n          controls\n          className={classes.mediaPreview}\n          src={mediaUrl}\n        >\n          Seu navegador n√£o suporta o elemento de v√≠deo.\n        </video>\n      );\n    }\n\n    return null;\n  };\n\n  // Verificar se h√° nova m√≠dia sendo adicionada\n  const hasNewMedia = attachment || audioBlob;\n  // Verificar se h√° m√≠dia existente (e n√£o est√° sendo editada)\n  const hasExistingMedia = quickemessage.mediaPath && !isEditingMedia;\n  // Verificar se h√° qualquer tipo de m√≠dia\n  const hasAnyMedia = hasNewMedia || hasExistingMedia;\n\n  return (\n    <div className={classes.root}>\n      <ConfirmationModal\n        title={i18n.t(\"quickMessages.confirmationModal.deleteTitle\")}\n        open={confirmationOpen}\n        onClose={() => setConfirmationOpen(false)}\n        onConfirm={deleteMedia}\n      >\n        {i18n.t(\"quickMessages.confirmationModal.deleteMessage\")}\n      </ConfirmationModal>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        maxWidth=\"xl\"\n        fullWidth\n        scroll=\"paper\"\n      >\n        <DialogTitle id=\"form-dialog-title\">\n          {quickemessageId\n            ? `${i18n.t(\"quickMessages.dialog.edit\")}`\n            : `${i18n.t(\"quickMessages.dialog.add\")}`}\n        </DialogTitle>\n        <div style={{ display: \"none\" }}>\n          <input\n            type=\"file\"\n            accept=\"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt\"\n            ref={attachmentFile}\n            onChange={(e) => handleAttachmentFile(e)}\n          />\n        </div>\n        <Formik\n          initialValues={{\n            ...quickemessage,\n            isStarter: quickemessage?.isStarter || false,\n          }}\n          enableReinitialize={true}\n          validationSchema={QuickeMessageSchema}\n          onSubmit={(values, actions) => {\n            setTimeout(() => {\n              handleSaveQuickeMessage(values);\n              actions.setSubmitting(false);\n            }, 400);\n          }}\n        >\n          {({ touched, errors, isSubmitting, setFieldValue, values }) => {\n            // Fun√ß√£o para verificar se os campos est√£o desabilitados\n            const isDisabled = quickemessageId &&\n              values.visao &&\n              !values.geral &&\n              values.userId !== user.id;\n\n            return (\n              <Form>\n                <DialogContent dividers>\n                  <Tabs\n                    value={tabIndex}\n                    onChange={handleTabChange}\n                    indicatorColor=\"primary\"\n                    textColor=\"primary\"\n                    centered\n                  >\n                    <Tab label={i18n.t(\"quickMessages.dialog.general\")} />\n                    {values.isOficial && <Tab label=\"Oficial\" />}\n                  </Tabs>\n                  {tabIndex === 0 && (\n                    <Grid spacing={2} container>\n                      <Grid xs={12} item>\n                        <Field\n                          as={TextField}\n                          autoFocus\n                          label={i18n.t(\"quickMessages.dialog.shortcode\")}\n                          name=\"shortcode\"\n                          disabled={isDisabled}\n                          error={touched.shortcode && Boolean(errors.shortcode)}\n                          helperText={touched.shortcode && errors.shortcode}\n                          variant=\"outlined\"\n                          margin=\"dense\"\n                          fullWidth\n                        />\n                      </Grid>\n                      <Grid xs={12} item>\n                        <Field\n                          as={TextField}\n                          label={i18n.t(\"quickMessages.dialog.message\")}\n                          name=\"message\"\n                          inputRef={messageInputRef}\n                          error={touched.message && Boolean(errors.message)}\n                          helperText={touched.message && errors.message}\n                          variant=\"outlined\"\n                          margin=\"dense\"\n                          disabled={isDisabled}\n                          multiline={true}\n                          rows={7}\n                          fullWidth\n                        />\n                      </Grid>\n\n                      <Grid item xs={12} md={12} xl={12}>\n                        <MessageVariablesPicker\n                          disabled={isSubmitting || isDisabled}\n                          showSchedulingVars={true}\n                          onClick={(value) =>\n                            handleClickMsgVar(value, setFieldValue)\n                          }\n                        />\n                      </Grid>\n\n                      {/* Se√ß√£o de M√≠dia */}\n                      <Grid xs={12} item>\n                        <Box className={classes.mediaContainer}>\n                          <Typography variant=\"h6\" gutterBottom>\n                            Anexar M√≠dia\n                          </Typography>\n\n                          {/* M√≠dia existente */}\n                          {hasExistingMedia && (\n                            <>\n                              <Box className={classes.mediaInfo}>\n                                <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                                  <span>{getMediaTypeIcon(quickemessage.mediaType)}</span>\n                                  <Typography variant=\"body2\">\n                                    {quickemessage.mediaName}\n                                  </Typography>\n                                  {quickemessage.mediaType && (\n                                    <Chip\n                                      size=\"small\"\n                                      label={quickemessage.mediaType}\n                                      variant=\"outlined\"\n                                    />\n                                  )}\n                                </Box>\n                                <Box className={classes.existingMediaActions}>\n                                  <IconButton\n                                    onClick={handleEditExistingMedia}\n                                    color=\"primary\"\n                                    size=\"small\"\n                                    title=\"Editar m√≠dia\"\n                                    disabled={isDisabled}\n                                  >\n                                    <EditIcon />\n                                  </IconButton>\n                                  <IconButton\n                                    onClick={() => setConfirmationOpen(true)}\n                                    color=\"secondary\"\n                                    size=\"small\"\n                                    title=\"Remover m√≠dia\"\n                                    disabled={isDisabled}\n                                  >\n                                    <DeleteOutlineIcon />\n                                  </IconButton>\n                                </Box>\n                              </Box>\n\n                              {/* Preview da m√≠dia existente */}\n                              {getMediaPreview(quickemessage)}\n                            </>\n                          )}\n\n                          {/* Nova m√≠dia (arquivo selecionado) */}\n                          {attachment && (\n                            <>\n                              <Box className={classes.mediaInfo}>\n                                <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                                  <AttachFileIcon />\n                                  <Typography variant=\"body2\">\n                                    {attachment.name}\n                                  </Typography>\n                                  <Chip size=\"small\" label=\"Novo Arquivo\" color=\"primary\" />\n                                </Box>\n                                <IconButton\n                                  onClick={() => {\n                                    setAttachment(null);\n                                    setMediaMode(null);\n                                    setIsEditingMedia(false);\n                                    if (attachmentFile.current) {\n                                      attachmentFile.current.value = null;\n                                    }\n                                  }}\n                                  color=\"secondary\"\n                                  size=\"small\"\n                                >\n                                  <DeleteOutlineIcon />\n                                </IconButton>\n                              </Box>\n                            </>\n                          )}\n\n                          {/* √Åudio gravado */}\n                          {audioBlob && (\n                            <>\n                              <Box className={classes.mediaInfo}>\n                                <Box display=\"flex\" alignItems=\"center\" gap={1}>\n                                  <MicIcon />\n                                  <Typography variant=\"body2\">\n                                    Novo √°udio gravado\n                                  </Typography>\n                                  <Chip size=\"small\" label=\"Novo √Åudio\" color=\"secondary\" />\n                                </Box>\n                                <IconButton\n                                  onClick={handleAudioDeleted}\n                                  color=\"secondary\"\n                                  size=\"small\"\n                                >\n                                  <DeleteOutlineIcon />\n                                </IconButton>\n                              </Box>\n                            </>\n                          )}\n\n                          {/* Op√ß√µes de m√≠dia quando n√£o h√° m√≠dia anexada OU quando est√° editando */}\n                          {(!hasAnyMedia || isEditingMedia) && (\n                            <>\n                              {isEditingMedia && hasExistingMedia && (\n                                <>\n                                  <Divider />\n                                  <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n                                    Escolha uma nova m√≠dia para substituir:\n                                  </Typography>\n                                </>\n                              )}\n\n                              {!hasAnyMedia && (\n                                <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n                                  Escolha uma op√ß√£o para anexar m√≠dia:\n                                </Typography>\n                              )}\n\n                              <Box className={classes.mediaOptions}>\n                                <Button\n                                  variant=\"outlined\"\n                                  startIcon={<AttachFileIcon />}\n                                  onClick={() => attachmentFile.current.click()}\n                                  disabled={isSubmitting || isDisabled}\n                                >\n                                  Anexar Arquivo\n                                </Button>\n                                <Button\n                                  variant=\"outlined\"\n                                  startIcon={<MicIcon />}\n                                  onClick={() => setMediaMode('audio')}\n                                  disabled={isSubmitting || isDisabled}\n                                >\n                                  Gravar √Åudio\n                                </Button>\n\n                                {isEditingMedia && (\n                                  <Button\n                                    variant=\"outlined\"\n                                    color=\"secondary\"\n                                    onClick={handleCancelEdit}\n                                    disabled={isSubmitting}\n                                  >\n                                    Cancelar Edi√ß√£o\n                                  </Button>\n                                )}\n                              </Box>\n                            </>\n                          )}\n\n                          {/* Componente de grava√ß√£o de √°udio */}\n                          {mediaMode === 'audio' && !audioBlob && (\n                            <AudioRecorder\n                              onAudioRecorded={handleAudioRecorded}\n                              onAudioDeleted={handleAudioDeleted}\n                              disabled={isSubmitting || isDisabled}\n                            />\n                          )}\n                        </Box>\n                      </Grid>\n\n                      <Grid xs={12} item>\n                        <FormControl variant=\"outlined\" margin=\"dense\" fullWidth>\n                          <InputLabel id=\"geral-selection-label\">\n                            {i18n.t(\"quickMessages.dialog.visao\")}\n                          </InputLabel>\n                          <Field\n                            as={Select}\n                            label={i18n.t(\"quickMessages.dialog.visao\")}\n                            placeholder={i18n.t(\"quickMessages.dialog.visao\")}\n                            labelId=\"visao-selection-label\"\n                            id=\"visao\"\n                            disabled={isDisabled}\n                            name=\"visao\"\n                            onChange={(e) => {\n                              setFieldValue(\"visao\", e.target.value === \"true\");\n                            }}\n                            error={touched.visao && Boolean(errors.visao)}\n                            value={values.visao ? \"true\" : \"false\"}\n                          >\n                            <MenuItem value={\"true\"}>\n                              {i18n.t(\"announcements.active\")}\n                            </MenuItem>\n                            <MenuItem value={\"false\"}>\n                              {i18n.t(\"announcements.inactive\")}\n                            </MenuItem>\n                          </Field>\n                        </FormControl>\n                        {values.visao === true && (\n                          <FormControl\n                            variant=\"outlined\"\n                            margin=\"dense\"\n                            fullWidth\n                          >\n                            <InputLabel id=\"geral-selection-label\">\n                              {i18n.t(\"quickMessages.dialog.geral\")}\n                            </InputLabel>\n                            <Field\n                              as={Select}\n                              label={i18n.t(\"quickMessages.dialog.geral\")}\n                              placeholder={i18n.t(\"quickMessages.dialog.geral\")}\n                              labelId=\"novo-item-selection-label\"\n                              id=\"geral\"\n                              name=\"geral\"\n                              disabled={isDisabled}\n                              value={values.geral ? \"true\" : \"false\"}\n                              error={touched.geral && Boolean(errors.geral)}\n                            >\n                              <MenuItem value={\"true\"}>\n                                {i18n.t(\"announcements.active\")}\n                              </MenuItem>\n                              <MenuItem value={\"false\"}>\n                                {i18n.t(\"announcements.inactive\")}\n                              </MenuItem>\n                            </Field>\n                          </FormControl>\n                        )}\n                      </Grid>\n                    </Grid>\n                  )}\n                  {tabIndex === 1 && (\n                    <>\n                      {values.isOficial && (\n                        <Grid container spacing={2}>\n                          <Grid xs={12} item>\n                            <FormControlLabel\n                              control={\n                                <Field\n                                  name=\"isStarter\"\n                                  type=\"checkbox\"\n                                  as={Checkbox}\n                                  color=\"primary\"\n                                />\n                              }\n                              label=\"Template inicia conversa com o cliente\"\n                            />\n                          </Grid>\n                        </Grid>\n                      )}\n                      <Grid xs={12} item>\n                        <DataGrid\n                          rows={rowsWithIds || []}\n                          columns={[\n                            { field: \"type\", headerName: \"Tipo\", width: 150 },\n                            { field: \"text\", headerName: \"Valor\", width: 400 },\n                          ]}\n                          pageSize={5}\n                          disableSelectionOnClick\n                          autoHeight={true}\n                        />\n                      </Grid>\n                      {/* Edi√ß√£o dos textos do template (Oficial) */}\n                      {values.isOficial && (\n                        <Grid container spacing={2}>\n                          {(values.components || []).map((comp, idx) => (\n                            <Grid key={comp.id || idx} xs={12} item>\n                              <Box display=\"flex\" alignItems=\"center\" gap={8}>\n                                <Chip size=\"small\" label={comp.type || \"component\"} />\n                              </Box>\n                              <Field\n                                as={TextField}\n                                label={`Texto (${comp.type || 'component'})`}\n                                name={`components.${idx}.text`}\n                                variant=\"outlined\"\n                                margin=\"dense\"\n                                fullWidth\n                                error={Boolean(getIn(touched, `components.${idx}.text`) && getIn(errors, `components.${idx}.text`))}\n                                helperText={getIn(touched, `components.${idx}.text`) && getIn(errors, `components.${idx}.text`)}\n                              />\n                            </Grid>\n                          ))}\n                        </Grid>\n                      )}\n                      <Grid container spacing={2}>\n                        <Grid xl={6} md={6} sm={12} xs={12} item>\n                          <Field\n                            as={TextField}\n                            autoFocus\n                            label={i18n.t(\"quickMessages.dialog.status\")}\n                            name=\"status\"\n                            disabled={values.isOficial}\n                            error={touched.status && Boolean(errors.status)}\n                            helperText={touched.status && errors.status}\n                            variant=\"outlined\"\n                            margin=\"dense\"\n                            fullWidth\n                          />\n                        </Grid>\n                        <Grid xl={6} md={6} sm={12} xs={12} item>\n                          <Field\n                            as={TextField}\n                            autoFocus\n                            label={i18n.t(\"quickMessages.dialog.language\")}\n                            name=\"language\"\n                            disabled={values.isOficial}\n                            error={touched.language && Boolean(errors.language)}\n                            helperText={touched.language && errors.language}\n                            variant=\"outlined\"\n                            margin=\"dense\"\n                            fullWidth\n                          />\n                        </Grid>\n                        <Grid xl={6} md={6} sm={12} xs={12} item>\n                          <Field\n                            as={TextField}\n                            autoFocus\n                            label={i18n.t(\"quickMessages.dialog.category\")}\n                            name=\"category\"\n                            disabled={values.isOficial}\n                            error={touched.category && Boolean(errors.category)}\n                            helperText={touched.category && errors.category}\n                            variant=\"outlined\"\n                            margin=\"dense\"\n                            fullWidth\n                          />\n                        </Grid>\n                        <Grid xl={6} md={6} sm={12} xs={12} item>\n                          <Field\n                            as={TextField}\n                            autoFocus\n                            label={i18n.t(\"quickMessages.dialog.metaID\")}\n                            name=\"metaID\"\n                            disabled={values.isOficial}\n                            error={touched.metaID && Boolean(errors.metaID)}\n                            helperText={touched.metaID && errors.metaID}\n                            variant=\"outlined\"\n                            margin=\"dense\"\n                            fullWidth\n                          />\n                        </Grid>\n                      </Grid>\n                    </>\n                  )}\n                </DialogContent>\n                <DialogActions>\n                  <Button\n                    onClick={handleClose}\n                    color=\"secondary\"\n                    disabled={isSubmitting}\n                    variant=\"outlined\"\n                  >\n                    {i18n.t(\"quickMessages.buttons.cancel\")}\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    color=\"primary\"\n                    disabled={isSubmitting || isDisabled}\n                    variant=\"contained\"\n                    className={classes.btnWrapper}\n                  >\n                    {quickemessageId\n                      ? `${i18n.t(\"quickMessages.buttons.edit\")}`\n                      : `${i18n.t(\"quickMessages.buttons.add\")}`}\n                    {isSubmitting && (\n                      <CircularProgress\n                        size={24}\n                        className={classes.buttonProgress}\n                      />\n                    )}\n                  </Button>\n                </DialogActions>\n              </Form>\n            );\n          }}\n        </Formik>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default QuickMessageDialog;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}