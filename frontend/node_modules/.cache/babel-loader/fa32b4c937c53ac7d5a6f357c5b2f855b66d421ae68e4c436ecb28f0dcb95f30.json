{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef,useContext,useCallback}from\"react\";import{useHistory,useParams}from\"react-router-dom\";import{parseISO,format,isSameDay}from\"date-fns\";import clsx from\"clsx\";import{makeStyles,useTheme}from\"@material-ui/core/styles\";import{green,grey}from\"@material-ui/core/colors\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import ButtonWithSpinner from\"../ButtonWithSpinner\";import MarkdownWrapper from\"../MarkdownWrapper\";import{List,Tooltip}from\"@material-ui/core\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{TicketsContext}from\"../../context/Tickets/TicketsContext\";import toastError from\"../../errors/toastError\";import{v4 as uuidv4}from\"uuid\";import GroupIcon from\"@material-ui/icons/Group\";import ContactTag from\"../ContactTag\";import ConnectionIcon from\"../ConnectionIcon\";import AcceptTicketWithouSelectQueue from\"../AcceptTicketWithoutQueueModal\";import TransferTicketModalCustom from\"../TransferTicketModalCustom\";import ShowTicketOpen from\"../ShowTicketOpenModal\";import FinalizacaoVendaModal from\"../FinalizacaoVendaModal\";import{isNil}from\"lodash\";import{toast}from\"react-toastify\";import{Done,HighlightOff,SwapHoriz,Add}from\"@material-ui/icons\";import VisibilityIcon from\"@material-ui/icons/Visibility\";// Ícone de spy\nimport useCompanySettings from\"../../hooks/useSettings/companySettings\";import NewTicketModal from\"../NewTicketModal\";import{Avatar,Badge,ListItemAvatar,ListItem,ListItemSecondaryAction,ListItemText,Typography,Dialog,DialogTitle,DialogActions,Button,DialogContent}from\"@material-ui/core\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({ticket:{position:\"relative\"},pendingTicket:{cursor:\"unset\"},queueTag:{background:\"#FCFCFC\",color:\"#000\",marginRight:1,padding:1,fontWeight:\"bold\",borderRadius:3,fontSize:\"0.5em\",whiteSpace:\"nowrap\"},noTicketsDiv:{display:\"flex\",height:\"100px\",margin:40,flexDirection:\"column\",alignItems:\"center\",justifyContent:\"center\"},newMessagesCount:{justifySelf:\"flex-end\",textAlign:\"right\",position:\"relative\",top:0,color:\"green\",fontWeight:\"bold\",marginRight:\"10px\",borderRadius:0},noTicketsText:{textAlign:\"center\",color:\"rgb(104, 121, 146)\",fontSize:\"14px\",lineHeight:\"1.4\"},connectionTag:{background:\"green\",color:\"#FFF\",marginRight:1,padding:1,fontWeight:\"bold\",borderRadius:3,fontSize:\"0.6em\"},noTicketsTitle:{textAlign:\"center\",fontSize:\"16px\",fontWeight:\"600\",margin:\"0px\"},contactNameWrapper:{display:\"flex\",justifyContent:\"space-between\",marginLeft:\"5px\",fontWeight:\"bold\",color:theme.mode===\"light\"?\"black\":\"white\"},lastMessageTime:{justifySelf:\"flex-end\",textAlign:\"right\",position:\"relative\",top:-30,marginRight:\"1px\",color:theme.mode===\"light\"?\"black\":grey[400]},lastMessageTimeUnread:{justifySelf:\"flex-end\",textAlign:\"right\",position:\"relative\",top:-30,color:\"green\",fontWeight:\"bold\",marginRight:\"1px\"},closedBadge:{alignSelf:\"center\",justifySelf:\"flex-end\",marginRight:32,marginLeft:\"auto\"},contactLastMessage:{paddingRight:\"0%\",marginLeft:\"5px\",color:theme.mode===\"light\"?\"black\":grey[400]},contactLastMessageUnread:{paddingRight:20,fontWeight:\"bold\",color:theme.mode===\"light\"?\"black\":grey[400]// width: \"50%\",\n},badgeStyle:{color:\"white\",backgroundColor:green[500]},acceptButton:{position:\"absolute\",right:\"1px\"},ticketQueueColor:{flex:\"none\",height:\"100%\",position:\"absolute\",top:\"0%\",left:\"0%\"},ticketInfo:{position:\"relative\",top:-13},secondaryContentSecond:{display:\"flex\",alignItems:\"flex-start\",flexWrap:\"nowrap\",flexDirection:\"row\",alignContent:\"flex-start\"},ticketInfo1:{position:\"relative\",top:13,right:0},Radiusdot:{\"& .MuiBadge-badge\":{borderRadius:2,position:\"inherit\",height:16,margin:2,padding:3},\"& .MuiBadge-anchorOriginTopRightRectangle\":{transform:\"scale(1) translate(0%, -40%)\"}},connectionIcon:{marginRight:theme.spacing(1)},// Estilos para o modal da imagem\nimageModal:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},imageModalContent:{outline:\"none\",maxWidth:\"90vw\",maxHeight:\"90vh\"},expandedImage:{width:\"100%\",height:\"auto\",maxWidth:\"500px\",borderRadius:theme.spacing(1)},clickableAvatar:{cursor:\"pointer\",\"&:hover\":{opacity:0.8}}}));const TicketListItemCustom=_ref=>{var _ticket$contact2,_ticket$contact3,_ticket$whatsapp2,_ticket$whatsapp3,_ticket$queue,_ticket$queue2,_ticket$user,_ticket$contact4,_ticket$contact4$tags,_ticket$tags,_ticket$contact5,_ticket$contact6;let{setTabOpen,ticket}=_ref;const classes=useStyles();const theme=useTheme();const history=useHistory();const[loading,setLoading]=useState(false);const[acceptTicketWithouSelectQueueOpen,setAcceptTicketWithouSelectQueueOpen]=useState(false);const[transferTicketModalOpen,setTransferTicketModalOpen]=useState(false);const[newTicketModalOpen,setNewTicketModalOpen]=useState(false);const[openAlert,setOpenAlert]=useState(false);const[userTicketOpen,setUserTicketOpen]=useState(\"\");const[queueTicketOpen,setQueueTicketOpen]=useState(\"\");// Estados para o modal de finalização de venda\nconst[openFinalizacaoVenda,setOpenFinalizacaoVenda]=useState(false);const[finalizacaoTipo,setFinalizacaoTipo]=useState(null);const[ticketDataToFinalize,setTicketDataToFinalize]=useState(null);const[showFinalizacaoOptions,setShowFinalizacaoOptions]=useState(false);const[imageModalOpen,setImageModalOpen]=useState(false);// Estado para o modal da imagem\nconst{ticketId}=useParams();const isMounted=useRef(true);const{setCurrentTicket}=useContext(TicketsContext);const{user}=useContext(AuthContext);const{get:getSetting}=useCompanySettings();useEffect(()=>{return()=>{isMounted.current=false;};},[]);// Função para abrir modal da imagem\nconst handleImageClick=e=>{var _ticket$contact;e.stopPropagation();// Prevenir que o clique no avatar selecione o ticket\nif(ticket!==null&&ticket!==void 0&&(_ticket$contact=ticket.contact)!==null&&_ticket$contact!==void 0&&_ticket$contact.urlPicture){setImageModalOpen(true);}};// Função para fechar modal da imagem\nconst handleImageModalClose=()=>{setImageModalOpen(false);};const handleOpenAcceptTicketWithouSelectQueue=useCallback(()=>{setAcceptTicketWithouSelectQueueOpen(true);},[]);const handleCloseTicket=async id=>{// Verificar se a finalização com valor de venda está ativa\nif(user.finalizacaoComValorVendaAtiva===true||user.finalizacaoComValorVendaAtiva===\"true\"){// Se estiver ativa, abrir o modal de finalização de venda\nsetFinalizacaoTipo(\"comDespedida\");setOpenFinalizacaoVenda(true);handleSelectTicket(ticket);history.push(\"/tickets/\".concat(ticket.uuid));}else{// Comportamento original\nconst setting=await getSetting({column:\"requiredTag\"});if(setting.requiredTag===\"enabled\"){//verificar se tem uma tag\ntry{const contactTags=await api.get(\"/contactTags/\".concat(ticket.contact.id));if(!contactTags.data.tags){toast.warning(i18n.t(\"messagesList.header.buttons.requiredTag\"));}else{await api.put(\"/tickets/\".concat(id),{status:\"closed\",userId:(user===null||user===void 0?void 0:user.id)||null});if(isMounted.current){setLoading(false);}history.push(\"/tickets/\");}}catch(err){setLoading(false);toastError(err);}}else{setLoading(true);try{await api.put(\"/tickets/\".concat(id),{status:\"closed\",userId:(user===null||user===void 0?void 0:user.id)||null});}catch(err){setLoading(false);toastError(err);}if(isMounted.current){setLoading(false);}history.push(\"/tickets/\");}}};const handleCloseIgnoreTicket=async id=>{setLoading(true);try{await api.put(\"/tickets/\".concat(id),{status:\"closed\",userId:(user===null||user===void 0?void 0:user.id)||null,sendFarewellMessage:false,amountUsedBotQueues:0});}catch(err){setLoading(false);toastError(err);}if(isMounted.current){setLoading(false);}history.push(\"/tickets/\");};const truncate=(str,len)=>{if(!isNil(str)){if(str.length>len){return str.substring(0,len)+\"...\";}return str;}};const handleCloseTransferTicketModal=useCallback(()=>{if(isMounted.current){setTransferTicketModalOpen(false);}},[]);const handleOpenTransferModal=()=>{setLoading(true);setTransferTicketModalOpen(true);if(isMounted.current){setLoading(false);}handleSelectTicket(ticket);history.push(\"/tickets/\".concat(ticket.uuid));};const handleOpenNewTicketModal=()=>{setNewTicketModalOpen(true);};const handleCloseNewTicketModal=newTicket=>{setNewTicketModalOpen(false);if(newTicket){// Se um novo ticket foi criado, redirecionar para ele\nhandleSelectTicket(newTicket);history.push(\"/tickets/\".concat(newTicket.uuid));}};const handleAcepptTicket=async id=>{setLoading(true);try{const otherTicket=await api.put(\"/tickets/\".concat(id),{status:ticket.isGroup&&ticket.channel===\"whatsapp\"?\"group\":\"open\",userId:user===null||user===void 0?void 0:user.id});if(otherTicket.data.id!==ticket.id){if(otherTicket.data.userId!==(user===null||user===void 0?void 0:user.id)){setOpenAlert(true);setUserTicketOpen(otherTicket.data.user.name);setQueueTicketOpen(otherTicket.data.queue.name);}else{setLoading(false);setTabOpen(ticket.isGroup?\"group\":\"open\");handleSelectTicket(otherTicket.data);history.push(\"/tickets/\".concat(otherTicket.uuid));}}else{var _ticket$whatsapp;let setting;try{setting=await getSetting({column:\"sendGreetingAccepted\"});}catch(err){toastError(err);}if(setting.sendGreetingAccepted===\"enabled\"&&(!ticket.isGroup||((_ticket$whatsapp=ticket.whatsapp)===null||_ticket$whatsapp===void 0?void 0:_ticket$whatsapp.groupAsTicket)===\"enabled\")){handleSendMessage(ticket.id);}if(isMounted.current){setLoading(false);}setTabOpen(ticket.isGroup?\"group\":\"open\");handleSelectTicket(ticket);history.push(\"/tickets/\".concat(ticket.uuid));}}catch(err){setLoading(false);toastError(err);}};const handleSendMessage=async id=>{let setting;try{setting=await getSetting({column:\"greetingAcceptedMessage\"});}catch(err){toastError(err);}if(!setting.greetingAcceptedMessage){toast.warning(i18n.t(\"messagesList.header.buttons.greetingAcceptedMessage\"));return;}const msg=\"\".concat(setting.greetingAcceptedMessage);const message={read:1,fromMe:true,mediaUrl:\"\",body:\"\".concat(msg.trim())};try{await api.post(\"/messages/\".concat(id),message);}catch(err){toastError(err);}};const handleCloseAlert=useCallback(()=>{setOpenAlert(false);setLoading(false);},[]);const handleSelectTicket=ticket=>{const code=uuidv4();const{id,uuid}=ticket;setCurrentTicket({id,uuid,code});};const handleUpdateTicketStatusWithData=async(ticketData,sendFarewellMessage,finalizacaoMessage)=>{try{await api.put(\"/tickets/\".concat(ticket.id),_objectSpread(_objectSpread({},ticketData),{},{sendFarewellMessage,finalizacaoMessage}));toast.success(\"Ticket finalizado com sucesso!\");history.push(\"/tickets/\");}catch(err){toastError(err);}};// Função para espionar ticket chatbot\nconst handleSpyTicket=()=>{handleSelectTicket(ticket);history.push(\"/tickets/\".concat(ticket.uuid));};// Lógica de permissão para mensagens pending - MOVIDA PARA DEPOIS DE TODAS AS FUNÇÕES\nconst shouldBlurMessages=ticket.status===\"pending\"&&(user===null||user===void 0?void 0:user.allowSeeMessagesInPendingTickets)===\"disabled\";// Função para renderizar a mensagem com base na permissão - MOVIDA PARA DEPOIS DE TODAS AS FUNÇÕES\nconst renderLastMessage=()=>{if(shouldBlurMessages){return/*#__PURE__*/_jsx(MarkdownWrapper,{children:i18n.t(\"tickets.messageHidden\")||\"Mensagem oculta\"});}if(!ticket.lastMessage){return/*#__PURE__*/_jsx(\"br\",{});}if(ticket.lastMessage.includes(\"data:image/png;base64\")){return/*#__PURE__*/_jsx(MarkdownWrapper,{children:\"Localiza\\xE7\\xE3o\"});}if(ticket.lastMessage.includes(\"BEGIN:VCARD\")){return/*#__PURE__*/_jsx(MarkdownWrapper,{children:\"Contato\"});}return/*#__PURE__*/_jsx(MarkdownWrapper,{children:truncate(ticket.lastMessage,40)});};return/*#__PURE__*/_jsxs(React.Fragment,{children:[openAlert&&/*#__PURE__*/_jsx(ShowTicketOpen,{isOpen:openAlert,handleClose:handleCloseAlert,user:userTicketOpen,queue:queueTicketOpen}),acceptTicketWithouSelectQueueOpen&&/*#__PURE__*/_jsx(AcceptTicketWithouSelectQueue,{modalOpen:acceptTicketWithouSelectQueueOpen,onClose:e=>setAcceptTicketWithouSelectQueueOpen(false),ticketId:ticket.id,ticket:ticket}),transferTicketModalOpen&&/*#__PURE__*/_jsx(TransferTicketModalCustom,{modalOpen:transferTicketModalOpen,onClose:handleCloseTransferTicketModal,ticketid:ticket.id,ticket:ticket}),newTicketModalOpen&&/*#__PURE__*/_jsx(NewTicketModal,{modalOpen:newTicketModalOpen,onClose:handleCloseNewTicketModal,initialContact:ticket.contact}),/*#__PURE__*/_jsxs(ListItem,{button:true,dense:true,onClick:e=>{console.log(\"e\",e);const isCheckboxClicked=e.target.tagName.toLowerCase()===\"input\"&&e.target.type===\"checkbox\"||e.target.tagName.toLowerCase()===\"svg\"&&e.target.type===undefined||e.target.tagName.toLowerCase()===\"path\"&&e.target.type===undefined;if(isCheckboxClicked)return;handleSelectTicket(ticket);},selected:ticketId&&ticketId===ticket.uuid,className:clsx(classes.ticket,{[classes.pendingTicket]:ticket.status===\"pending\"}),children:[/*#__PURE__*/_jsx(ListItemAvatar,{style:{marginLeft:\"-15px\"},children:/*#__PURE__*/_jsx(Avatar,{style:{width:\"50px\",height:\"50px\",borderRadius:\"50%\"},src:\"\".concat(ticket===null||ticket===void 0?void 0:(_ticket$contact2=ticket.contact)===null||_ticket$contact2===void 0?void 0:_ticket$contact2.urlPicture),className:classes.clickableAvatar,onClick:handleImageClick})}),/*#__PURE__*/_jsx(ListItemText,{disableTypography:true,primary:/*#__PURE__*/_jsx(\"span\",{className:classes.contactNameWrapper,children:/*#__PURE__*/_jsxs(Typography,{noWrap:true,component:\"span\",variant:\"body2\",children:[ticket.isGroup&&ticket.channel===\"whatsapp\"&&/*#__PURE__*/_jsx(GroupIcon,{fontSize:\"small\",style:{color:grey[700],marginBottom:\"-1px\",marginLeft:\"5px\"}}),\" \",\"\\xA0\",ticket.channel&&/*#__PURE__*/_jsx(ConnectionIcon,{width:\"20\",height:\"20\",className:classes.connectionIcon,connectionType:ticket.channel}),\" \",\"\\xA0\",truncate((_ticket$contact3=ticket.contact)===null||_ticket$contact3===void 0?void 0:_ticket$contact3.name,60)]})}),secondary:/*#__PURE__*/_jsxs(\"span\",{className:classes.contactNameWrapper,children:[/*#__PURE__*/_jsxs(Typography,{className:Number(ticket.unreadMessages)>0?classes.contactLastMessageUnread:classes.contactLastMessage,noWrap:true,component:\"span\",variant:\"body2\",children:[renderLastMessage(),/*#__PURE__*/_jsxs(\"span\",{className:classes.secondaryContentSecond,children:[ticket!==null&&ticket!==void 0&&ticket.whatsapp?/*#__PURE__*/_jsx(Badge,{className:classes.connectionTag,style:{backgroundColor:ticket.channel===\"whatsapp\"?((_ticket$whatsapp2=ticket.whatsapp)===null||_ticket$whatsapp2===void 0?void 0:_ticket$whatsapp2.color)||\"#25D366\":ticket.channel===\"facebook\"?\"#4267B2\":\"#E1306C\"},children:(_ticket$whatsapp3=ticket.whatsapp)===null||_ticket$whatsapp3===void 0?void 0:_ticket$whatsapp3.name.toUpperCase()}):/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(Badge,{style:{backgroundColor:((_ticket$queue=ticket.queue)===null||_ticket$queue===void 0?void 0:_ticket$queue.color)||\"#7c7c7c\"},className:classes.connectionTag,children:ticket.queueId?(_ticket$queue2=ticket.queue)===null||_ticket$queue2===void 0?void 0:_ticket$queue2.name.toUpperCase():ticket.status===\"lgpd\"?\"LGPD\":\"\".concat(i18n.t(\"momentsUser.noqueue\"))}),(ticket===null||ticket===void 0?void 0:ticket.user)&&/*#__PURE__*/_jsx(Badge,{style:{backgroundColor:\"#000000\"},className:classes.connectionTag,children:(_ticket$user=ticket.user)===null||_ticket$user===void 0?void 0:_ticket$user.name.toUpperCase()})]}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:ticket===null||ticket===void 0?void 0:(_ticket$contact4=ticket.contact)===null||_ticket$contact4===void 0?void 0:(_ticket$contact4$tags=_ticket$contact4.tags)===null||_ticket$contact4$tags===void 0?void 0:_ticket$contact4$tags.map(tag=>{return/*#__PURE__*/_jsx(ContactTag,{tag:tag},\"ticket-contact-tag-\".concat(ticket.id,\"-\").concat(tag.id));})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:(_ticket$tags=ticket.tags)===null||_ticket$tags===void 0?void 0:_ticket$tags.map(tag=>{return/*#__PURE__*/_jsx(ContactTag,{tag:tag},\"ticket-contact-tag-\".concat(ticket.id,\"-\").concat(tag.id));})})]}),/*#__PURE__*/_jsx(Badge,{className:classes.newMessagesCount,badgeContent:shouldBlurMessages?\"?\":ticket.unreadMessages,classes:{badge:classes.badgeStyle}})]})}),/*#__PURE__*/_jsx(ListItemSecondaryAction,{children:ticket.lastMessage&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{className:Number(ticket.unreadMessages)>0?classes.lastMessageTimeUnread:classes.lastMessageTime,component:\"span\",variant:\"body2\",children:isSameDay(parseISO(ticket.updatedAt),new Date())?/*#__PURE__*/_jsx(_Fragment,{children:format(parseISO(ticket.updatedAt),\"HH:mm\")}):/*#__PURE__*/_jsx(_Fragment,{children:format(parseISO(ticket.updatedAt),\"dd/MM/yyyy\")})}),/*#__PURE__*/_jsx(\"br\",{})]})}),/*#__PURE__*/_jsxs(ListItemSecondaryAction,{children:[ticket.status===\"chatbot\"&&/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"blue\":\"#FFF\",padding:\"0px\",borderRadius:\"50%\",right:\"1px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>{e.stopPropagation();handleSpyTicket();},children:/*#__PURE__*/_jsx(Tooltip,{title:\"Espiar conversa do chatbot\",children:/*#__PURE__*/_jsx(VisibilityIcon,{})})})}),ticket.status!==\"chatbot\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:ticket.status===\"pending\"&&(ticket.queueId===null||ticket.queueId===undefined)&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"green\":\"#FFF\",padding:\"0px\",borderRadius:\"50%\",right:\"51px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>handleOpenAcceptTicketWithouSelectQueue(),children:/*#__PURE__*/_jsx(Tooltip,{title:\"\".concat(i18n.t(\"ticketsList.buttons.accept\")),children:/*#__PURE__*/_jsx(Done,{})})})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:ticket.status===\"pending\"&&ticket.queueId!==null&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"green\":\"#FFF\",padding:\"0px\",borderRadius:\"50%\",right:\"51px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>handleAcepptTicket(ticket.id),children:/*#__PURE__*/_jsx(Tooltip,{title:\"\".concat(i18n.t(\"ticketsList.buttons.accept\")),children:/*#__PURE__*/_jsx(Done,{})})})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond1,children:(ticket.status===\"pending\"||ticket.status===\"open\"||ticket.status===\"group\")&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"purple\":\"#FFF\",padding:\"0px\",borderRadius:\"50%\",right:\"26px\",position:\"absolute\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:handleOpenTransferModal,children:/*#__PURE__*/_jsx(Tooltip,{title:\"\".concat(i18n.t(\"ticketsList.buttons.transfer\")),children:/*#__PURE__*/_jsx(SwapHoriz,{})})})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:(ticket.status===\"open\"||ticket.status===\"group\")&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"red\":\"#FFF\",padding:\"0px\",bottom:\"0px\",borderRadius:\"50%\",right:\"1px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>handleCloseTicket(ticket.id),children:/*#__PURE__*/_jsx(Tooltip,{title:\"\".concat(i18n.t(\"ticketsList.buttons.closed\")),children:/*#__PURE__*/_jsx(HighlightOff,{})})})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:(ticket.status===\"pending\"||ticket.status===\"lgpd\")&&(user.userClosePendingTicket===\"enabled\"||user.profile===\"admin\")&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"red\":\"#FFF\",padding:\"0px\",bottom:\"0px\",borderRadius:\"50%\",right:\"1px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>handleCloseIgnoreTicket(ticket.id),children:/*#__PURE__*/_jsx(Tooltip,{title:\"\".concat(i18n.t(\"ticketsList.buttons.ignore\")),children:/*#__PURE__*/_jsx(HighlightOff,{})})})}),/*#__PURE__*/_jsx(\"span\",{className:classes.secondaryContentSecond,children:ticket.status===\"closed\"&&/*#__PURE__*/_jsx(ButtonWithSpinner,{style:{backgroundColor:\"transparent\",boxShadow:\"none\",border:\"none\",color:theme.mode===\"light\"?\"green\":\"#FFF\",padding:\"0px\",bottom:\"0px\",borderRadius:\"50%\",right:\"1px\",fontSize:\"0.6rem\",bottom:\"-30px\",minWidth:\"2em\",width:\"auto\"},variant:\"contained\",className:classes.acceptButton,size:\"small\",loading:loading,onClick:e=>{e.stopPropagation();handleOpenNewTicketModal();},children:/*#__PURE__*/_jsx(Tooltip,{title:\"Criar Novo Ticket\",children:/*#__PURE__*/_jsx(Add,{})})})})]})]})]}),openFinalizacaoVenda&&/*#__PURE__*/_jsx(FinalizacaoVendaModal,{open:openFinalizacaoVenda,onClose:()=>setOpenFinalizacaoVenda(false),ticket:ticket,onFinalizar:ticketData=>{setOpenFinalizacaoVenda(false);setTicketDataToFinalize(ticketData);setShowFinalizacaoOptions(true);}}),showFinalizacaoOptions&&/*#__PURE__*/_jsxs(Dialog,{open:showFinalizacaoOptions,onClose:()=>setShowFinalizacaoOptions(false),\"aria-labelledby\":\"finalizacao-options-title\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"finalizacao-options-title\",children:\"Como deseja finalizar?\"}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:async()=>{setShowFinalizacaoOptions(false);await handleUpdateTicketStatusWithData(ticketDataToFinalize,false,null);},style:{background:theme.palette.primary.main,color:\"white\"},children:i18n.t(\"messagesList.header.dialogRatingWithoutFarewellMsg\")}),/*#__PURE__*/_jsx(Button,{onClick:async()=>{setShowFinalizacaoOptions(false);await handleUpdateTicketStatusWithData(ticketDataToFinalize,true,null);},style:{background:theme.palette.primary.main,color:\"white\"},children:i18n.t(\"messagesList.header.dialogRatingCancel\")})]})]}),/*#__PURE__*/_jsx(Dialog,{open:imageModalOpen,onClose:handleImageModalClose,className:classes.imageModal,maxWidth:\"md\",fullWidth:true,children:/*#__PURE__*/_jsx(DialogContent,{className:classes.imageModalContent,children:/*#__PURE__*/_jsx(\"img\",{src:ticket===null||ticket===void 0?void 0:(_ticket$contact5=ticket.contact)===null||_ticket$contact5===void 0?void 0:_ticket$contact5.urlPicture,alt:(ticket===null||ticket===void 0?void 0:(_ticket$contact6=ticket.contact)===null||_ticket$contact6===void 0?void 0:_ticket$contact6.name)||\"Foto do contato\",className:classes.expandedImage})})})]},ticket.id);};export default TicketListItemCustom;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}