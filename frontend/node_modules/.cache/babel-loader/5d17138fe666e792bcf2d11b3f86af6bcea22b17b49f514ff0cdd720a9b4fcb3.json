{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useContext,useRef,useCallback}from\"react\";import\"emoji-mart/css/emoji-mart.css\";import{Picker}from\"emoji-mart\";import{useMediaQuery,useTheme}from\"@material-ui/core\";import{isNil}from\"lodash\";import{Fade}from\"@material-ui/core\";import{CircularProgress,ClickAwayListener,IconButton,InputBase,makeStyles,Paper,Hidden,Menu,MenuItem,Tooltip,Fab,Chip,Box}from\"@material-ui/core\";import{blue,green,pink,grey}from\"@material-ui/core/colors\";import{AttachFile,CheckCircleOutline,Clear,Comment,Create,Description,HighlightOff,Mic,Mood,MoreVert,Send,PermMedia,Person,Reply,Duo,Timer,WhatsApp,Info,AccountTree}from\"@material-ui/icons\";import{FormatBold as FormatBoldIcon,FormatItalic as FormatItalicIcon,FormatStrikethrough as FormatStrikethroughIcon,Code as CodeIcon,FormatListNumbered as FormatListNumberedIcon,FormatListBulleted as FormatListBulletedIcon,FormatQuote as FormatQuoteIcon,FormatClear as FormatClearIcon}from\"@material-ui/icons\";import AddIcon from\"@material-ui/icons/Add\";import{CameraAlt}from\"@material-ui/icons\";import MicRecorder from\"mic-recorder-to-mp3\";import clsx from\"clsx\";import{ReplyMessageContext}from\"../../context/ReplyingMessage/ReplyingMessageContext\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{i18n}from\"../../translate/i18n\";import toastError from\"../../errors/toastError\";import api,{openApi}from\"../../services/api\";import RecordingTimer from\"./RecordingTimer\";import useQuickMessages from\"../../hooks/useQuickMessages\";import{isString,isEmpty}from\"lodash\";import ContactSendModal from\"../ContactSendModal\";import CameraModal from\"../CameraModal\";import axios from\"axios\";import useCompanySettings from\"../../hooks/useSettings/companySettings\";import{ForwardMessageContext}from\"../../context/ForwarMessage/ForwardMessageContext\";import MessageUploadMedias from\"../MessageUploadMedias\";import{EditMessageContext}from\"../../context/EditingMessage/EditingMessageContext\";import ScheduleModal from\"../ScheduleModal\";import usePlans from\"../../hooks/usePlans\";import TemplateModal from\"../TemplateMetaModal\";import TriggerFlowModal from\"../TriggerFlowModal\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Mp3Recorder=new MicRecorder({bitRate:128,sampleRate:44100});const isMobileDevice=()=>{return /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);};const useStyles=makeStyles(theme=>({mainWrapper:{background:\"#eee\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",borderTop:\"1px solid rgba(0, 0, 0, 0.12)\",[theme.breakpoints.down(\"sm\")]:{position:\"fixed\",bottom:0,width:\"100%\"}},avatar:{width:\"50px\",height:\"50px\",borderRadius:\"25%\"},dropInfo:{background:\"#eee\",display:\"flex\",flexDirection:\"column\",alignItems:\"center\",width:\"100%\",padding:15,left:0,right:0},dropInfoOut:{display:\"none\"},gridFiles:{maxHeight:\"100%\",overflow:\"scroll\"},newMessageBox:{background:theme.palette.background.default,width:\"100%\",display:\"flex\",padding:\"7px\",alignItems:\"center\"},messageInputWrapper:{padding:6,marginRight:7,background:theme.palette.background.paper,display:\"flex\",borderRadius:20,flex:1,position:\"relative\",// âœ… Essencial para o position absolute funcionar\nzIndex:10// âœ… Z-index base\n},messageInputWrapperPrivate:{padding:6,marginRight:7,background:\"#F0E68C\",display:\"flex\",borderRadius:20,flex:1,position:\"relative\",// âœ… Essencial para o position absolute funcionar\nzIndex:10// âœ… Z-index base\n},messageInputWrapperPending:{padding:6,marginRight:7,background:\"#FFE0B2\",display:\"flex\",borderRadius:20,flex:1,position:\"relative\",// âœ… Essencial para o position absolute funcionar\nborder:\"2px solid #FF9800\",zIndex:10// âœ… Z-index base\n},messageInput:{paddingLeft:10,flex:1,border:\"none\"},messageInputPrivate:{paddingLeft:10,flex:1,border:\"none\",color:grey[800]},messageInputPending:{paddingLeft:10,flex:1,border:\"none\",color:\"#E65100\",fontWeight:500},sendMessageIcons:{color:grey[700]},ForwardMessageIcons:{color:grey[700],transform:\"scaleX(-1)\"},uploadInput:{display:\"none\"},viewMediaInputWrapper:{maxHeight:\"100%\",display:\"flex\",padding:\"10px 13px\",position:\"relative\",justifyContent:\"space-between\",alignItems:\"center\",backgroundColor:theme.mode===\"light\"?\"#ffffff\":\"#202c33\",borderTop:\"1px solid rgba(0, 0, 0, 0.12)\"},emojiBox:{position:\"absolute\",bottom:63,width:40,borderTop:\"1px solid #e8e8e8\"},circleLoading:{color:green[500],opacity:\"70%\",position:\"absolute\",top:\"20%\",left:\"50%\",marginLeft:-12},audioLoading:{color:green[500],opacity:\"70%\"},recorderWrapper:{display:\"flex\",alignItems:\"center\",alignContent:\"middle\"},cancelAudioIcon:{color:\"red\"},sendAudioIcon:{color:\"green\"},replyginMsgWrapper:{display:\"flex\",width:\"100%\",alignItems:\"center\",justifyContent:\"center\",paddingTop:8,paddingLeft:73,paddingRight:7,backgroundColor:theme.palette.optionsBackground},replyginMsgContainer:{flex:1,marginRight:5,overflowY:\"hidden\",backgroundColor:theme.mode===\"light\"?\"#f0f0f0\":\"#1d282f\",borderRadius:\"7.5px\",display:\"flex\",position:\"relative\"},replyginMsgBody:{padding:10,height:\"auto\",display:\"block\",whiteSpace:\"pre-wrap\",overflow:\"hidden\"},replyginContactMsgSideColor:{flex:\"none\",width:\"4px\",backgroundColor:\"#35cd96\"},replyginSelfMsgSideColor:{flex:\"none\",width:\"4px\",backgroundColor:\"#6bcbef\"},floatingFormatMenu:{position:'fixed',backgroundColor:theme.palette.background.paper,borderRadius:theme.shape.borderRadius,boxShadow:theme.shadows[8],zIndex:9999,display:'flex',flexDirection:'row',alignItems:'center',padding:'4px',border:\"1px solid \".concat(theme.palette.divider)},formatIconButton:{padding:'6px',borderRadius:'4px',minWidth:'32px',height:'32px'},messageContactName:{display:\"flex\",color:\"#6bcbef\",fontWeight:500},messageQuickAnswersWrapper:{margin:0,position:\"absolute\",bottom:\"100%\",// âœ… Posicionar acima do input\nbackground:theme.palette.background.default,padding:0,border:\"none\",left:0,right:0,// âœ… Usar right: 0 em vez de width: 100%\nmaxHeight:\"200px\",overflowY:\"auto\",overflowX:\"hidden\",boxShadow:\"0 -4px 16px rgba(0, 0, 0, 0.15)\",borderRadius:\"8px 8px 0 0\",zIndex:1000,// âœ… Z-index menor para evitar conflitos\n\"&::-webkit-scrollbar\":{width:\"6px\"},\"&::-webkit-scrollbar-track\":{background:\"transparent\"},\"&::-webkit-scrollbar-thumb\":{backgroundColor:theme.palette.action.disabled,borderRadius:\"3px\",\"&:hover\":{backgroundColor:theme.palette.action.hover}},\"& li\":{listStyle:\"none\",\"& a\":{display:\"block\",padding:\"8px\",textOverflow:\"ellipsis\",overflow:\"hidden\",maxHeight:\"auto\",\"&:hover\":{background:theme.palette.background.paper,cursor:\"pointer\"}}}},quickAnswerItem:{display:\"flex\",alignItems:\"center\",gap:theme.spacing(1),padding:theme.spacing(1.5),minHeight:\"48px\",cursor:\"pointer\",// âœ… Adicionar cursor pointer\nborderRadius:\"4px\",// âœ… Bordas arredondadas\nmargin:\"2px 4px\",// âœ… Pequena margem\n\"&:hover\":{backgroundColor:theme.palette.action.hover},transition:\"all 0.2s ease-in-out\"},// âœ… NOVO: Estilo para item selecionado via teclado\nquickAnswerItemSelected:{backgroundColor:theme.palette.primary.light+\"30\",// âœ… Cor semi-transparente\nborderLeft:\"4px solid \".concat(theme.palette.primary.main),fontWeight:500},// âœ… NOVO: Indicador de scroll\nquickAnswersScrollIndicator:{textAlign:\"center\",padding:theme.spacing(1),fontSize:\"0.75rem\",color:theme.palette.text.secondary,fontStyle:\"italic\",borderTop:\"1px solid \".concat(theme.palette.divider),backgroundColor:theme.palette.background.paper},quickAnswerText:{flex:1,textOverflow:\"ellipsis\",overflow:\"hidden\"},mediaTypeChip:{height:20,fontSize:\"0.7rem\"},invertedFabMenu:{border:\"none\",borderRadius:50,boxShadow:\"none\",padding:theme.spacing(1),backgroundColor:\"transparent\",color:\"grey\",\"&:hover\":{backgroundColor:\"transparent\"},\"&:disabled\":{backgroundColor:\"transparent !important\"}},invertedFabMenuMP:{border:\"none\",borderRadius:0,boxShadow:\"none\",width:theme.spacing(4),height:theme.spacing(4),backgroundColor:\"transparent\",color:blue[800],\"&:hover\":{backgroundColor:\"transparent\"}},invertedFabMenuCont:{border:\"none\",borderRadius:0,boxShadow:\"none\",minHeight:\"auto\",width:theme.spacing(4),height:theme.spacing(4),backgroundColor:\"transparent\",color:blue[500],\"&:hover\":{backgroundColor:\"transparent\"}},invertedFabMenuMeet:{border:\"none\",borderRadius:0,boxShadow:\"none\",minHeight:\"auto\",width:theme.spacing(4),height:theme.spacing(4),backgroundColor:\"transparent\",color:green[500],\"&:hover\":{backgroundColor:\"transparent\"}},invertedFabMenuDoc:{border:\"none\",borderRadius:0,boxShadow:\"none\",width:theme.spacing(4),height:theme.spacing(4),backgroundColor:\"transparent\",color:\"#7f66ff\",\"&:hover\":{backgroundColor:\"transparent\"}},invertedFabMenuCamera:{border:\"none\",borderRadius:0,boxShadow:\"none\",width:theme.spacing(4),height:theme.spacing(4),backgroundColor:\"transparent\",color:pink[500],\"&:hover\":{backgroundColor:\"transparent\"}},flexContainer:{display:\"flex\",flex:1,flexDirection:\"column\"},flexItem:{flex:1},pendingAlert:{marginBottom:theme.spacing(1),padding:theme.spacing(1,2),backgroundColor:\"#E3F2FD\",border:\"1px solid #2196F3\",borderRadius:4,display:\"flex\",alignItems:\"center\",gap:theme.spacing(1),color:\"#1976D2\",fontSize:\"0.875rem\"}}));const MessageInput=_ref=>{let{ticketId,ticketStatus,droppedFiles,contactId,ticketChannel,whatsappId}=_ref;const classes=useStyles();const theme=useTheme();const[mediasUpload,setMediasUpload]=useState([]);const isMounted=useRef(true);const[inputMessage,setInputMessage]=useState(\"\");const[showEmoji,setShowEmoji]=useState(false);const[templateModalOpen,setTemplateModalOpen]=useState(false);const[templates,setTemplates]=useState([]);const[loading,setLoading]=useState(false);const[recording,setRecording]=useState(false);const[quickAnswers,setQuickAnswer]=useState([]);const[typeBar,setTypeBar]=useState(false);const inputRef=useRef();const[onDragEnter,setOnDragEnter]=useState(false);const[anchorEl,setAnchorEl]=useState(null);const{setReplyingMessage,replyingMessage}=useContext(ReplyMessageContext);const{setEditingMessage,editingMessage}=useContext(EditMessageContext);const{user}=useContext(AuthContext);const[appointmentModalOpen,setAppointmentModalOpen]=useState(false);const{getPlanCompany}=usePlans();const[signMessagePar,setSignMessagePar]=useState(false);const{get:getSetting}=useCompanySettings();const[signMessage,setSignMessage]=useState(true);const[privateMessage,setPrivateMessage]=useState(false);const[privateMessageInputVisible,setPrivateMessageInputVisible]=useState(false);const[senVcardModalOpen,setSenVcardModalOpen]=useState(false);const[showModalMedias,setShowModalMedias]=useState(false);const[showSchedules,setShowSchedules]=useState(false);const[useWhatsappOfficial,setUseWhatsappOfficial]=useState(false);const{list:listQuickMessages}=useQuickMessages();const isMobile=useMediaQuery(\"(max-width: 767px)\");const[placeholderText,setPlaceHolderText]=useState(\"\");const[selectedQuickAnswerIndex,setSelectedQuickAnswerIndex]=useState(-1);const[isNavigatingQuickAnswers,setIsNavigatingQuickAnswers]=useState(false);const[triggerFlowModalOpen,setTriggerFlowModalOpen]=useState(false);const[flowProcessing,setFlowProcessing]=useState(false);const flowProcessingRef=useRef(false);const[formatMenuAnchorPosition,setFormatMenuAnchorPosition]=useState(null);const[selectedText,setSelectedText]=useState({text:'',start:0,end:0});const isTicketPending=()=>{return ticketStatus===\"pending\";};useEffect(()=>{if(isTicketPending()){setPrivateMessage(true);setPrivateMessageInputVisible(true);}},[ticketStatus]);useEffect(()=>{async function fetchTemplates(){const templates=await api.request({url:\"/quick-messages/list\",method:\"GET\",params:{isOficial:\"true\",userId:user.id,companyId:user.companyId,status:\"APPROVED\"// whatsappId,\n}});setTemplates(templates.data);}if(useWhatsappOfficial){fetchTemplates();}},[useWhatsappOfficial]);useEffect(()=>{async function fetchData(){const companyId=user.companyId;const planConfigs=await getPlanCompany(undefined,companyId);setShowSchedules(planConfigs.plan.useSchedules);setUseWhatsappOfficial(planConfigs.plan.useWhatsappOfficial);}fetchData();},[]);useEffect(()=>{if(ticketStatus===\"open\"||ticketStatus===\"group\"){setPlaceHolderText(i18n.t(\"messagesInput.placeholderOpen\"));}else if(ticketStatus===\"pending\"){setPlaceHolderText(\"Digite sua mensagem interna (ticket aguardando)...\");}else{setPlaceHolderText(i18n.t(\"messagesInput.placeholderClosed\"));}const maxLength=isMobile?20:Infinity;if(isMobile&&placeholderText.length>maxLength){setPlaceHolderText(placeholderText.substring(0,maxLength)+\"...\");}},[ticketStatus]);const{selectedMessages,setForwardMessageModalOpen,showSelectMessageCheckbox}=useContext(ForwardMessageContext);useEffect(()=>{if(droppedFiles&&droppedFiles.length>0){const selectedMedias=Array.from(droppedFiles);setMediasUpload(selectedMedias);setShowModalMedias(true);}},[droppedFiles]);useEffect(()=>{return()=>{isMounted.current=false;};},[]);useEffect(()=>{inputRef.current.focus();if(editingMessage){setInputMessage(editingMessage.body);}},[replyingMessage,editingMessage]);useEffect(()=>{inputRef.current.focus();return()=>{setInputMessage(\"\");setShowEmoji(false);setMediasUpload([]);setReplyingMessage(null);if(!isTicketPending()){setPrivateMessage(false);setPrivateMessageInputVisible(false);}setEditingMessage(null);};},[ticketId,setReplyingMessage,setEditingMessage]);useEffect(()=>{let isProcessing=false;// âœ… Flag para evitar processamento duplo\nconst handleInsertQuickMessage=event=>{// âœ… IMPORTANTE: Evitar processamento duplo\nif(isProcessing){console.log(\"âš ï¸ JÃ¡ processando evento, ignorando...\");return;}isProcessing=true;console.log(\"ðŸ“¥ Evento insertQuickMessage recebido:\",event.detail);const{quickMessage}=event.detail;if(!quickMessage){console.error(\"âŒ quickMessage nÃ£o encontrado no evento\");isProcessing=false;return;}console.log(\"ðŸ” Processando quickMessage:\",{hasMedia:!!quickMessage.mediaPath,mediaType:quickMessage.mediaType,message:quickMessage.message,ticketId:ticketId});if(quickMessage.mediaPath){console.log(\"ðŸŽµ Processando resposta rÃ¡pida com mÃ­dia\");handleQuickAnswersClick({value:quickMessage.message||\"\",mediaPath:quickMessage.mediaPath,mediaType:quickMessage.mediaType,shortcode:quickMessage.shortcode,label:\"/\".concat(quickMessage.shortcode,\" - \").concat(quickMessage.message)}).finally(()=>{isProcessing=false;// âœ… Liberar flag apÃ³s processamento\n});}else{console.log(\"ðŸ“ Processando resposta rÃ¡pida de texto\");const currentText=(inputMessage===null||inputMessage===void 0?void 0:inputMessage.trim())||\"\";const newText=currentText?\"\".concat(currentText,\"\\n\\n\").concat(quickMessage.message):quickMessage.message;setInputMessage(newText);setTimeout(()=>{if(inputRef.current){inputRef.current.focus();const length=newText.length;inputRef.current.setSelectionRange(length,length);}isProcessing=false;// âœ… Liberar flag\n},100);}};// âœ… IMPORTANTE: Escutar apenas no window\nwindow.addEventListener('insertQuickMessage',handleInsertQuickMessage);return()=>{window.removeEventListener('insertQuickMessage',handleInsertQuickMessage);isProcessing=false;// âœ… Reset da flag no cleanup\n};},[inputMessage,ticketId,privateMessage]);useEffect(()=>{setTimeout(()=>{if(isMounted.current)setOnDragEnter(false);},1000);},[onDragEnter===true]);useEffect(()=>{const fetchSettings=async()=>{const setting=await getSetting({column:\"sendSignMessage\"});if(isMounted.current){if(setting.sendSignMessage===\"enabled\"){setSignMessagePar(true);const signMessageStorage=JSON.parse(localStorage.getItem(\"persistentSignMessage\"));if(isNil(signMessageStorage)){setSignMessage(true);}else{setSignMessage(signMessageStorage);}}else if(setting.sendSignMessage===\"dontSend\"){localStorage.setItem(\"persistentSignMessage\",false);setSignMessage(false);setSignMessagePar(false);}else{setSignMessagePar(false);}}};fetchSettings();},[]);// CORREÃ‡ÃƒO DO ERRO charAt - FunÃ§Ã£o mais robusta\nconst safeCapitalizeFirstLetter=string=>{if(!string||typeof string!=='string')return\"\";return string.charAt(0).toUpperCase()+string.slice(1);};// FUNÃ‡Ã•ES PARA TRIGGER FLOW MODAL\nconst handleTriggerFlowClick=useCallback(()=>{console.log(\"ðŸŽ¯ Abrindo modal de fluxo\");// ðŸ›¡ï¸ RESET PREVENTIVO\nsetFlowProcessing(false);flowProcessingRef.current=false;setTriggerFlowModalOpen(true);},[]);const handleTriggerFlowClose=useCallback(()=>{console.log(\"ðŸšª Fechando modal\");setFlowProcessing(false);flowProcessingRef.current=false;setTriggerFlowModalOpen(false);},[]);const handleFlowProcessing=useCallback(isProcessing=>{console.log(\"ðŸ”„ Flow processing:\",isProcessing);setFlowProcessing(isProcessing);flowProcessingRef.current=isProcessing;// ðŸ”¥ TIMEOUT SIMPLES: 8 segundos e libera SEM PERGUNTAR\nif(isProcessing){setTimeout(()=>{console.log(\"â° TIMEOUT - Liberando campo FORÃ‡ADO\");setFlowProcessing(false);flowProcessingRef.current=false;},8000);}},[]);const handleFlowTriggered=useCallback(data=>{console.log(\"âœ… Fluxo concluÃ­do\");// ðŸ”¥ RESET IMEDIATO - SEM TIMEOUT\nsetFlowProcessing(false);flowProcessingRef.current=false;},[]);// NAVEGAÃ‡ÃƒO POR TECLADO CORRIGIDA\nconst handleKeyDown=useCallback(e=>{if(!typeBar||!Array.isArray(typeBar)||typeBar.length===0){setSelectedQuickAnswerIndex(-1);setIsNavigatingQuickAnswers(false);return;}switch(e.key){case'ArrowDown':e.preventDefault();setIsNavigatingQuickAnswers(true);setSelectedQuickAnswerIndex(prev=>{const nextIndex=prev<typeBar.length-1?prev+1:0;// SCROLL AUTOMÃTICO CORRIGIDO\nsetTimeout(()=>{const container=document.querySelector('.MuiBox-root ul');if(container){const selectedElement=container.children[nextIndex];if(selectedElement){selectedElement.scrollIntoView({behavior:'smooth',block:'nearest'});}}},0);return nextIndex;});break;case'ArrowUp':e.preventDefault();setIsNavigatingQuickAnswers(true);setSelectedQuickAnswerIndex(prev=>{const nextIndex=prev>0?prev-1:typeBar.length-1;// SCROLL AUTOMÃTICO CORRIGIDO\nsetTimeout(()=>{const container=document.querySelector('.MuiBox-root ul');if(container){const selectedElement=container.children[nextIndex];if(selectedElement){selectedElement.scrollIntoView({behavior:'smooth',block:'nearest'});}}},0);return nextIndex;});break;case'Enter':if(isNavigatingQuickAnswers&&selectedQuickAnswerIndex>=0){e.preventDefault();const selectedAnswer=typeBar[selectedQuickAnswerIndex];handleQuickAnswersClick(selectedAnswer);setSelectedQuickAnswerIndex(-1);setIsNavigatingQuickAnswers(false);}break;case'Escape':if(isNavigatingQuickAnswers){e.preventDefault();setSelectedQuickAnswerIndex(-1);setIsNavigatingQuickAnswers(false);setTypeBar(false);}break;case'Tab':if(isNavigatingQuickAnswers){e.preventDefault();setSelectedQuickAnswerIndex(prev=>{const nextIndex=prev<typeBar.length-1?prev+1:0;return nextIndex;});}break;default:if(isNavigatingQuickAnswers&&e.key.length===1){setSelectedQuickAnswerIndex(-1);setIsNavigatingQuickAnswers(false);}break;}},[typeBar,selectedQuickAnswerIndex,isNavigatingQuickAnswers]);useEffect(()=>{if(!typeBar||!Array.isArray(typeBar)||typeBar.length===0){setSelectedQuickAnswerIndex(-1);setIsNavigatingQuickAnswers(false);}},[typeBar]);const getQuickAnswerItemStyle=index=>({backgroundColor:selectedQuickAnswerIndex===index?theme.mode==='light'?'#e3f2fd':'#1e3a5f':'transparent',borderLeft:selectedQuickAnswerIndex===index?\"4px solid \".concat(theme.palette.primary.main):'4px solid transparent'});const handleSendLinkVideo=async()=>{const link=\"https://meet.jit.si/\".concat(ticketId);setInputMessage(link);};const handleSendTemplate=async()=>{setTemplateModalOpen(true);};const handleChangeInput=useCallback(e=>{setInputMessage(e.target.value);},[]);const handlePrivateMessage=e=>{if(isTicketPending()){return;}setPrivateMessage(!privateMessage);setPrivateMessageInputVisible(!privateMessageInputVisible);};const getMediaTypeIcon=mediaType=>{switch(mediaType){case'audio':return'ðŸŽµ';case'image':return'ðŸ–¼ï¸';case'video':return'ðŸŽ¥';case'document':return'ðŸ“Ž';default:return'ðŸ“Ž';}};const getMediaTypeColor=mediaType=>{switch(mediaType){case'audio':return'secondary';case'image':return'primary';case'video':return'default';case'document':return'default';default:return'default';}};const handleQuickAnswersClick=useCallback(async value=>{// âœ… IMPORTANTE: Evitar mÃºltiplas execuÃ§Ãµes simultÃ¢neas\nif(loading){console.log(\"âš ï¸ JÃ¡ processando, ignorando clique...\");return;}console.log(\"ðŸŽ¯ handleQuickAnswersClick chamado:\",value);console.log(\"ðŸ“‹ ticketId atual:\",ticketId);if(!ticketId){console.error(\"âŒ ticketId nÃ£o encontrado\");toastError(\"Erro: ID do ticket nÃ£o encontrado\");return;}if(value.mediaPath){try{setLoading(true);console.log(\"ðŸ“¥ Baixando mÃ­dia:\",value.mediaPath);const response=await api.get(value.mediaPath,{responseType:\"blob\"});console.log(\"âœ… MÃ­dia baixada com sucesso, tamanho:\",response.data.size);const messageBody=value.value&&value.value.trim()!==\"\"?value.value:\"\";await handleUploadQuickMessageMedia(response.data,messageBody,value.mediaType);console.log(\"âœ… MÃ­dia enviada com sucesso\");setInputMessage(\"\");setTypeBar(false);return;}catch(err){console.error(\"âŒ Erro ao processar mÃ­dia:\",err);toastError(err);}finally{setLoading(false);}}else{// Para mensagens de texto\nsetInputMessage(value.value||\"\");setTypeBar(false);}},[loading,ticketId,privateMessage]);const handleUploadQuickMessageMedia=useCallback(async function(blob,message){let mediaType=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;console.log(\"ðŸ“¤ Iniciando upload de mÃ­dia:\",{blobSize:blob.size,message,mediaType,ticketId});if(!ticketId){throw new Error(\"ID do ticket nÃ£o encontrado\");}// âœ… IMPORTANTE: Verificar se jÃ¡ estÃ¡ enviando\nif(loading){console.log(\"âš ï¸ Upload jÃ¡ em andamento, ignorando...\");return;}try{let extension='bin';if(blob.type){const mimeType=blob.type.split(\"/\")[1];extension=mimeType;if(blob.type.includes('webm')||blob.type.includes('audio')){extension=blob.type.includes('webm')?'webm':'mp3';}}else if(mediaType){const typeExtensionMap={'audio':'webm','image':'jpg','video':'mp4','document':'pdf'};extension=typeExtensionMap[mediaType]||'bin';}const formData=new FormData();const filename=\"\".concat(new Date().getTime(),\".\").concat(extension);formData.append(\"medias\",blob,filename);formData.append(\"typeArch\",\"quickMessage\");const body=message&&message.trim()!==\"\"?privateMessage||isTicketPending()?\"\\u200D\".concat(message):message:privateMessage||isTicketPending()?\"\\u200D\":\"\";formData.append(\"body\",body);formData.append(\"fromMe\",true);formData.append(\"isPrivate\",privateMessage||isTicketPending()?\"true\":\"false\");console.log(\"ðŸ“¤ Enviando para:\",\"/messages/\".concat(ticketId));if(isMounted.current){const response=await api.post(\"/messages/\".concat(ticketId),formData);console.log(\"âœ… Upload realizado com sucesso:\",response.status);}}catch(err){console.error(\"âŒ Erro no upload:\",err);toastError(err);throw err;}},[ticketId,privateMessage,loading]);const handleAddEmoji=e=>{let emoji=e.native;setInputMessage(prevState=>prevState+emoji);};const[modalCameraOpen,setModalCameraOpen]=useState(false);const handleCapture=imageData=>{if(imageData){handleUploadCamera(imageData);}};const handleChangeMedias=e=>{if(!e.target.files){return;}const selectedMedias=Array.from(e.target.files);setMediasUpload(selectedMedias);setShowModalMedias(true);};const handleChangeSign=e=>{getStatusSingMessageLocalstogare();};const handleOpenModalForward=()=>{if(selectedMessages.length===0){setForwardMessageModalOpen(false);toastError(i18n.t(\"messagesList.header.notMessage\"));return;}setForwardMessageModalOpen(true);};const getStatusSingMessageLocalstogare=()=>{const signMessageStorage=JSON.parse(localStorage.getItem(\"persistentSignMessage\"));if(signMessageStorage!==null){if(signMessageStorage){localStorage.setItem(\"persistentSignMessage\",false);setSignMessage(false);}else{localStorage.setItem(\"persistentSignMessage\",true);setSignMessage(true);}}else{localStorage.setItem(\"persistentSignMessage\",false);setSignMessage(false);}};const handleInputPaste=e=>{if(e.clipboardData.files[0]){const selectedMedias=Array.from(e.clipboardData.files);setMediasUpload(selectedMedias);setShowModalMedias(true);}};const handleInputDrop=e=>{e.preventDefault();if(e.dataTransfer.files[0]){const selectedMedias=Array.from(e.dataTransfer.files);setMediasUpload(selectedMedias);setShowModalMedias(true);}};const handleUploadMedia=async mediasUpload=>{setLoading(true);if(!mediasUpload.length){console.log(\"Nenhuma mÃ­dia selecionada.\");setLoading(false);return;}const formData=new FormData();formData.append(\"fromMe\",true);formData.append(\"isPrivate\",privateMessage||isTicketPending()?\"true\":\"false\");mediasUpload.forEach(media=>{formData.append(\"body\",media.caption);formData.append(\"medias\",media.file);});try{await api.post(\"/messages/\".concat(ticketId),formData);}catch(err){toastError(err);}setLoading(false);setMediasUpload([]);setShowModalMedias(false);if(!isTicketPending()){setPrivateMessage(false);setPrivateMessageInputVisible(false);}};const handleSendContatcMessage=async vcard=>{setSenVcardModalOpen(false);setLoading(true);if(isNil(vcard)){setLoading(false);return;}const message={read:1,fromMe:true,mediaUrl:\"\",body:null,quotedMsg:replyingMessage,isPrivate:privateMessage||isTicketPending()?\"true\":\"false\",vCard:vcard};try{await api.post(\"/messages/\".concat(ticketId),message);}catch(err){toastError(err);}setInputMessage(\"\");setShowEmoji(false);setLoading(false);setReplyingMessage(null);setEditingMessage(null);if(!isTicketPending()){setPrivateMessage(false);setPrivateMessageInputVisible(false);}};const handleSendMessage=async()=>{if(!inputMessage||inputMessage.trim()===\"\")return;setLoading(true);const userName=privateMessage||isTicketPending()?\"\".concat(user.name,\" - Mensagem Interna\"):user.name;const sendMessage=inputMessage.trim();const message={read:1,fromMe:true,mediaUrl:\"\",body:(signMessage&&!isTicketPending()||privateMessage||isTicketPending())&&!editingMessage?\"*\".concat(userName,\":*\\n\").concat(sendMessage):sendMessage,quotedMsg:replyingMessage,isPrivate:privateMessage||isTicketPending()?\"true\":\"false\"};try{if(editingMessage!==null){await api.post(\"/messages/edit/\".concat(editingMessage.id),message);}else{console.log(\"ENVIOU PARA TIKCET\",ticketId);await api.post(\"/messages/\".concat(ticketId),message);}}catch(err){toastError(err);}setInputMessage(\"\");setShowEmoji(false);setLoading(false);setReplyingMessage(null);if(!isTicketPending()){setPrivateMessage(false);}setEditingMessage(null);if(!isTicketPending()){setPrivateMessageInputVisible(false);}handleMenuItemClick();};const handleSendMessageTemplate=async e=>{if(e.id===\"\")return;setLoading(true);const message={templateId:e.id,variables:e.variables,bodyToSave:e.bodyToSave,mediaUrl:\"\",quotedMsg:replyingMessage};try{await api.post(\"/messages-template/\".concat(ticketId),message);setLoading(false);}catch(err){toastError(err);setLoading(false);}setTemplateModalOpen(false);setInputMessage(\"\");setShowEmoji(false);setReplyingMessage(null);if(!isTicketPending()){setPrivateMessage(false);}setEditingMessage(null);if(!isTicketPending()){setPrivateMessageInputVisible(false);}handleMenuItemClick();};const handleStartRecording=async()=>{setLoading(true);try{await navigator.mediaDevices.getUserMedia({audio:true});await Mp3Recorder.start();setRecording(true);setLoading(false);}catch(err){toastError(err);setLoading(false);}};useEffect(()=>{async function fetchData(){const companyId=user.companyId;const messages=await listQuickMessages({companyId,userId:user.id,isOficial:ticketChannel===\"whatsapp_oficial\"?\"true\":\"false\"});const options=messages.map(m=>{let truncatedMessage=m.message;if(isString(truncatedMessage)&&truncatedMessage.length>90){truncatedMessage=m.message.substring(0,90)+\"...\";}return{value:m.message,label:\"/\".concat(m.shortcode,\" - \").concat(truncatedMessage),mediaPath:m.mediaPath,mediaType:m.mediaType,shortcode:m.shortcode};});if(isMounted.current){setQuickAnswer(options);}}fetchData();},[]);useEffect(()=>{if(isString(inputMessage)&&!isEmpty(inputMessage)&&inputMessage.length>=1){const firstWord=inputMessage.charAt(0);if(firstWord===\"/\"){setTypeBar(firstWord.indexOf(\"/\")>-1);const filteredOptions=quickAnswers.filter(m=>m.label.toLowerCase().indexOf(inputMessage.toLowerCase())>-1);setTypeBar(filteredOptions);}else{setTypeBar(false);}}else{setTypeBar(false);}},[inputMessage]);useEffect(()=>{console.log(\"ðŸ” Modal state:\",triggerFlowModalOpen,\"Flow processing:\",flowProcessing);// ðŸ”¥ RESET SIMPLES: Se modal fecha, libera campo\nif(!triggerFlowModalOpen&&flowProcessing){console.log(\"ðŸ”“ FORÃ‡ANDO liberaÃ§Ã£o do campo\");setFlowProcessing(false);flowProcessingRef.current=false;}},[triggerFlowModalOpen,flowProcessing]);const disableOption=useCallback(()=>{const isFlowProcessing=flowProcessingRef.current||flowProcessing;return loading||recording||isFlowProcessing||// ðŸ›¡ï¸ Usar tanto ref quanto estado\n!isTicketPending()&&ticketStatus!==\"open\"&&ticketStatus!==\"group\";},[loading,recording,flowProcessing,ticketStatus]);const disableOptionForPending=useCallback(()=>{const isFlowProcessing=flowProcessingRef.current||flowProcessing;return loading||recording||isFlowProcessing||// ðŸ›¡ï¸ Usar tanto ref quanto estado\nticketStatus===\"closed\";},[loading,recording,flowProcessing,ticketStatus]);const handleUploadCamera=async blob=>{setLoading(true);try{const formData=new FormData();const filename=\"\".concat(new Date().getTime(),\".png\");formData.append(\"medias\",blob,filename);formData.append(\"body\",privateMessage||isTicketPending()?\"\\u200D\":\"\");formData.append(\"fromMe\",true);await api.post(\"/messages/\".concat(ticketId),formData);}catch(err){toastError(err);setLoading(false);}setLoading(false);};// âœ… CORREÃ‡ÃƒO KISS: Apenas otimizar nome do arquivo para mobile\nconst handleUploadAudio=async()=>{setLoading(true);try{const[,blob]=await Mp3Recorder.stop().getMp3();if(blob.size<10000){setLoading(false);setRecording(false);return;}const formData=new FormData();// âœ… CORREÃ‡ÃƒO: Nome do arquivo otimizado para mobile\nlet filename;if([\"whatsapp\",\"whatsapp_oficial\"].includes(ticketChannel)){// Para WhatsApp, usar formato mais compatÃ­vel com mobile\nfilename=isMobileDevice()?\"audio_\".concat(new Date().getTime(),\".ogg\")// OGG para mobile\n:\"audio_\".concat(new Date().getTime(),\".mp3\");// MP3 para desktop\n}else{filename=\"\".concat(new Date().getTime(),\".m4a\");}formData.append(\"medias\",blob,filename);formData.append(\"body\",\"ðŸŽµ Mensagem de voz\");// âœ… Body mais claro\nformData.append(\"fromMe\",true);formData.append(\"isPrivate\",privateMessage||isTicketPending()?\"true\":\"false\");console.log(\"\\uD83D\\uDCE4 Enviando \\xE1udio: \".concat(filename,\" (\").concat(blob.size,\" bytes)\"));if(isMounted.current){await api.post(\"/messages/\".concat(ticketId),formData);}}catch(err){toastError(err);}finally{if(isMounted.current){setLoading(false);setRecording(false);}}};const handleCloseModalMedias=()=>{setShowModalMedias(false);};const handleCancelAudio=async()=>{try{await Mp3Recorder.stop().getMp3();setRecording(false);}catch(err){toastError(err);}};const handleOpenMenuClick=event=>{setAnchorEl(event.currentTarget);};const handleMenuItemClick=event=>{setAnchorEl(null);};const handleSendContactModalOpen=async()=>{handleMenuItemClick();setSenVcardModalOpen(true);};const handleCameraModalOpen=async()=>{handleMenuItemClick();setModalCameraOpen(true);};const handleCancelSelection=()=>{setMediasUpload([]);setShowModalMedias(false);};const checkForSelectedText=useCallback(()=>{if(inputRef.current){const start=inputRef.current.selectionStart;const end=inputRef.current.selectionEnd;if(start!==end&&start!==null&&end!==null){const selectedText=inputMessage.substring(start,end);if(selectedText.trim()!==''){// Para InputBase, calcular posiÃ§Ã£o baseada no elemento\nconst inputRect=inputRef.current.getBoundingClientRect();const scrollTop=window.pageYOffset||document.documentElement.scrollTop;setSelectedText({text:selectedText,start:start,end:end});setFormatMenuAnchorPosition({x:inputRect.left+inputRect.width/2,y:inputRect.top+scrollTop-10// Posicionar acima do input\n});return true;}}}setFormatMenuAnchorPosition(null);return false;},[inputMessage]);const handleCloseFormatMenu=useCallback(()=>{setFormatMenuAnchorPosition(null);},[]);// Aplica a formataÃ§Ã£o ao texto selecionado\nconst handleFormatText=useCallback(formatType=>{const{text,start,end}=selectedText;let formattedText='';switch(formatType){case'bold':formattedText=\"*\".concat(text,\"*\");break;case'italic':formattedText=\"_\".concat(text,\"_\");break;case'strikethrough':formattedText=\"~\".concat(text,\"~\");break;case'code':formattedText=\"`\".concat(text,\"`\");break;case'numberedList':formattedText=text.split('\\n').map((line,index)=>\"\".concat(index+1,\". \").concat(line)).join('\\n');break;case'bulletList':formattedText=text.split('\\n').map(line=>\"\\u2022 \".concat(line)).join('\\n');break;case'quote':formattedText=text.split('\\n').map(line=>\"> \".concat(line)).join('\\n');break;case'clear':formattedText=text.replace(/\\*([^*]+)\\*/g,'$1')// remove negrito\n.replace(/_([^_]+)_/g,'$1')// remove itÃ¡lico\n.replace(/~([^~]+)~/g,'$1')// remove tachado\n.replace(/`([^`]+)`/g,'$1')// remove cÃ³digo\n.replace(/^\\d+\\.\\s/gm,'')// remove numeraÃ§Ã£o de lista\n.replace(/^â€¢\\s/gm,'')// remove marcadores de lista\n.replace(/^>\\s/gm,'');// remove citaÃ§Ã£o\nbreak;default:formattedText=text;}// Substitui o texto selecionado pelo texto formatado\nconst newInputMessage=inputMessage.substring(0,start)+formattedText+inputMessage.substring(end);setInputMessage(newInputMessage);// Fecha o menu apÃ³s a formataÃ§Ã£o\nhandleCloseFormatMenu();// Define o foco e a posiÃ§Ã£o do cursor apÃ³s a operaÃ§Ã£o\nsetTimeout(()=>{if(inputRef.current){inputRef.current.focus();const newCursorPosition=start+formattedText.length;inputRef.current.selectionStart=newCursorPosition;inputRef.current.selectionEnd=newCursorPosition;}},100);},[selectedText,inputMessage,handleCloseFormatMenu]);// Handlers para detectar seleÃ§Ã£o de texto\nconst handleSelectText=useCallback(()=>{checkForSelectedText();},[checkForSelectedText]);const handleMouseUp=useCallback(()=>{checkForSelectedText();},[checkForSelectedText]);const handleKeyUp=useCallback(e=>{// Teclas que podem alterar a seleÃ§Ã£o\nif(e.key==='ArrowLeft'||e.key==='ArrowRight'||e.key==='Shift'){checkForSelectedText();}},[checkForSelectedText]);const renderReplyingMessage=message=>{var _message$contact;return/*#__PURE__*/_jsxs(\"div\",{className:classes.replyginMsgWrapper,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.replyginMsgContainer,children:[/*#__PURE__*/_jsx(\"span\",{className:clsx(classes.replyginContactMsgSideColor,{[classes.replyginSelfMsgSideColor]:!message.fromMe})}),replyingMessage&&/*#__PURE__*/_jsxs(\"div\",{className:classes.replyginMsgBody,children:[!message.fromMe&&/*#__PURE__*/_jsx(\"span\",{className:classes.messageContactName,children:(_message$contact=message.contact)===null||_message$contact===void 0?void 0:_message$contact.name}),message.body]})]}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"showRecorder\",component:\"span\",disabled:disableOptionForPending(),onClick:()=>{setReplyingMessage(null);setEditingMessage(null);setInputMessage(\"\");},children:/*#__PURE__*/_jsx(Clear,{className:classes.sendMessageIcons})})]});};const renderFlowProcessingAlert=()=>{if(!flowProcessing)return null;return/*#__PURE__*/_jsxs(Box,{className:classes.pendingAlert,style:{backgroundColor:\"#E8F5E8\",borderColor:\"#4CAF50\"},children:[/*#__PURE__*/_jsx(CircularProgress,{size:16,style:{marginRight:8}}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Fluxo em Execu\\xE7\\xE3o:\"}),\" Campo de mensagem temporariamente desabilitado.\"]})]});};const TextFormatMenu=()=>{const isMenuOpen=Boolean(formatMenuAnchorPosition);const isMobile=useMediaQuery(theme.breakpoints.down('sm'));if(!isMenuOpen)return null;return/*#__PURE__*/_jsx(ClickAwayListener,{onClickAway:handleCloseFormatMenu,children:/*#__PURE__*/_jsx(Fade,{in:isMenuOpen,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.floatingFormatMenu,style:{top:formatMenuAnchorPosition?formatMenuAnchorPosition.y-50:0,left:formatMenuAnchorPosition?formatMenuAnchorPosition.x:0},children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Negrito\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('bold'),size:\"small\",children:/*#__PURE__*/_jsx(FormatBoldIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"It\\xE1lico\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('italic'),size:\"small\",children:/*#__PURE__*/_jsx(FormatItalicIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Tachado\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('strikethrough'),size:\"small\",children:/*#__PURE__*/_jsx(FormatStrikethroughIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"C\\xF3digo\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('code'),size:\"small\",children:/*#__PURE__*/_jsx(CodeIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Lista Numerada\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('numberedList'),size:\"small\",children:/*#__PURE__*/_jsx(FormatListNumberedIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Lista com Marcadores\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('bulletList'),size:\"small\",children:/*#__PURE__*/_jsx(FormatListBulletedIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Cita\\xE7\\xE3o\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('quote'),size:\"small\",children:/*#__PURE__*/_jsx(FormatQuoteIcon,{fontSize:isMobile?\"small\":\"medium\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Limpar Formata\\xE7\\xE3o\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.formatIconButton,disabled:disableOptionForPending(),onClick:()=>handleFormatText('clear'),size:\"small\",children:/*#__PURE__*/_jsx(FormatClearIcon,{fontSize:isMobile?\"small\":\"medium\"})})})]})})});};const renderPendingAlert=()=>{if(!isTicketPending())return null;return/*#__PURE__*/_jsxs(Box,{className:classes.pendingAlert,children:[/*#__PURE__*/_jsx(Info,{style:{fontSize:20}}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Ticket Aguardando:\"}),\" Apenas mensagens internas s\\xE3o permitidas neste momento.\"]})]});};if(mediasUpload.length>0){return/*#__PURE__*/_jsx(Paper,{elevation:0,square:true,className:classes.viewMediaInputWrapper,onDragEnter:()=>setOnDragEnter(true),onDrop:e=>handleInputDrop(e),children:showModalMedias&&/*#__PURE__*/_jsx(MessageUploadMedias,{isOpen:showModalMedias,files:mediasUpload,onClose:handleCloseModalMedias,onSend:handleUploadMedia,onCancelSelection:handleCancelSelection})});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[templateModalOpen&&/*#__PURE__*/_jsx(TemplateModal,{open:templateModalOpen,handleClose:()=>setTemplateModalOpen(false),onSelectTemplate:e=>handleSendMessageTemplate(e),templates:templates}),modalCameraOpen&&/*#__PURE__*/_jsx(CameraModal,{isOpen:modalCameraOpen,onRequestClose:()=>setModalCameraOpen(false),onCapture:handleCapture}),senVcardModalOpen&&/*#__PURE__*/_jsx(ContactSendModal,{modalOpen:senVcardModalOpen,onClose:c=>{handleSendContatcMessage(c);}}),triggerFlowModalOpen&&/*#__PURE__*/_jsx(TriggerFlowModal,{open:triggerFlowModalOpen,onClose:handleTriggerFlowClose,ticketId:ticketId,ticketStatus:ticketStatus,onFlowTriggered:handleFlowTriggered,onFlowProcessing:handleFlowProcessing}),/*#__PURE__*/_jsxs(Paper,{square:true,elevation:0,className:classes.mainWrapper,onDragEnter:()=>setOnDragEnter(true),onDrop:e=>handleInputDrop(e),children:[renderPendingAlert(),renderFlowProcessingAlert(),replyingMessage&&renderReplyingMessage(replyingMessage)||editingMessage&&renderReplyingMessage(editingMessage),/*#__PURE__*/_jsxs(\"div\",{className:classes.newMessageBox,children:[!isTicketPending()&&/*#__PURE__*/_jsxs(Hidden,{only:[\"sm\",\"xs\"],children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"emojiPicker\",component:\"span\",disabled:disableOption(),onClick:e=>setShowEmoji(prevState=>!prevState),children:/*#__PURE__*/_jsx(Mood,{className:classes.sendMessageIcons})}),showEmoji?/*#__PURE__*/_jsx(\"div\",{className:classes.emojiBox,children:/*#__PURE__*/_jsx(ClickAwayListener,{onClickAway:e=>setShowEmoji(true),children:/*#__PURE__*/_jsx(Picker,{perLine:16,theme:\"dark\",i18n:i18n,showPreview:true,showSkinTones:false,onSelect:handleAddEmoji})})}):null,/*#__PURE__*/_jsx(Fab,{disabled:disableOption(),\"aria-label\":\"uploadMedias\",component:\"span\",className:classes.invertedFabMenu,onClick:handleOpenMenuClick,children:/*#__PURE__*/_jsx(AddIcon,{})}),/*#__PURE__*/_jsxs(Menu,{anchorEl:anchorEl,keepMounted:true,open:Boolean(anchorEl),onClose:handleMenuItemClick,id:\"simple-menu\",children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(\"input\",{multiple:true,type:\"file\",id:\"upload-img-button\",accept:\"image/*, video/*, audio/* \",className:classes.uploadInput,onChange:handleChangeMedias}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"upload-img-button\",children:[/*#__PURE__*/_jsx(Fab,{\"aria-label\":\"upload-img\",component:\"span\",className:classes.invertedFabMenuMP,children:/*#__PURE__*/_jsx(PermMedia,{})}),i18n.t(\"messageInput.type.imageVideo\")]})]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleCameraModalOpen,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuCamera,children:/*#__PURE__*/_jsx(CameraAlt,{})}),i18n.t(\"messageInput.type.cam\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(\"input\",{multiple:true,type:\"file\",id:\"upload-doc-button\",accept:\"application/*, text/*, .odt, .ods, .odp, .odg, .xml, .ofx, .zip, .rar, .7z, .tar, .gz, .bz2, .msg, .key, .numbers, .pages\",className:classes.uploadInput,onChange:handleChangeMedias}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"upload-doc-button\",children:[/*#__PURE__*/_jsx(Fab,{\"aria-label\":\"upload-img\",component:\"span\",className:classes.invertedFabMenuDoc,children:/*#__PURE__*/_jsx(Description,{})}),\"Documento\"]})]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendContactModalOpen,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuCont,children:/*#__PURE__*/_jsx(Person,{})}),i18n.t(\"messageInput.type.contact\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendLinkVideo,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuMeet,children:/*#__PURE__*/_jsx(Duo,{})}),i18n.t(\"messageInput.type.meet\")]}),useWhatsappOfficial&&ticketChannel===\"whatsapp_oficial\"&&/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendTemplate,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuMeet,children:/*#__PURE__*/_jsx(WhatsApp,{})}),i18n.t(\"messageInput.type.template\")]})]}),signMessagePar&&/*#__PURE__*/_jsx(Tooltip,{title:i18n.t(\"messageInput.tooltip.signature\"),children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"send-upload\",component:\"span\",onClick:handleChangeSign,children:signMessage===true?/*#__PURE__*/_jsx(Create,{style:{color:theme.mode===\"light\"?theme.palette.primary.main:\"#EEE\"}}):/*#__PURE__*/_jsx(Create,{style:{color:\"grey\"}})})}),ticketStatus===\"open\"&&/*#__PURE__*/_jsx(Tooltip,{title:\"Disparar Fluxo\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"trigger-flow\",component:\"span\",onClick:handleTriggerFlowClick,disabled:disableOption(),children:/*#__PURE__*/_jsx(AccountTree,{style:{color:theme.mode===\"light\"?theme.palette.secondary.main:\"#EEE\"}})})}),!isTicketPending()&&/*#__PURE__*/_jsx(Tooltip,{title:i18n.t(\"messageInput.tooltip.privateMessage\"),children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"send-upload\",component:\"span\",onClick:handlePrivateMessage,children:privateMessage===true?/*#__PURE__*/_jsx(Comment,{style:{color:theme.mode===\"light\"?theme.palette.primary.main:\"#EEE\"}}):/*#__PURE__*/_jsx(Comment,{style:{color:\"grey\"}})})})]}),isTicketPending()&&/*#__PURE__*/_jsxs(Hidden,{only:[\"md\",\"lg\",\"xl\"],children:[/*#__PURE__*/_jsx(IconButton,{\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleOpenMenuClick,children:/*#__PURE__*/_jsx(MoreVert,{})}),/*#__PURE__*/_jsx(Menu,{id:\"simple-menu\",keepMounted:true,anchorEl:anchorEl,open:Boolean(anchorEl),onClose:handleMenuItemClick,children:/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"emojiPicker\",component:\"span\",disabled:disableOptionForPending(),onClick:e=>setShowEmoji(prevState=>!prevState),children:/*#__PURE__*/_jsx(Mood,{className:classes.sendMessageIcons})}),\"Emoji\"]})})]}),!isTicketPending()&&/*#__PURE__*/_jsxs(Hidden,{only:[\"md\",\"lg\",\"xl\"],children:[/*#__PURE__*/_jsx(IconButton,{\"aria-controls\":\"simple-menu\",\"aria-haspopup\":\"true\",onClick:handleOpenMenuClick,children:/*#__PURE__*/_jsx(MoreVert,{})}),/*#__PURE__*/_jsxs(Menu,{id:\"simple-menu\",keepMounted:true,anchorEl:anchorEl,open:Boolean(anchorEl),onClose:handleMenuItemClick,children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"emojiPicker\",component:\"span\",disabled:disableOption(),onClick:e=>setShowEmoji(prevState=>!prevState),children:/*#__PURE__*/_jsx(Mood,{className:classes.sendMessageIcons})}),\"Emoji\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(\"input\",{multiple:true,type:\"file\",id:\"upload-img-button-mobile\",accept:\"image/*, video/*, audio/* \",disabled:disableOption(),className:classes.uploadInput,onChange:handleChangeMedias}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"upload-img-button-mobile\",children:/*#__PURE__*/_jsx(Fab,{\"aria-label\":\"upload-img\",component:\"span\",className:classes.invertedFabMenuMP,disabled:disableOption(),children:/*#__PURE__*/_jsx(PermMedia,{})})}),i18n.t(\"messageInput.type.imageVideo\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleCameraModalOpen,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuCamera,disabled:disableOption(),children:/*#__PURE__*/_jsx(CameraAlt,{})}),i18n.t(\"messageInput.type.cam\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleMenuItemClick,children:[/*#__PURE__*/_jsx(\"input\",{multiple:true,type:\"file\",id:\"upload-doc-button-mobile\",accept:\"application/*, text/*, .odt, .ods, .odp, .odg, .xml, .ofx, .zip, .rar, .7z, .tar, .gz, .bz2, .msg, .key, .numbers, .pages\",disabled:disableOption(),className:classes.uploadInput,onChange:handleChangeMedias}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"upload-doc-button-mobile\",children:/*#__PURE__*/_jsx(Fab,{\"aria-label\":\"upload-img\",component:\"span\",className:classes.invertedFabMenuDoc,disabled:disableOption(),children:/*#__PURE__*/_jsx(Description,{})})}),\"Documento\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendContactModalOpen,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuCont,disabled:disableOption(),children:/*#__PURE__*/_jsx(Person,{})}),i18n.t(\"messageInput.type.contact\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendLinkVideo,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuMeet,disabled:disableOption(),children:/*#__PURE__*/_jsx(Duo,{})}),i18n.t(\"messageInput.type.meet\")]}),useWhatsappOfficial&&ticketChannel===\"whatsapp_oficial\"&&/*#__PURE__*/_jsxs(MenuItem,{onClick:handleSendTemplate,children:[/*#__PURE__*/_jsx(Fab,{className:classes.invertedFabMenuMeet,disabled:disableOption(),children:/*#__PURE__*/_jsx(WhatsApp,{})}),i18n.t(\"messageInput.type.template\")]}),signMessagePar&&/*#__PURE__*/_jsxs(MenuItem,{onClick:handleChangeSign,children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Habilitar/Desabilitar Assinatura\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"send-upload\",component:\"span\",children:signMessage===true?/*#__PURE__*/_jsx(Create,{style:{color:theme.mode===\"light\"?theme.palette.primary.main:\"#EEE\"}}):/*#__PURE__*/_jsx(Create,{style:{color:\"grey\"}})})}),\"Assinatura\"]}),ticketStatus===\"open\"&&/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>{handleMenuItemClick();handleTriggerFlowClick();},children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"trigger-flow\",component:\"span\",children:/*#__PURE__*/_jsx(AccountTree,{style:{color:theme.mode===\"light\"?theme.palette.secondary.main:\"#EEE\"}})}),\"Disparar Fluxo\"]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:handlePrivateMessage,children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Habilitar/Desabilitar Coment\\xE1rios\",children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"send-upload\",component:\"span\",children:privateMessage===true?/*#__PURE__*/_jsx(Comment,{style:{color:theme.mode===\"light\"?theme.palette.primary.main:\"#EEE\"}}):/*#__PURE__*/_jsx(Comment,{style:{color:\"grey\"}})})}),\"Coment\\xE1rios\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.flexContainer,children:[(privateMessageInputVisible||isTicketPending())&&/*#__PURE__*/_jsx(\"div\",{className:classes.flexItem,children:/*#__PURE__*/_jsxs(\"div\",{className:isTicketPending()?classes.messageInputWrapperPending:classes.messageInputWrapperPrivate,children:[/*#__PURE__*/_jsx(InputBase,{inputRef:input=>{input&&input.focus();input&&(inputRef.current=input);},className:isTicketPending()?classes.messageInputPending:classes.messageInputPrivate,placeholder:isTicketPending()?\"Mensagem interna (ticket aguardando aceite)...\":ticketStatus===\"open\"||ticketStatus===\"group\"?i18n.t(\"messagesInput.placeholderPrivateMessage\"):i18n.t(\"messagesInput.placeholderClosed\"),multiline:true,maxRows:5,value:safeCapitalizeFirstLetter(inputMessage),onChange:handleChangeInput,disabled:disableOptionForPending(),onPaste:e=>{(ticketStatus===\"open\"||ticketStatus===\"group\"||isTicketPending())&&handleInputPaste(e);},onKeyDown:handleKeyDown,onKeyUp:handleKeyUp,onMouseUp:handleMouseUp,onSelect:handleSelectText,onKeyPress:e=>{if(loading||e.shiftKey)return;else if(e.key===\"Enter\"&&!isNavigatingQuickAnswers){handleSendMessage();}},spellCheck:true}),typeBar?/*#__PURE__*/_jsxs(Box,{component:\"ul\",className:classes.messageQuickAnswersWrapper,style:{marginBottom:\"8px\"// âœ… Pequeno espaÃ§o entre input e lista\n},children:[typeBar.map((value,index)=>{const isSelected=selectedQuickAnswerIndex===index;return/*#__PURE__*/_jsx(\"li\",{className:classes.messageQuickAnswersWrapperItem,style:{listStyle:\"none\"},children:/*#__PURE__*/_jsxs(\"div\",{className:clsx(classes.quickAnswerItem,isSelected&&classes.quickAnswerItemSelected),style:_objectSpread(_objectSpread({},getQuickAnswerItemStyle(index)),isSelected&&{backgroundColor:theme.palette.primary.light+\"20\",borderLeft:\"4px solid \".concat(theme.palette.primary.main),transform:\"translateX(2px)\"// âœ… Leve deslocamento visual\n}),onClick:()=>handleQuickAnswersClick(value),children:[/*#__PURE__*/_jsx(Box,{className:classes.quickAnswerText,children:value.label}),value.mediaType&&/*#__PURE__*/_jsx(Chip,{size:\"small\",label:\"\".concat(getMediaTypeIcon(value.mediaType),\" \").concat(value.mediaType),color:getMediaTypeColor(value.mediaType),className:classes.mediaTypeChip})]})},index);}),typeBar.length>4&&/*#__PURE__*/_jsx(\"li\",{style:{listStyle:\"none\"},children:/*#__PURE__*/_jsxs(\"div\",{className:classes.quickAnswersScrollIndicator,children:[\"\\uD83D\\uDCCB \",typeBar.length,\" respostas \\u2022 use \\u2191\\u2193 para navegar\"]})})]}):null]})}),!privateMessageInputVisible&&!isTicketPending()&&/*#__PURE__*/_jsx(\"div\",{className:classes.flexItem,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.messageInputWrapper,children:[/*#__PURE__*/_jsx(InputBase,{inputRef:input=>{input&&input.focus();input&&(inputRef.current=input);},className:classes.messageInput,placeholder:placeholderText,multiline:true,maxRows:5,value:safeCapitalizeFirstLetter(inputMessage),onChange:handleChangeInput,disabled:disableOption(),onPaste:e=>{(ticketStatus===\"open\"||ticketStatus===\"group\")&&handleInputPaste(e);},onKeyDown:handleKeyDown,onKeyUp:handleKeyUp,onMouseUp:handleMouseUp,onSelect:handleSelectText,onKeyPress:e=>{if(loading||e.shiftKey)return;else if(e.key===\"Enter\"&&!isNavigatingQuickAnswers){handleSendMessage();}},spellCheck:true}),typeBar?/*#__PURE__*/_jsxs(\"ul\",{className:classes.messageQuickAnswersWrapper,children:[typeBar.map((value,index)=>{const isSelected=selectedQuickAnswerIndex===index;return/*#__PURE__*/_jsx(\"li\",{className:classes.messageQuickAnswersWrapperItem,children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(classes.quickAnswerItem,\" \").concat(isSelected?'selected':''),style:getQuickAnswerItemStyle(index),onClick:()=>handleQuickAnswersClick(value),children:[/*#__PURE__*/_jsx(Box,{className:classes.quickAnswerText,children:value.label}),value.mediaType&&/*#__PURE__*/_jsx(Chip,{size:\"small\",label:\"\".concat(getMediaTypeIcon(value.mediaType),\" \").concat(value.mediaType),color:getMediaTypeColor(value.mediaType),className:classes.mediaTypeChip})]})},index);}),typeBar.length>5&&/*#__PURE__*/_jsxs(\"div\",{className:classes.quickAnswersScrollIndicator,children:[typeBar.length,\" respostas \\u2022 role para ver mais\"]})]}):/*#__PURE__*/_jsx(\"div\",{})]})})]}),(!privateMessageInputVisible||isTicketPending())&&/*#__PURE__*/_jsxs(_Fragment,{children:[showSchedules&&!isTicketPending()&&/*#__PURE__*/_jsx(Tooltip,{title:i18n.t(\"tickets.buttons.scredule\"),children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"scheduleMessage\",component:\"span\",onClick:()=>setAppointmentModalOpen(true),disabled:loading,children:/*#__PURE__*/_jsx(Timer,{className:classes.sendMessageIcons})})}),inputMessage||showSelectMessageCheckbox?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"sendMessage\",component:\"span\",onClick:showSelectMessageCheckbox?handleOpenModalForward:handleSendMessage,disabled:loading,children:showSelectMessageCheckbox?/*#__PURE__*/_jsx(Reply,{className:classes.ForwardMessageIcons}):/*#__PURE__*/_jsx(Send,{className:classes.sendMessageIcons})})}):recording?/*#__PURE__*/_jsxs(\"div\",{className:classes.recorderWrapper,children:[/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"cancelRecording\",component:\"span\",fontSize:\"large\",disabled:loading,onClick:handleCancelAudio,children:/*#__PURE__*/_jsx(HighlightOff,{className:classes.cancelAudioIcon})}),loading?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CircularProgress,{className:classes.audioLoading})}):/*#__PURE__*/_jsx(RecordingTimer,{}),/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"sendRecordedAudio\",component:\"span\",onClick:handleUploadAudio,disabled:loading,children:/*#__PURE__*/_jsx(CheckCircleOutline,{className:classes.sendAudioIcon})})]}):/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"showRecorder\",component:\"span\",disabled:disableOptionForPending(),onClick:handleStartRecording,children:/*#__PURE__*/_jsx(Mic,{className:classes.sendMessageIcons})})]}),privateMessageInputVisible&&!isTicketPending()&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"sendMessage\",component:\"span\",onClick:showSelectMessageCheckbox?handleOpenModalForward:handleSendMessage,disabled:loading,children:showSelectMessageCheckbox?/*#__PURE__*/_jsx(Reply,{className:classes.ForwardMessageIcons}):/*#__PURE__*/_jsx(Send,{className:classes.sendMessageIcons})})}),appointmentModalOpen&&/*#__PURE__*/_jsx(ScheduleModal,{open:appointmentModalOpen,onClose:()=>setAppointmentModalOpen(false),message:inputMessage,contactId:contactId,fromMessageInput:true,user:user}),/*#__PURE__*/_jsx(TextFormatMenu,{})]})]})]});}};export default MessageInput;","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","useCallback","Picker","useMediaQuery","useTheme","isNil","Fade","CircularProgress","ClickAwayListener","IconButton","InputBase","makeStyles","Paper","Hidden","Menu","MenuItem","Tooltip","Fab","Chip","Box","blue","green","pink","grey","AttachFile","CheckCircleOutline","Clear","Comment","Create","Description","HighlightOff","Mic","Mood","MoreVert","Send","PermMedia","Person","Reply","Duo","Timer","WhatsApp","Info","AccountTree","FormatBold","FormatBoldIcon","FormatItalic","FormatItalicIcon","FormatStrikethrough","FormatStrikethroughIcon","Code","CodeIcon","FormatListNumbered","FormatListNumberedIcon","FormatListBulleted","FormatListBulletedIcon","FormatQuote","FormatQuoteIcon","FormatClear","FormatClearIcon","AddIcon","CameraAlt","MicRecorder","clsx","ReplyMessageContext","AuthContext","i18n","toastError","api","openApi","RecordingTimer","useQuickMessages","isString","isEmpty","ContactSendModal","CameraModal","axios","useCompanySettings","ForwardMessageContext","MessageUploadMedias","EditMessageContext","ScheduleModal","usePlans","TemplateModal","TriggerFlowModal","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Mp3Recorder","bitRate","sampleRate","isMobileDevice","test","navigator","userAgent","useStyles","theme","mainWrapper","background","display","flexDirection","alignItems","borderTop","breakpoints","down","position","bottom","width","avatar","height","borderRadius","dropInfo","padding","left","right","dropInfoOut","gridFiles","maxHeight","overflow","newMessageBox","palette","default","messageInputWrapper","marginRight","paper","flex","zIndex","messageInputWrapperPrivate","messageInputWrapperPending","border","messageInput","paddingLeft","messageInputPrivate","color","messageInputPending","fontWeight","sendMessageIcons","ForwardMessageIcons","transform","uploadInput","viewMediaInputWrapper","justifyContent","backgroundColor","mode","emojiBox","circleLoading","opacity","top","marginLeft","audioLoading","recorderWrapper","alignContent","cancelAudioIcon","sendAudioIcon","replyginMsgWrapper","paddingTop","paddingRight","optionsBackground","replyginMsgContainer","overflowY","replyginMsgBody","whiteSpace","replyginContactMsgSideColor","replyginSelfMsgSideColor","floatingFormatMenu","shape","boxShadow","shadows","concat","divider","formatIconButton","minWidth","messageContactName","messageQuickAnswersWrapper","margin","overflowX","action","disabled","hover","listStyle","textOverflow","cursor","quickAnswerItem","gap","spacing","minHeight","transition","quickAnswerItemSelected","primary","light","borderLeft","main","quickAnswersScrollIndicator","textAlign","fontSize","text","secondary","fontStyle","quickAnswerText","mediaTypeChip","invertedFabMenu","invertedFabMenuMP","invertedFabMenuCont","invertedFabMenuMeet","invertedFabMenuDoc","invertedFabMenuCamera","flexContainer","flexItem","pendingAlert","marginBottom","MessageInput","_ref","ticketId","ticketStatus","droppedFiles","contactId","ticketChannel","whatsappId","classes","mediasUpload","setMediasUpload","isMounted","inputMessage","setInputMessage","showEmoji","setShowEmoji","templateModalOpen","setTemplateModalOpen","templates","setTemplates","loading","setLoading","recording","setRecording","quickAnswers","setQuickAnswer","typeBar","setTypeBar","inputRef","onDragEnter","setOnDragEnter","anchorEl","setAnchorEl","setReplyingMessage","replyingMessage","setEditingMessage","editingMessage","user","appointmentModalOpen","setAppointmentModalOpen","getPlanCompany","signMessagePar","setSignMessagePar","get","getSetting","signMessage","setSignMessage","privateMessage","setPrivateMessage","privateMessageInputVisible","setPrivateMessageInputVisible","senVcardModalOpen","setSenVcardModalOpen","showModalMedias","setShowModalMedias","showSchedules","setShowSchedules","useWhatsappOfficial","setUseWhatsappOfficial","list","listQuickMessages","isMobile","placeholderText","setPlaceHolderText","selectedQuickAnswerIndex","setSelectedQuickAnswerIndex","isNavigatingQuickAnswers","setIsNavigatingQuickAnswers","triggerFlowModalOpen","setTriggerFlowModalOpen","flowProcessing","setFlowProcessing","flowProcessingRef","formatMenuAnchorPosition","setFormatMenuAnchorPosition","selectedText","setSelectedText","start","end","isTicketPending","fetchTemplates","request","url","method","params","isOficial","userId","id","companyId","status","data","fetchData","planConfigs","undefined","plan","useSchedules","t","maxLength","Infinity","length","substring","selectedMessages","setForwardMessageModalOpen","showSelectMessageCheckbox","selectedMedias","Array","from","current","focus","body","isProcessing","handleInsertQuickMessage","event","console","log","detail","quickMessage","error","hasMedia","mediaPath","mediaType","message","handleQuickAnswersClick","value","shortcode","label","finally","currentText","trim","newText","setTimeout","setSelectionRange","window","addEventListener","removeEventListener","fetchSettings","setting","column","sendSignMessage","signMessageStorage","JSON","parse","localStorage","getItem","setItem","safeCapitalizeFirstLetter","string","charAt","toUpperCase","slice","handleTriggerFlowClick","handleTriggerFlowClose","handleFlowProcessing","handleFlowTriggered","handleKeyDown","e","isArray","key","preventDefault","prev","nextIndex","container","document","querySelector","selectedElement","children","scrollIntoView","behavior","block","selectedAnswer","getQuickAnswerItemStyle","index","handleSendLinkVideo","link","handleSendTemplate","handleChangeInput","target","handlePrivateMessage","getMediaTypeIcon","getMediaTypeColor","response","responseType","size","messageBody","handleUploadQuickMessageMedia","err","blob","arguments","blobSize","Error","extension","type","mimeType","split","includes","typeExtensionMap","formData","FormData","filename","Date","getTime","append","post","handleAddEmoji","emoji","native","prevState","modalCameraOpen","setModalCameraOpen","handleCapture","imageData","handleUploadCamera","handleChangeMedias","files","handleChangeSign","getStatusSingMessageLocalstogare","handleOpenModalForward","handleInputPaste","clipboardData","handleInputDrop","dataTransfer","handleUploadMedia","forEach","media","caption","file","handleSendContatcMessage","vcard","read","fromMe","mediaUrl","quotedMsg","isPrivate","vCard","handleSendMessage","userName","name","sendMessage","handleMenuItemClick","handleSendMessageTemplate","templateId","variables","bodyToSave","handleStartRecording","mediaDevices","getUserMedia","audio","messages","options","map","m","truncatedMessage","firstWord","indexOf","filteredOptions","filter","toLowerCase","disableOption","isFlowProcessing","disableOptionForPending","handleUploadAudio","stop","getMp3","handleCloseModalMedias","handleCancelAudio","handleOpenMenuClick","currentTarget","handleSendContactModalOpen","handleCameraModalOpen","handleCancelSelection","checkForSelectedText","selectionStart","selectionEnd","inputRect","getBoundingClientRect","scrollTop","pageYOffset","documentElement","x","y","handleCloseFormatMenu","handleFormatText","formatType","formattedText","line","join","replace","newInputMessage","newCursorPosition","handleSelectText","handleMouseUp","handleKeyUp","renderReplyingMessage","_message$contact","className","contact","component","onClick","renderFlowProcessingAlert","style","borderColor","TextFormatMenu","isMenuOpen","Boolean","onClickAway","in","title","renderPendingAlert","elevation","square","onDrop","isOpen","onClose","onSend","onCancelSelection","open","handleClose","onSelectTemplate","onRequestClose","onCapture","modalOpen","c","onFlowTriggered","onFlowProcessing","only","perLine","showPreview","showSkinTones","onSelect","keepMounted","multiple","accept","onChange","htmlFor","input","placeholder","multiline","maxRows","onPaste","onKeyDown","onKeyUp","onMouseUp","onKeyPress","shiftKey","spellCheck","isSelected","messageQuickAnswersWrapperItem","_objectSpread","fromMessageInput"],"sources":["/home/deploy/atendechatop/frontend/src/components/MessageInput/index.js"],"sourcesContent":["import React, {\n  useState,\n  useEffect,\n  useContext,\n  useRef,\n  useCallback,\n} from \"react\";\nimport \"emoji-mart/css/emoji-mart.css\";\nimport { Picker } from \"emoji-mart\";\nimport { useMediaQuery, useTheme } from \"@material-ui/core\";\nimport { isNil } from \"lodash\";\nimport {\n  Fade\n} from \"@material-ui/core\";\nimport {\n  CircularProgress,\n  ClickAwayListener,\n  IconButton,\n  InputBase,\n  makeStyles,\n  Paper,\n  Hidden,\n  Menu,\n  MenuItem,\n  Tooltip,\n  Fab,\n  Chip,\n  Box,\n} from \"@material-ui/core\";\nimport { blue, green, pink, grey } from \"@material-ui/core/colors\";\nimport {\n  AttachFile,\n  CheckCircleOutline,\n  Clear,\n  Comment,\n  Create,\n  Description,\n  HighlightOff,\n  Mic,\n  Mood,\n  MoreVert,\n  Send,\n  PermMedia,\n  Person,\n  Reply,\n  Duo,\n  Timer,\n  WhatsApp,\n  Info,\n  AccountTree\n} from \"@material-ui/icons\";\n\nimport {\n  FormatBold as FormatBoldIcon,\n  FormatItalic as FormatItalicIcon,\n  FormatStrikethrough as FormatStrikethroughIcon,\n  Code as CodeIcon,\n  FormatListNumbered as FormatListNumberedIcon,\n  FormatListBulleted as FormatListBulletedIcon,\n  FormatQuote as FormatQuoteIcon,\n  FormatClear as FormatClearIcon,\n} from \"@material-ui/icons\";\n\nimport AddIcon from \"@material-ui/icons/Add\";\nimport { CameraAlt } from \"@material-ui/icons\";\nimport MicRecorder from \"mic-recorder-to-mp3\";\nimport clsx from \"clsx\";\nimport { ReplyMessageContext } from \"../../context/ReplyingMessage/ReplyingMessageContext\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { i18n } from \"../../translate/i18n\";\nimport toastError from \"../../errors/toastError\";\nimport api, { openApi } from \"../../services/api\";\nimport RecordingTimer from \"./RecordingTimer\";\n\nimport useQuickMessages from \"../../hooks/useQuickMessages\";\nimport { isString, isEmpty } from \"lodash\";\nimport ContactSendModal from \"../ContactSendModal\";\nimport CameraModal from \"../CameraModal\";\nimport axios from \"axios\";\n\nimport useCompanySettings from \"../../hooks/useSettings/companySettings\";\nimport { ForwardMessageContext } from \"../../context/ForwarMessage/ForwardMessageContext\";\nimport MessageUploadMedias from \"../MessageUploadMedias\";\nimport { EditMessageContext } from \"../../context/EditingMessage/EditingMessageContext\";\nimport ScheduleModal from \"../ScheduleModal\";\nimport usePlans from \"../../hooks/usePlans\";\nimport TemplateModal from \"../TemplateMetaModal\";\nimport TriggerFlowModal from \"../TriggerFlowModal\";\n\n\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128,\n  sampleRate: 44100\n});\n\nconst isMobileDevice = () => {\n  return /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n};\n\nconst useStyles = makeStyles((theme) => ({\n  mainWrapper: {\n    background: \"#eee\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n    [theme.breakpoints.down(\"sm\")]: {\n      position: \"fixed\",\n      bottom: 0,\n      width: \"100%\",\n    },\n  },\n  avatar: {\n    width: \"50px\",\n    height: \"50px\",\n    borderRadius: \"25%\",\n  },\n  dropInfo: {\n    background: \"#eee\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    width: \"100%\",\n    padding: 15,\n    left: 0,\n    right: 0,\n  },\n  dropInfoOut: {\n    display: \"none\",\n  },\n  gridFiles: {\n    maxHeight: \"100%\",\n    overflow: \"scroll\",\n  },\n  newMessageBox: {\n    background: theme.palette.background.default,\n    width: \"100%\",\n    display: \"flex\",\n    padding: \"7px\",\n    alignItems: \"center\",\n  },\n  messageInputWrapper: {\n    padding: 6,\n    marginRight: 7,\n    background: theme.palette.background.paper,\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1,\n    position: \"relative\", // âœ… Essencial para o position absolute funcionar\n    zIndex: 10, // âœ… Z-index base\n  },\n\n  messageInputWrapperPrivate: {\n    padding: 6,\n    marginRight: 7,\n    background: \"#F0E68C\",\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1,\n    position: \"relative\", // âœ… Essencial para o position absolute funcionar\n    zIndex: 10, // âœ… Z-index base\n  },\n\n  messageInputWrapperPending: {\n    padding: 6,\n    marginRight: 7,\n    background: \"#FFE0B2\",\n    display: \"flex\",\n    borderRadius: 20,\n    flex: 1,\n    position: \"relative\", // âœ… Essencial para o position absolute funcionar\n    border: \"2px solid #FF9800\",\n    zIndex: 10, // âœ… Z-index base\n  },\n  messageInput: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\",\n  },\n  messageInputPrivate: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\",\n    color: grey[800],\n  },\n  messageInputPending: {\n    paddingLeft: 10,\n    flex: 1,\n    border: \"none\",\n    color: \"#E65100\",\n    fontWeight: 500,\n  },\n  sendMessageIcons: {\n    color: grey[700],\n  },\n  ForwardMessageIcons: {\n    color: grey[700],\n    transform: \"scaleX(-1)\",\n  },\n  uploadInput: {\n    display: \"none\",\n  },\n  viewMediaInputWrapper: {\n    maxHeight: \"100%\",\n    display: \"flex\",\n    padding: \"10px 13px\",\n    position: \"relative\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    backgroundColor: theme.mode === \"light\" ? \"#ffffff\" : \"#202c33\",\n    borderTop: \"1px solid rgba(0, 0, 0, 0.12)\",\n  },\n  emojiBox: {\n    position: \"absolute\",\n    bottom: 63,\n    width: 40,\n    borderTop: \"1px solid #e8e8e8\",\n  },\n  circleLoading: {\n    color: green[500],\n    opacity: \"70%\",\n    position: \"absolute\",\n    top: \"20%\",\n    left: \"50%\",\n    marginLeft: -12,\n  },\n  audioLoading: {\n    color: green[500],\n    opacity: \"70%\",\n  },\n  recorderWrapper: {\n    display: \"flex\",\n    alignItems: \"center\",\n    alignContent: \"middle\",\n  },\n  cancelAudioIcon: {\n    color: \"red\",\n  },\n  sendAudioIcon: {\n    color: \"green\",\n  },\n  replyginMsgWrapper: {\n    display: \"flex\",\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingTop: 8,\n    paddingLeft: 73,\n    paddingRight: 7,\n    backgroundColor: theme.palette.optionsBackground,\n  },\n  replyginMsgContainer: {\n    flex: 1,\n    marginRight: 5,\n    overflowY: \"hidden\",\n    backgroundColor: theme.mode === \"light\" ? \"#f0f0f0\" : \"#1d282f\",\n    borderRadius: \"7.5px\",\n    display: \"flex\",\n    position: \"relative\",\n  },\n  replyginMsgBody: {\n    padding: 10,\n    height: \"auto\",\n    display: \"block\",\n    whiteSpace: \"pre-wrap\",\n    overflow: \"hidden\",\n  },\n  replyginContactMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#35cd96\",\n  },\n  replyginSelfMsgSideColor: {\n    flex: \"none\",\n    width: \"4px\",\n    backgroundColor: \"#6bcbef\",\n  },\n  floatingFormatMenu: {\n    position: 'fixed',\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: theme.shape.borderRadius,\n    boxShadow: theme.shadows[8],\n    zIndex: 9999,\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: '4px',\n    border: `1px solid ${theme.palette.divider}`,\n  },\n\n  formatIconButton: {\n    padding: '6px',\n    borderRadius: '4px',\n    minWidth: '32px',\n    height: '32px',\n  },\n  messageContactName: {\n    display: \"flex\",\n    color: \"#6bcbef\",\n    fontWeight: 500,\n  },\n  messageQuickAnswersWrapper: {\n    margin: 0,\n    position: \"absolute\",\n    bottom: \"100%\", // âœ… Posicionar acima do input\n    background: theme.palette.background.default,\n    padding: 0,\n    border: \"none\",\n    left: 0,\n    right: 0, // âœ… Usar right: 0 em vez de width: 100%\n    maxHeight: \"200px\",\n    overflowY: \"auto\",\n    overflowX: \"hidden\",\n    boxShadow: \"0 -4px 16px rgba(0, 0, 0, 0.15)\",\n    borderRadius: \"8px 8px 0 0\",\n    zIndex: 1000, // âœ… Z-index menor para evitar conflitos\n    \"&::-webkit-scrollbar\": {\n      width: \"6px\",\n    },\n    \"&::-webkit-scrollbar-track\": {\n      background: \"transparent\",\n    },\n    \"&::-webkit-scrollbar-thumb\": {\n      backgroundColor: theme.palette.action.disabled,\n      borderRadius: \"3px\",\n      \"&:hover\": {\n        backgroundColor: theme.palette.action.hover,\n      },\n    },\n    \"& li\": {\n      listStyle: \"none\",\n      \"& a\": {\n        display: \"block\",\n        padding: \"8px\",\n        textOverflow: \"ellipsis\",\n        overflow: \"hidden\",\n        maxHeight: \"auto\",\n        \"&:hover\": {\n          background: theme.palette.background.paper,\n          cursor: \"pointer\",\n        },\n      },\n    },\n  },\n  quickAnswerItem: {\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: theme.spacing(1),\n    padding: theme.spacing(1.5),\n    minHeight: \"48px\",\n    cursor: \"pointer\", // âœ… Adicionar cursor pointer\n    borderRadius: \"4px\", // âœ… Bordas arredondadas\n    margin: \"2px 4px\", // âœ… Pequena margem\n    \"&:hover\": {\n      backgroundColor: theme.palette.action.hover,\n    },\n    transition: \"all 0.2s ease-in-out\",\n  },\n\n  // âœ… NOVO: Estilo para item selecionado via teclado\n  quickAnswerItemSelected: {\n    backgroundColor: theme.palette.primary.light + \"30\", // âœ… Cor semi-transparente\n    borderLeft: `4px solid ${theme.palette.primary.main}`,\n    fontWeight: 500,\n  },\n\n  // âœ… NOVO: Indicador de scroll\n  quickAnswersScrollIndicator: {\n    textAlign: \"center\",\n    padding: theme.spacing(1),\n    fontSize: \"0.75rem\",\n    color: theme.palette.text.secondary,\n    fontStyle: \"italic\",\n    borderTop: `1px solid ${theme.palette.divider}`,\n    backgroundColor: theme.palette.background.paper,\n  },\n  quickAnswerText: {\n    flex: 1,\n    textOverflow: \"ellipsis\",\n    overflow: \"hidden\",\n  },\n  mediaTypeChip: {\n    height: 20,\n    fontSize: \"0.7rem\",\n  },\n  invertedFabMenu: {\n    border: \"none\",\n    borderRadius: 50,\n    boxShadow: \"none\",\n    padding: theme.spacing(1),\n    backgroundColor: \"transparent\",\n    color: \"grey\",\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n    \"&:disabled\": {\n      backgroundColor: \"transparent !important\",\n    },\n  },\n  invertedFabMenuMP: {\n    border: \"none\",\n    borderRadius: 0,\n    boxShadow: \"none\",\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n    backgroundColor: \"transparent\",\n    color: blue[800],\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n  },\n  invertedFabMenuCont: {\n    border: \"none\",\n    borderRadius: 0,\n    boxShadow: \"none\",\n    minHeight: \"auto\",\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n    backgroundColor: \"transparent\",\n    color: blue[500],\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n  },\n  invertedFabMenuMeet: {\n    border: \"none\",\n    borderRadius: 0,\n    boxShadow: \"none\",\n    minHeight: \"auto\",\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n    backgroundColor: \"transparent\",\n    color: green[500],\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n  },\n  invertedFabMenuDoc: {\n    border: \"none\",\n    borderRadius: 0,\n    boxShadow: \"none\",\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n    backgroundColor: \"transparent\",\n    color: \"#7f66ff\",\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n  },\n  invertedFabMenuCamera: {\n    border: \"none\",\n    borderRadius: 0,\n    boxShadow: \"none\",\n    width: theme.spacing(4),\n    height: theme.spacing(4),\n    backgroundColor: \"transparent\",\n    color: pink[500],\n    \"&:hover\": {\n      backgroundColor: \"transparent\",\n    },\n  },\n  flexContainer: {\n    display: \"flex\",\n    flex: 1,\n    flexDirection: \"column\",\n  },\n  flexItem: {\n    flex: 1,\n  },\n  pendingAlert: {\n    marginBottom: theme.spacing(1),\n    padding: theme.spacing(1, 2),\n    backgroundColor: \"#E3F2FD\",\n    border: \"1px solid #2196F3\",\n    borderRadius: 4,\n    display: \"flex\",\n    alignItems: \"center\",\n    gap: theme.spacing(1),\n    color: \"#1976D2\",\n    fontSize: \"0.875rem\",\n  },\n}));\n\nconst MessageInput = ({\n  ticketId,\n  ticketStatus,\n  droppedFiles,\n  contactId,\n  ticketChannel,\n  whatsappId,\n}) => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const [mediasUpload, setMediasUpload] = useState([]);\n  const isMounted = useRef(true);\n\n  const [inputMessage, setInputMessage] = useState(\"\");\n  const [showEmoji, setShowEmoji] = useState(false);\n  const [templateModalOpen, setTemplateModalOpen] = useState(false);\n  const [templates, setTemplates] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [recording, setRecording] = useState(false);\n  const [quickAnswers, setQuickAnswer] = useState([]);\n  const [typeBar, setTypeBar] = useState(false);\n  const inputRef = useRef();\n  const [onDragEnter, setOnDragEnter] = useState(false);\n  const [anchorEl, setAnchorEl] = useState(null);\n  const { setReplyingMessage, replyingMessage } =\n    useContext(ReplyMessageContext);\n  const { setEditingMessage, editingMessage } = useContext(EditMessageContext);\n  const { user } = useContext(AuthContext);\n  const [appointmentModalOpen, setAppointmentModalOpen] = useState(false);\n  const { getPlanCompany } = usePlans();\n\n  const [signMessagePar, setSignMessagePar] = useState(false);\n  const { get: getSetting } = useCompanySettings();\n  const [signMessage, setSignMessage] = useState(true);\n  const [privateMessage, setPrivateMessage] = useState(false);\n  const [privateMessageInputVisible, setPrivateMessageInputVisible] =\n    useState(false);\n  const [senVcardModalOpen, setSenVcardModalOpen] = useState(false);\n  const [showModalMedias, setShowModalMedias] = useState(false);\n  const [showSchedules, setShowSchedules] = useState(false);\n  const [useWhatsappOfficial, setUseWhatsappOfficial] = useState(false);\n  const { list: listQuickMessages } = useQuickMessages();\n\n  const isMobile = useMediaQuery(\"(max-width: 767px)\");\n  const [placeholderText, setPlaceHolderText] = useState(\"\");\n\n  const [selectedQuickAnswerIndex, setSelectedQuickAnswerIndex] = useState(-1);\n  const [isNavigatingQuickAnswers, setIsNavigatingQuickAnswers] = useState(false);\n\n  const [triggerFlowModalOpen, setTriggerFlowModalOpen] = useState(false);\n  const [flowProcessing, setFlowProcessing] = useState(false);\n  const flowProcessingRef = useRef(false);\n\n  const [formatMenuAnchorPosition, setFormatMenuAnchorPosition] = useState(null);\n  const [selectedText, setSelectedText] = useState({ text: '', start: 0, end: 0 });\n\n  const isTicketPending = () => {\n    return ticketStatus === \"pending\";\n  };\n\n  useEffect(() => {\n    if (isTicketPending()) {\n      setPrivateMessage(true);\n      setPrivateMessageInputVisible(true);\n    }\n  }, [ticketStatus]);\n\n  useEffect(() => {\n    async function fetchTemplates() {\n      const templates = await api.request({\n        url: `/quick-messages/list`,\n        method: \"GET\",\n        params: {\n          isOficial: \"true\",\n          userId: user.id,\n          companyId: user.companyId,\n          status: \"APPROVED\",\n          // whatsappId,\n        },\n      });\n      setTemplates(templates.data);\n    }\n    if (useWhatsappOfficial) {\n      fetchTemplates();\n    }\n  }, [useWhatsappOfficial]);\n\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = user.companyId;\n      const planConfigs = await getPlanCompany(undefined, companyId);\n      setShowSchedules(planConfigs.plan.useSchedules);\n      setUseWhatsappOfficial(planConfigs.plan.useWhatsappOfficial);\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    if (ticketStatus === \"open\" || ticketStatus === \"group\") {\n      setPlaceHolderText(i18n.t(\"messagesInput.placeholderOpen\"));\n    } else if (ticketStatus === \"pending\") {\n      setPlaceHolderText(\"Digite sua mensagem interna (ticket aguardando)...\");\n    } else {\n      setPlaceHolderText(i18n.t(\"messagesInput.placeholderClosed\"));\n    }\n\n    const maxLength = isMobile ? 20 : Infinity;\n\n    if (isMobile && placeholderText.length > maxLength) {\n      setPlaceHolderText(placeholderText.substring(0, maxLength) + \"...\");\n    }\n  }, [ticketStatus]);\n\n  const {\n    selectedMessages,\n    setForwardMessageModalOpen,\n    showSelectMessageCheckbox,\n  } = useContext(ForwardMessageContext);\n\n  useEffect(() => {\n    if (droppedFiles && droppedFiles.length > 0) {\n      const selectedMedias = Array.from(droppedFiles);\n      setMediasUpload(selectedMedias);\n      setShowModalMedias(true);\n    }\n  }, [droppedFiles]);\n\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    inputRef.current.focus();\n    if (editingMessage) {\n      setInputMessage(editingMessage.body);\n    }\n  }, [replyingMessage, editingMessage]);\n\n  useEffect(() => {\n    inputRef.current.focus();\n    return () => {\n      setInputMessage(\"\");\n      setShowEmoji(false);\n      setMediasUpload([]);\n      setReplyingMessage(null);\n      if (!isTicketPending()) {\n        setPrivateMessage(false);\n        setPrivateMessageInputVisible(false);\n      }\n      setEditingMessage(null);\n    };\n  }, [ticketId, setReplyingMessage, setEditingMessage]);\n\n\n  useEffect(() => {\n    let isProcessing = false; // âœ… Flag para evitar processamento duplo\n\n    const handleInsertQuickMessage = (event) => {\n      // âœ… IMPORTANTE: Evitar processamento duplo\n      if (isProcessing) {\n        console.log(\"âš ï¸ JÃ¡ processando evento, ignorando...\");\n        return;\n      }\n\n      isProcessing = true;\n      console.log(\"ðŸ“¥ Evento insertQuickMessage recebido:\", event.detail);\n\n      const { quickMessage } = event.detail;\n\n      if (!quickMessage) {\n        console.error(\"âŒ quickMessage nÃ£o encontrado no evento\");\n        isProcessing = false;\n        return;\n      }\n\n      console.log(\"ðŸ” Processando quickMessage:\", {\n        hasMedia: !!quickMessage.mediaPath,\n        mediaType: quickMessage.mediaType,\n        message: quickMessage.message,\n        ticketId: ticketId\n      });\n\n      if (quickMessage.mediaPath) {\n        console.log(\"ðŸŽµ Processando resposta rÃ¡pida com mÃ­dia\");\n        handleQuickAnswersClick({\n          value: quickMessage.message || \"\",\n          mediaPath: quickMessage.mediaPath,\n          mediaType: quickMessage.mediaType,\n          shortcode: quickMessage.shortcode,\n          label: `/${quickMessage.shortcode} - ${quickMessage.message}`\n        }).finally(() => {\n          isProcessing = false; // âœ… Liberar flag apÃ³s processamento\n        });\n      } else {\n        console.log(\"ðŸ“ Processando resposta rÃ¡pida de texto\");\n        const currentText = inputMessage?.trim() || \"\";\n        const newText = currentText\n          ? `${currentText}\\n\\n${quickMessage.message}`\n          : quickMessage.message;\n\n        setInputMessage(newText);\n\n        setTimeout(() => {\n          if (inputRef.current) {\n            inputRef.current.focus();\n            const length = newText.length;\n            inputRef.current.setSelectionRange(length, length);\n          }\n          isProcessing = false; // âœ… Liberar flag\n        }, 100);\n      }\n    };\n\n    // âœ… IMPORTANTE: Escutar apenas no window\n    window.addEventListener('insertQuickMessage', handleInsertQuickMessage);\n\n    return () => {\n      window.removeEventListener('insertQuickMessage', handleInsertQuickMessage);\n      isProcessing = false; // âœ… Reset da flag no cleanup\n    };\n  }, [inputMessage, ticketId, privateMessage]);\n\n  useEffect(() => {\n    setTimeout(() => {\n      if (isMounted.current) setOnDragEnter(false);\n    }, 1000);\n  }, [onDragEnter === true]);\n\n  useEffect(() => {\n    const fetchSettings = async () => {\n      const setting = await getSetting({\n        column: \"sendSignMessage\",\n      });\n\n      if (isMounted.current) {\n        if (setting.sendSignMessage === \"enabled\") {\n          setSignMessagePar(true);\n          const signMessageStorage = JSON.parse(\n            localStorage.getItem(\"persistentSignMessage\")\n          );\n          if (isNil(signMessageStorage)) {\n            setSignMessage(true);\n          } else {\n            setSignMessage(signMessageStorage);\n          }\n        } else if (setting.sendSignMessage === \"dontSend\") {\n          localStorage.setItem(\"persistentSignMessage\", false);\n          setSignMessage(false);\n          setSignMessagePar(false);\n        } else {\n          setSignMessagePar(false);\n        }\n      }\n    };\n    fetchSettings();\n  }, []);\n\n  // CORREÃ‡ÃƒO DO ERRO charAt - FunÃ§Ã£o mais robusta\n  const safeCapitalizeFirstLetter = (string) => {\n    if (!string || typeof string !== 'string') return \"\";\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  };\n\n  // FUNÃ‡Ã•ES PARA TRIGGER FLOW MODAL\n  const handleTriggerFlowClick = useCallback(() => {\n    console.log(\"ðŸŽ¯ Abrindo modal de fluxo\");\n\n    // ðŸ›¡ï¸ RESET PREVENTIVO\n    setFlowProcessing(false);\n    flowProcessingRef.current = false;\n\n    setTriggerFlowModalOpen(true);\n  }, []);\n\n  const handleTriggerFlowClose = useCallback(() => {\n    console.log(\"ðŸšª Fechando modal\");\n\n    setFlowProcessing(false);\n    flowProcessingRef.current = false;\n    setTriggerFlowModalOpen(false);\n  }, []);\n\n  const handleFlowProcessing = useCallback((isProcessing) => {\n    console.log(\"ðŸ”„ Flow processing:\", isProcessing);\n    setFlowProcessing(isProcessing);\n    flowProcessingRef.current = isProcessing;\n\n    // ðŸ”¥ TIMEOUT SIMPLES: 8 segundos e libera SEM PERGUNTAR\n    if (isProcessing) {\n      setTimeout(() => {\n        console.log(\"â° TIMEOUT - Liberando campo FORÃ‡ADO\");\n        setFlowProcessing(false);\n        flowProcessingRef.current = false;\n      }, 8000);\n    }\n  }, []);\n\n  const handleFlowTriggered = useCallback((data) => {\n    console.log(\"âœ… Fluxo concluÃ­do\");\n\n    // ðŸ”¥ RESET IMEDIATO - SEM TIMEOUT\n    setFlowProcessing(false);\n    flowProcessingRef.current = false;\n  }, []);\n\n\n  // NAVEGAÃ‡ÃƒO POR TECLADO CORRIGIDA\n  const handleKeyDown = useCallback((e) => {\n    if (!typeBar || !Array.isArray(typeBar) || typeBar.length === 0) {\n      setSelectedQuickAnswerIndex(-1);\n      setIsNavigatingQuickAnswers(false);\n      return;\n    }\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        setIsNavigatingQuickAnswers(true);\n        setSelectedQuickAnswerIndex(prev => {\n          const nextIndex = prev < typeBar.length - 1 ? prev + 1 : 0;\n\n          // SCROLL AUTOMÃTICO CORRIGIDO\n          setTimeout(() => {\n            const container = document.querySelector('.MuiBox-root ul');\n            if (container) {\n              const selectedElement = container.children[nextIndex];\n              if (selectedElement) {\n                selectedElement.scrollIntoView({\n                  behavior: 'smooth',\n                  block: 'nearest'\n                });\n              }\n            }\n          }, 0);\n\n          return nextIndex;\n        });\n        break;\n\n      case 'ArrowUp':\n        e.preventDefault();\n        setIsNavigatingQuickAnswers(true);\n        setSelectedQuickAnswerIndex(prev => {\n          const nextIndex = prev > 0 ? prev - 1 : typeBar.length - 1;\n\n          // SCROLL AUTOMÃTICO CORRIGIDO\n          setTimeout(() => {\n            const container = document.querySelector('.MuiBox-root ul');\n            if (container) {\n              const selectedElement = container.children[nextIndex];\n              if (selectedElement) {\n                selectedElement.scrollIntoView({\n                  behavior: 'smooth',\n                  block: 'nearest'\n                });\n              }\n            }\n          }, 0);\n\n          return nextIndex;\n        });\n        break;\n\n      case 'Enter':\n        if (isNavigatingQuickAnswers && selectedQuickAnswerIndex >= 0) {\n          e.preventDefault();\n          const selectedAnswer = typeBar[selectedQuickAnswerIndex];\n          handleQuickAnswersClick(selectedAnswer);\n          setSelectedQuickAnswerIndex(-1);\n          setIsNavigatingQuickAnswers(false);\n        }\n        break;\n\n      case 'Escape':\n        if (isNavigatingQuickAnswers) {\n          e.preventDefault();\n          setSelectedQuickAnswerIndex(-1);\n          setIsNavigatingQuickAnswers(false);\n          setTypeBar(false);\n        }\n        break;\n\n      case 'Tab':\n        if (isNavigatingQuickAnswers) {\n          e.preventDefault();\n          setSelectedQuickAnswerIndex(prev => {\n            const nextIndex = prev < typeBar.length - 1 ? prev + 1 : 0;\n            return nextIndex;\n          });\n        }\n        break;\n\n      default:\n        if (isNavigatingQuickAnswers && e.key.length === 1) {\n          setSelectedQuickAnswerIndex(-1);\n          setIsNavigatingQuickAnswers(false);\n        }\n        break;\n    }\n  }, [typeBar, selectedQuickAnswerIndex, isNavigatingQuickAnswers]);\n\n  useEffect(() => {\n    if (!typeBar || !Array.isArray(typeBar) || typeBar.length === 0) {\n      setSelectedQuickAnswerIndex(-1);\n      setIsNavigatingQuickAnswers(false);\n    }\n  }, [typeBar]);\n\n  const getQuickAnswerItemStyle = (index) => ({\n    backgroundColor: selectedQuickAnswerIndex === index\n      ? (theme.mode === 'light' ? '#e3f2fd' : '#1e3a5f')\n      : 'transparent',\n    borderLeft: selectedQuickAnswerIndex === index\n      ? `4px solid ${theme.palette.primary.main}`\n      : '4px solid transparent',\n  });\n\n  const handleSendLinkVideo = async () => {\n    const link = `https://meet.jit.si/${ticketId}`;\n    setInputMessage(link);\n  };\n\n  const handleSendTemplate = async () => {\n    setTemplateModalOpen(true);\n  };\n\n  const handleChangeInput = useCallback((e) => {\n    setInputMessage(e.target.value);\n  }, []);\n\n  const handlePrivateMessage = (e) => {\n    if (isTicketPending()) {\n      return;\n    }\n    setPrivateMessage(!privateMessage);\n    setPrivateMessageInputVisible(!privateMessageInputVisible);\n  };\n\n  const getMediaTypeIcon = (mediaType) => {\n    switch (mediaType) {\n      case 'audio': return 'ðŸŽµ';\n      case 'image': return 'ðŸ–¼ï¸';\n      case 'video': return 'ðŸŽ¥';\n      case 'document': return 'ðŸ“Ž';\n      default: return 'ðŸ“Ž';\n    }\n  };\n\n  const getMediaTypeColor = (mediaType) => {\n    switch (mediaType) {\n      case 'audio': return 'secondary';\n      case 'image': return 'primary';\n      case 'video': return 'default';\n      case 'document': return 'default';\n      default: return 'default';\n    }\n  };\n\n  const handleQuickAnswersClick = useCallback(async (value) => {\n    // âœ… IMPORTANTE: Evitar mÃºltiplas execuÃ§Ãµes simultÃ¢neas\n    if (loading) {\n      console.log(\"âš ï¸ JÃ¡ processando, ignorando clique...\");\n      return;\n    }\n\n    console.log(\"ðŸŽ¯ handleQuickAnswersClick chamado:\", value);\n    console.log(\"ðŸ“‹ ticketId atual:\", ticketId);\n\n    if (!ticketId) {\n      console.error(\"âŒ ticketId nÃ£o encontrado\");\n      toastError(\"Erro: ID do ticket nÃ£o encontrado\");\n      return;\n    }\n\n    if (value.mediaPath) {\n      try {\n        setLoading(true);\n        console.log(\"ðŸ“¥ Baixando mÃ­dia:\", value.mediaPath);\n\n        const response = await api.get(value.mediaPath, {\n          responseType: \"blob\",\n        });\n\n        console.log(\"âœ… MÃ­dia baixada com sucesso, tamanho:\", response.data.size);\n\n        const messageBody = value.value && value.value.trim() !== \"\" ? value.value : \"\";\n\n        await handleUploadQuickMessageMedia(response.data, messageBody, value.mediaType);\n\n        console.log(\"âœ… MÃ­dia enviada com sucesso\");\n\n        setInputMessage(\"\");\n        setTypeBar(false);\n        return;\n      } catch (err) {\n        console.error(\"âŒ Erro ao processar mÃ­dia:\", err);\n        toastError(err);\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      // Para mensagens de texto\n      setInputMessage(value.value || \"\");\n      setTypeBar(false);\n    }\n  }, [loading, ticketId, privateMessage]);\n\n  const handleUploadQuickMessageMedia = useCallback(async (blob, message, mediaType = null) => {\n    console.log(\"ðŸ“¤ Iniciando upload de mÃ­dia:\", {\n      blobSize: blob.size,\n      message,\n      mediaType,\n      ticketId\n    });\n\n    if (!ticketId) {\n      throw new Error(\"ID do ticket nÃ£o encontrado\");\n    }\n\n    // âœ… IMPORTANTE: Verificar se jÃ¡ estÃ¡ enviando\n    if (loading) {\n      console.log(\"âš ï¸ Upload jÃ¡ em andamento, ignorando...\");\n      return;\n    }\n\n    try {\n      let extension = 'bin';\n\n      if (blob.type) {\n        const mimeType = blob.type.split(\"/\")[1];\n        extension = mimeType;\n\n        if (blob.type.includes('webm') || blob.type.includes('audio')) {\n          extension = blob.type.includes('webm') ? 'webm' : 'mp3';\n        }\n      } else if (mediaType) {\n        const typeExtensionMap = {\n          'audio': 'webm',\n          'image': 'jpg',\n          'video': 'mp4',\n          'document': 'pdf'\n        };\n        extension = typeExtensionMap[mediaType] || 'bin';\n      }\n\n      const formData = new FormData();\n      const filename = `${new Date().getTime()}.${extension}`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"typeArch\", \"quickMessage\");\n\n      const body = message && message.trim() !== \"\"\n        ? ((privateMessage || isTicketPending()) ? `\\u200d${message}` : message)\n        : ((privateMessage || isTicketPending()) ? `\\u200d` : \"\");\n\n      formData.append(\"body\", body);\n      formData.append(\"fromMe\", true);\n      formData.append(\"isPrivate\", (privateMessage || isTicketPending()) ? \"true\" : \"false\");\n\n      console.log(\"ðŸ“¤ Enviando para:\", `/messages/${ticketId}`);\n\n      if (isMounted.current) {\n        const response = await api.post(`/messages/${ticketId}`, formData);\n        console.log(\"âœ… Upload realizado com sucesso:\", response.status);\n      }\n    } catch (err) {\n      console.error(\"âŒ Erro no upload:\", err);\n      toastError(err);\n      throw err;\n    }\n  }, [ticketId, privateMessage, loading]);\n\n  const handleAddEmoji = (e) => {\n    let emoji = e.native;\n    setInputMessage((prevState) => prevState + emoji);\n  };\n\n  const [modalCameraOpen, setModalCameraOpen] = useState(false);\n\n  const handleCapture = (imageData) => {\n    if (imageData) {\n      handleUploadCamera(imageData);\n    }\n  };\n\n  const handleChangeMedias = (e) => {\n    if (!e.target.files) {\n      return;\n    }\n    const selectedMedias = Array.from(e.target.files);\n    setMediasUpload(selectedMedias);\n    setShowModalMedias(true);\n  };\n\n  const handleChangeSign = (e) => {\n    getStatusSingMessageLocalstogare();\n  };\n\n  const handleOpenModalForward = () => {\n    if (selectedMessages.length === 0) {\n      setForwardMessageModalOpen(false);\n      toastError(i18n.t(\"messagesList.header.notMessage\"));\n      return;\n    }\n    setForwardMessageModalOpen(true);\n  };\n\n  const getStatusSingMessageLocalstogare = () => {\n    const signMessageStorage = JSON.parse(\n      localStorage.getItem(\"persistentSignMessage\")\n    );\n    if (signMessageStorage !== null) {\n      if (signMessageStorage) {\n        localStorage.setItem(\"persistentSignMessage\", false);\n        setSignMessage(false);\n      } else {\n        localStorage.setItem(\"persistentSignMessage\", true);\n        setSignMessage(true);\n      }\n    } else {\n      localStorage.setItem(\"persistentSignMessage\", false);\n      setSignMessage(false);\n    }\n  };\n\n  const handleInputPaste = (e) => {\n    if (e.clipboardData.files[0]) {\n      const selectedMedias = Array.from(e.clipboardData.files);\n      setMediasUpload(selectedMedias);\n      setShowModalMedias(true);\n    }\n  };\n\n  const handleInputDrop = (e) => {\n    e.preventDefault();\n    if (e.dataTransfer.files[0]) {\n      const selectedMedias = Array.from(e.dataTransfer.files);\n      setMediasUpload(selectedMedias);\n      setShowModalMedias(true);\n    }\n  };\n\n  const handleUploadMedia = async (mediasUpload) => {\n    setLoading(true);\n\n    if (!mediasUpload.length) {\n      console.log(\"Nenhuma mÃ­dia selecionada.\");\n      setLoading(false);\n      return;\n    }\n\n    const formData = new FormData();\n    formData.append(\"fromMe\", true);\n    formData.append(\"isPrivate\", (privateMessage || isTicketPending()) ? \"true\" : \"false\");\n    mediasUpload.forEach((media) => {\n      formData.append(\"body\", media.caption);\n      formData.append(\"medias\", media.file);\n    });\n\n    try {\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setLoading(false);\n    setMediasUpload([]);\n    setShowModalMedias(false);\n    if (!isTicketPending()) {\n      setPrivateMessage(false);\n      setPrivateMessageInputVisible(false);\n    }\n  };\n\n  const handleSendContatcMessage = async (vcard) => {\n    setSenVcardModalOpen(false);\n    setLoading(true);\n\n    if (isNil(vcard)) {\n      setLoading(false);\n      return;\n    }\n\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body: null,\n      quotedMsg: replyingMessage,\n      isPrivate: (privateMessage || isTicketPending()) ? \"true\" : \"false\",\n      vCard: vcard,\n    };\n    try {\n      await api.post(`/messages/${ticketId}`, message);\n    } catch (err) {\n      toastError(err);\n    }\n\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n    setEditingMessage(null);\n    if (!isTicketPending()) {\n      setPrivateMessage(false);\n      setPrivateMessageInputVisible(false);\n    }\n  };\n\n  const handleSendMessage = async () => {\n    if (!inputMessage || inputMessage.trim() === \"\") return;\n    setLoading(true);\n\n    const userName = (privateMessage || isTicketPending())\n      ? `${user.name} - Mensagem Interna`\n      : user.name;\n\n    const sendMessage = inputMessage.trim();\n\n    const message = {\n      read: 1,\n      fromMe: true,\n      mediaUrl: \"\",\n      body:\n        ((signMessage && !isTicketPending()) || privateMessage || isTicketPending()) && !editingMessage\n          ? `*${userName}:*\\n${sendMessage}`\n          : sendMessage,\n      quotedMsg: replyingMessage,\n      isPrivate: (privateMessage || isTicketPending()) ? \"true\" : \"false\",\n    };\n\n    try {\n      if (editingMessage !== null) {\n        await api.post(`/messages/edit/${editingMessage.id}`, message);\n      } else {\n        console.log(\"ENVIOU PARA TIKCET\", ticketId);\n        await api.post(`/messages/${ticketId}`, message);\n      }\n    } catch (err) {\n      toastError(err);\n    }\n\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setLoading(false);\n    setReplyingMessage(null);\n    if (!isTicketPending()) {\n      setPrivateMessage(false);\n    }\n    setEditingMessage(null);\n    if (!isTicketPending()) {\n      setPrivateMessageInputVisible(false);\n    }\n    handleMenuItemClick();\n  };\n\n  const handleSendMessageTemplate = async (e) => {\n    if (e.id === \"\") return;\n    setLoading(true);\n\n    const message = {\n      templateId: e.id,\n      variables: e.variables,\n      bodyToSave: e.bodyToSave,\n      mediaUrl: \"\",\n      quotedMsg: replyingMessage,\n    };\n\n    try {\n      await api.post(`/messages-template/${ticketId}`, message);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n    setTemplateModalOpen(false);\n    setInputMessage(\"\");\n    setShowEmoji(false);\n    setReplyingMessage(null);\n    if (!isTicketPending()) {\n      setPrivateMessage(false);\n    }\n    setEditingMessage(null);\n    if (!isTicketPending()) {\n      setPrivateMessageInputVisible(false);\n    }\n    handleMenuItemClick();\n  };\n\n  const handleStartRecording = async () => {\n    setLoading(true);\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n      await Mp3Recorder.start();\n      setRecording(true);\n      setLoading(false);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    async function fetchData() {\n      const companyId = user.companyId;\n      const messages = await listQuickMessages({\n        companyId,\n        userId: user.id,\n        isOficial: ticketChannel === \"whatsapp_oficial\" ? \"true\" : \"false\",\n      });\n      const options = messages.map((m) => {\n        let truncatedMessage = m.message;\n        if (isString(truncatedMessage) && truncatedMessage.length > 90) {\n          truncatedMessage = m.message.substring(0, 90) + \"...\";\n        }\n        return {\n          value: m.message,\n          label: `/${m.shortcode} - ${truncatedMessage}`,\n          mediaPath: m.mediaPath,\n          mediaType: m.mediaType,\n          shortcode: m.shortcode,\n        };\n      });\n      if (isMounted.current) {\n        setQuickAnswer(options);\n      }\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    if (\n      isString(inputMessage) &&\n      !isEmpty(inputMessage) &&\n      inputMessage.length >= 1\n    ) {\n      const firstWord = inputMessage.charAt(0);\n\n      if (firstWord === \"/\") {\n        setTypeBar(firstWord.indexOf(\"/\") > -1);\n\n        const filteredOptions = quickAnswers.filter(\n          (m) => m.label.toLowerCase().indexOf(inputMessage.toLowerCase()) > -1\n        );\n        setTypeBar(filteredOptions);\n      } else {\n        setTypeBar(false);\n      }\n    } else {\n      setTypeBar(false);\n    }\n  }, [inputMessage]);\n\n  useEffect(() => {\n    console.log(\"ðŸ” Modal state:\", triggerFlowModalOpen, \"Flow processing:\", flowProcessing);\n\n    // ðŸ”¥ RESET SIMPLES: Se modal fecha, libera campo\n    if (!triggerFlowModalOpen && flowProcessing) {\n      console.log(\"ðŸ”“ FORÃ‡ANDO liberaÃ§Ã£o do campo\");\n      setFlowProcessing(false);\n      flowProcessingRef.current = false;\n    }\n  }, [triggerFlowModalOpen, flowProcessing]);\n\n  const disableOption = useCallback(() => {\n    const isFlowProcessing = flowProcessingRef.current || flowProcessing;\n\n    return (\n      loading ||\n      recording ||\n      isFlowProcessing || // ðŸ›¡ï¸ Usar tanto ref quanto estado\n      (!isTicketPending() && ticketStatus !== \"open\" && ticketStatus !== \"group\")\n    );\n  }, [loading, recording, flowProcessing, ticketStatus]);\n\n  const disableOptionForPending = useCallback(() => {\n    const isFlowProcessing = flowProcessingRef.current || flowProcessing;\n\n    return (\n      loading ||\n      recording ||\n      isFlowProcessing || // ðŸ›¡ï¸ Usar tanto ref quanto estado\n      ticketStatus === \"closed\"\n    );\n  }, [loading, recording, flowProcessing, ticketStatus]);\n\n  const handleUploadCamera = async (blob) => {\n    setLoading(true);\n    try {\n      const formData = new FormData();\n      const filename = `${new Date().getTime()}.png`;\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", (privateMessage || isTicketPending()) ? `\\u200d` : \"\");\n      formData.append(\"fromMe\", true);\n\n      await api.post(`/messages/${ticketId}`, formData);\n    } catch (err) {\n      toastError(err);\n      setLoading(false);\n    }\n    setLoading(false);\n  };\n\n  // âœ… CORREÃ‡ÃƒO KISS: Apenas otimizar nome do arquivo para mobile\n  const handleUploadAudio = async () => {\n    setLoading(true);\n    try {\n      const [, blob] = await Mp3Recorder.stop().getMp3();\n      if (blob.size < 10000) {\n        setLoading(false);\n        setRecording(false);\n        return;\n      }\n\n      const formData = new FormData();\n\n      // âœ… CORREÃ‡ÃƒO: Nome do arquivo otimizado para mobile\n      let filename;\n      if ([\"whatsapp\", \"whatsapp_oficial\"].includes(ticketChannel)) {\n        // Para WhatsApp, usar formato mais compatÃ­vel com mobile\n        filename = isMobileDevice()\n          ? `audio_${new Date().getTime()}.ogg`  // OGG para mobile\n          : `audio_${new Date().getTime()}.mp3`; // MP3 para desktop\n      } else {\n        filename = `${new Date().getTime()}.m4a`;\n      }\n\n      formData.append(\"medias\", blob, filename);\n      formData.append(\"body\", \"ðŸŽµ Mensagem de voz\"); // âœ… Body mais claro\n      formData.append(\"fromMe\", true);\n      formData.append(\"isPrivate\", (privateMessage || isTicketPending()) ? \"true\" : \"false\");\n\n      console.log(`ðŸ“¤ Enviando Ã¡udio: ${filename} (${blob.size} bytes)`);\n\n      if (isMounted.current) {\n        await api.post(`/messages/${ticketId}`, formData);\n      }\n    } catch (err) {\n      toastError(err);\n    } finally {\n      if (isMounted.current) {\n        setLoading(false);\n        setRecording(false);\n      }\n    }\n  };\n\n  const handleCloseModalMedias = () => {\n    setShowModalMedias(false);\n  };\n\n  const handleCancelAudio = async () => {\n    try {\n      await Mp3Recorder.stop().getMp3();\n      setRecording(false);\n    } catch (err) {\n      toastError(err);\n    }\n  };\n\n  const handleOpenMenuClick = (event) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleMenuItemClick = (event) => {\n    setAnchorEl(null);\n  };\n\n  const handleSendContactModalOpen = async () => {\n    handleMenuItemClick();\n    setSenVcardModalOpen(true);\n  };\n\n  const handleCameraModalOpen = async () => {\n    handleMenuItemClick();\n    setModalCameraOpen(true);\n  };\n\n  const handleCancelSelection = () => {\n    setMediasUpload([]);\n    setShowModalMedias(false);\n  };\n\n  const checkForSelectedText = useCallback(() => {\n    if (inputRef.current) {\n      const start = inputRef.current.selectionStart;\n      const end = inputRef.current.selectionEnd;\n\n      if (start !== end && start !== null && end !== null) {\n        const selectedText = inputMessage.substring(start, end);\n        if (selectedText.trim() !== '') {\n          // Para InputBase, calcular posiÃ§Ã£o baseada no elemento\n          const inputRect = inputRef.current.getBoundingClientRect();\n          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n          setSelectedText({\n            text: selectedText,\n            start: start,\n            end: end\n          });\n\n          setFormatMenuAnchorPosition({\n            x: inputRect.left + inputRect.width / 2,\n            y: inputRect.top + scrollTop - 10 // Posicionar acima do input\n          });\n\n          return true;\n        }\n      }\n    }\n\n    setFormatMenuAnchorPosition(null);\n    return false;\n  }, [inputMessage]);\n\n  const handleCloseFormatMenu = useCallback(() => {\n    setFormatMenuAnchorPosition(null);\n  }, []);\n\n  // Aplica a formataÃ§Ã£o ao texto selecionado\n  const handleFormatText = useCallback((formatType) => {\n    const { text, start, end } = selectedText;\n    let formattedText = '';\n\n    switch (formatType) {\n      case 'bold':\n        formattedText = `*${text}*`;\n        break;\n      case 'italic':\n        formattedText = `_${text}_`;\n        break;\n      case 'strikethrough':\n        formattedText = `~${text}~`;\n        break;\n      case 'code':\n        formattedText = `\\`${text}\\``;\n        break;\n      case 'numberedList':\n        formattedText = text.split('\\n')\n          .map((line, index) => `${index + 1}. ${line}`)\n          .join('\\n');\n        break;\n      case 'bulletList':\n        formattedText = text.split('\\n')\n          .map(line => `â€¢ ${line}`)\n          .join('\\n');\n        break;\n      case 'quote':\n        formattedText = text.split('\\n')\n          .map(line => `> ${line}`)\n          .join('\\n');\n        break;\n      case 'clear':\n        formattedText = text\n          .replace(/\\*([^*]+)\\*/g, '$1')  // remove negrito\n          .replace(/_([^_]+)_/g, '$1')    // remove itÃ¡lico\n          .replace(/~([^~]+)~/g, '$1')    // remove tachado\n          .replace(/`([^`]+)`/g, '$1')    // remove cÃ³digo\n          .replace(/^\\d+\\.\\s/gm, '')      // remove numeraÃ§Ã£o de lista\n          .replace(/^â€¢\\s/gm, '')          // remove marcadores de lista\n          .replace(/^>\\s/gm, '');         // remove citaÃ§Ã£o\n        break;\n      default:\n        formattedText = text;\n    }\n\n    // Substitui o texto selecionado pelo texto formatado\n    const newInputMessage =\n      inputMessage.substring(0, start) +\n      formattedText +\n      inputMessage.substring(end);\n\n    setInputMessage(newInputMessage);\n\n    // Fecha o menu apÃ³s a formataÃ§Ã£o\n    handleCloseFormatMenu();\n\n    // Define o foco e a posiÃ§Ã£o do cursor apÃ³s a operaÃ§Ã£o\n    setTimeout(() => {\n      if (inputRef.current) {\n        inputRef.current.focus();\n        const newCursorPosition = start + formattedText.length;\n        inputRef.current.selectionStart = newCursorPosition;\n        inputRef.current.selectionEnd = newCursorPosition;\n      }\n    }, 100);\n  }, [selectedText, inputMessage, handleCloseFormatMenu]);\n\n  // Handlers para detectar seleÃ§Ã£o de texto\n  const handleSelectText = useCallback(() => {\n    checkForSelectedText();\n  }, [checkForSelectedText]);\n\n  const handleMouseUp = useCallback(() => {\n    checkForSelectedText();\n  }, [checkForSelectedText]);\n\n  const handleKeyUp = useCallback((e) => {\n    // Teclas que podem alterar a seleÃ§Ã£o\n    if (e.key === 'ArrowLeft' || e.key === 'ArrowRight' || e.key === 'Shift') {\n      checkForSelectedText();\n    }\n  }, [checkForSelectedText]);\n\n  const renderReplyingMessage = (message) => {\n    return (\n      <div className={classes.replyginMsgWrapper}>\n        <div className={classes.replyginMsgContainer}>\n          <span\n            className={clsx(classes.replyginContactMsgSideColor, {\n              [classes.replyginSelfMsgSideColor]: !message.fromMe,\n            })}\n          ></span>\n          {replyingMessage && (\n            <div className={classes.replyginMsgBody}>\n              {!message.fromMe && (\n                <span className={classes.messageContactName}>\n                  {message.contact?.name}\n                </span>\n              )}\n              {message.body}\n            </div>\n          )}\n        </div>\n        <IconButton\n          aria-label=\"showRecorder\"\n          component=\"span\"\n          disabled={disableOptionForPending()}\n          onClick={() => {\n            setReplyingMessage(null);\n            setEditingMessage(null);\n            setInputMessage(\"\");\n          }}\n        >\n          <Clear className={classes.sendMessageIcons} />\n        </IconButton>\n      </div>\n    );\n  };\n\n  const renderFlowProcessingAlert = () => {\n    if (!flowProcessing) return null;\n\n    return (\n      <Box className={classes.pendingAlert} style={{ backgroundColor: \"#E8F5E8\", borderColor: \"#4CAF50\" }}>\n        <CircularProgress size={16} style={{ marginRight: 8 }} />\n        <span>\n          <strong>Fluxo em ExecuÃ§Ã£o:</strong> Campo de mensagem temporariamente desabilitado.\n        </span>\n      </Box>\n    );\n  };\n\n  const TextFormatMenu = () => {\n    const isMenuOpen = Boolean(formatMenuAnchorPosition);\n    const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n\n    if (!isMenuOpen) return null;\n\n    return (\n      <ClickAwayListener onClickAway={handleCloseFormatMenu}>\n        <Fade in={isMenuOpen}>\n          <div\n            className={classes.floatingFormatMenu}\n            style={{\n              top: formatMenuAnchorPosition ? formatMenuAnchorPosition.y - 50 : 0,\n              left: formatMenuAnchorPosition ? formatMenuAnchorPosition.x : 0,\n            }}\n          >\n            <Tooltip title=\"Negrito\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('bold')}\n                size=\"small\"\n              >\n                <FormatBoldIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"ItÃ¡lico\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('italic')}\n                size=\"small\"\n              >\n                <FormatItalicIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"Tachado\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('strikethrough')}\n                size=\"small\"\n              >\n                <FormatStrikethroughIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"CÃ³digo\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('code')}\n                size=\"small\"\n              >\n                <CodeIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"Lista Numerada\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('numberedList')}\n                size=\"small\"\n              >\n                <FormatListNumberedIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"Lista com Marcadores\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('bulletList')}\n                size=\"small\"\n              >\n                <FormatListBulletedIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"CitaÃ§Ã£o\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('quote')}\n                size=\"small\"\n              >\n                <FormatQuoteIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n\n            <Tooltip title=\"Limpar FormataÃ§Ã£o\">\n              <IconButton\n                className={classes.formatIconButton}\n                disabled={disableOptionForPending()}\n                onClick={() => handleFormatText('clear')}\n                size=\"small\"\n              >\n                <FormatClearIcon fontSize={isMobile ? \"small\" : \"medium\"} />\n              </IconButton>\n            </Tooltip>\n          </div>\n        </Fade>\n      </ClickAwayListener>\n    );\n  };\n\n  const renderPendingAlert = () => {\n    if (!isTicketPending()) return null;\n\n    return (\n      <Box className={classes.pendingAlert}>\n        <Info style={{ fontSize: 20 }} />\n        <span>\n          <strong>Ticket Aguardando:</strong> Apenas mensagens internas sÃ£o permitidas neste momento.\n        </span>\n      </Box>\n    );\n  };\n\n  if (mediasUpload.length > 0) {\n    return (\n      <Paper\n        elevation={0}\n        square\n        className={classes.viewMediaInputWrapper}\n        onDragEnter={() => setOnDragEnter(true)}\n        onDrop={(e) => handleInputDrop(e)}\n      >\n        {showModalMedias && (\n          <MessageUploadMedias\n            isOpen={showModalMedias}\n            files={mediasUpload}\n            onClose={handleCloseModalMedias}\n            onSend={handleUploadMedia}\n            onCancelSelection={handleCancelSelection}\n          />\n        )}\n      </Paper>\n    );\n  } else {\n    return (\n      <>\n        {templateModalOpen && (\n          <TemplateModal\n            open={templateModalOpen}\n            handleClose={() => setTemplateModalOpen(false)}\n            onSelectTemplate={(e) => handleSendMessageTemplate(e)}\n            templates={templates}\n          />\n        )}\n        {modalCameraOpen && (\n          <CameraModal\n            isOpen={modalCameraOpen}\n            onRequestClose={() => setModalCameraOpen(false)}\n            onCapture={handleCapture}\n          />\n        )}\n        {senVcardModalOpen && (\n          <ContactSendModal\n            modalOpen={senVcardModalOpen}\n            onClose={(c) => {\n              handleSendContatcMessage(c);\n            }}\n          />\n        )}\n\n        {/* NOVO MODAL DE TRIGGER FLOW */}\n        {triggerFlowModalOpen && (\n          <TriggerFlowModal\n            open={triggerFlowModalOpen}\n            onClose={handleTriggerFlowClose}\n            ticketId={ticketId}\n            ticketStatus={ticketStatus}\n            onFlowTriggered={handleFlowTriggered}\n            onFlowProcessing={handleFlowProcessing}\n          />\n        )}\n\n        <Paper\n          square\n          elevation={0}\n          className={classes.mainWrapper}\n          onDragEnter={() => setOnDragEnter(true)}\n          onDrop={(e) => handleInputDrop(e)}\n        >\n          {renderPendingAlert()}\n          {renderFlowProcessingAlert()}\n\n          {(replyingMessage && renderReplyingMessage(replyingMessage)) ||\n            (editingMessage && renderReplyingMessage(editingMessage))}\n          <div className={classes.newMessageBox}>\n            {!isTicketPending() && (\n              <Hidden only={[\"sm\", \"xs\"]}>\n                <IconButton\n                  aria-label=\"emojiPicker\"\n                  component=\"span\"\n                  disabled={disableOption()}\n                  onClick={(e) => setShowEmoji((prevState) => !prevState)}\n                >\n                  <Mood className={classes.sendMessageIcons} />\n                </IconButton>\n                {showEmoji ? (\n                  <div className={classes.emojiBox}>\n                    <ClickAwayListener onClickAway={(e) => setShowEmoji(true)}>\n                      <Picker\n                        perLine={16}\n                        theme={\"dark\"}\n                        i18n={i18n}\n                        showPreview={true}\n                        showSkinTones={false}\n                        onSelect={handleAddEmoji}\n                      />\n                    </ClickAwayListener>\n                  </div>\n                ) : null}\n\n                <Fab\n                  disabled={disableOption()}\n                  aria-label=\"uploadMedias\"\n                  component=\"span\"\n                  className={classes.invertedFabMenu}\n                  onClick={handleOpenMenuClick}\n                >\n                  <AddIcon />\n                </Fab>\n                <Menu\n                  anchorEl={anchorEl}\n                  keepMounted\n                  open={Boolean(anchorEl)}\n                  onClose={handleMenuItemClick}\n                  id=\"simple-menu\"\n                >\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <input\n                      multiple\n                      type=\"file\"\n                      id=\"upload-img-button\"\n                      accept=\"image/*, video/*, audio/* \"\n                      className={classes.uploadInput}\n                      onChange={handleChangeMedias}\n                    />\n                    <label htmlFor=\"upload-img-button\">\n                      <Fab\n                        aria-label=\"upload-img\"\n                        component=\"span\"\n                        className={classes.invertedFabMenuMP}\n                      >\n                        <PermMedia />\n                      </Fab>\n                      {i18n.t(\"messageInput.type.imageVideo\")}\n                    </label>\n                  </MenuItem>\n                  <MenuItem onClick={handleCameraModalOpen}>\n                    <Fab className={classes.invertedFabMenuCamera}>\n                      <CameraAlt />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.cam\")}\n                  </MenuItem>\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <input\n                      multiple\n                      type=\"file\"\n                      id=\"upload-doc-button\"\n                      accept=\"application/*, text/*, .odt, .ods, .odp, .odg, .xml, .ofx, .zip, .rar, .7z, .tar, .gz, .bz2, .msg, .key, .numbers, .pages\"\n                      className={classes.uploadInput}\n                      onChange={handleChangeMedias}\n                    />\n                    <label htmlFor=\"upload-doc-button\">\n                      <Fab\n                        aria-label=\"upload-img\"\n                        component=\"span\"\n                        className={classes.invertedFabMenuDoc}\n                      >\n                        <Description />\n                      </Fab>\n                      Documento\n                    </label>\n                  </MenuItem>\n                  <MenuItem onClick={handleSendContactModalOpen}>\n                    <Fab className={classes.invertedFabMenuCont}>\n                      <Person />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.contact\")}\n                  </MenuItem>\n                  <MenuItem onClick={handleSendLinkVideo}>\n                    <Fab className={classes.invertedFabMenuMeet}>\n                      <Duo />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.meet\")}\n                  </MenuItem>\n                  {useWhatsappOfficial &&\n                    ticketChannel === \"whatsapp_oficial\" && (\n                      <MenuItem onClick={handleSendTemplate}>\n                        <Fab className={classes.invertedFabMenuMeet}>\n                          <WhatsApp />\n                        </Fab>\n                        {i18n.t(\"messageInput.type.template\")}\n                      </MenuItem>\n                    )}\n                </Menu>\n\n                {signMessagePar && (\n                  <Tooltip title={i18n.t(\"messageInput.tooltip.signature\")}>\n                    <IconButton\n                      aria-label=\"send-upload\"\n                      component=\"span\"\n                      onClick={handleChangeSign}\n                    >\n                      {signMessage === true ? (\n                        <Create\n                          style={{\n                            color:\n                              theme.mode === \"light\"\n                                ? theme.palette.primary.main\n                                : \"#EEE\",\n                          }}\n                        />\n                      ) : (\n                        <Create style={{ color: \"grey\" }} />\n                      )}\n                    </IconButton>\n                  </Tooltip>\n                )}\n\n                {/* NOVO ÃCONE DE TRIGGER FLOW - APENAS EM TICKETS OPEN */}\n                {ticketStatus === \"open\" && (\n                  <Tooltip title=\"Disparar Fluxo\">\n                    <IconButton\n                      aria-label=\"trigger-flow\"\n                      component=\"span\"\n                      onClick={handleTriggerFlowClick}\n                      disabled={disableOption()}\n                    >\n                      <AccountTree\n                        style={{\n                          color: theme.mode === \"light\"\n                            ? theme.palette.secondary.main\n                            : \"#EEE\"\n                        }}\n                      />\n                    </IconButton>\n                  </Tooltip>\n                )}\n\n                {!isTicketPending() && (\n                  <Tooltip title={i18n.t(\"messageInput.tooltip.privateMessage\")}>\n                    <IconButton\n                      aria-label=\"send-upload\"\n                      component=\"span\"\n                      onClick={handlePrivateMessage}\n                    >\n                      {privateMessage === true ? (\n                        <Comment\n                          style={{\n                            color:\n                              theme.mode === \"light\"\n                                ? theme.palette.primary.main\n                                : \"#EEE\",\n                          }}\n                        />\n                      ) : (\n                        <Comment style={{ color: \"grey\" }} />\n                      )}\n                    </IconButton>\n                  </Tooltip>\n                )}\n              </Hidden>\n            )}\n\n            {isTicketPending() && (\n              <Hidden only={[\"md\", \"lg\", \"xl\"]}>\n                <IconButton\n                  aria-controls=\"simple-menu\"\n                  aria-haspopup=\"true\"\n                  onClick={handleOpenMenuClick}\n                >\n                  <MoreVert></MoreVert>\n                </IconButton>\n                <Menu\n                  id=\"simple-menu\"\n                  keepMounted\n                  anchorEl={anchorEl}\n                  open={Boolean(anchorEl)}\n                  onClose={handleMenuItemClick}\n                >\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <IconButton\n                      aria-label=\"emojiPicker\"\n                      component=\"span\"\n                      disabled={disableOptionForPending()}\n                      onClick={(e) => setShowEmoji((prevState) => !prevState)}\n                    >\n                      <Mood className={classes.sendMessageIcons} />\n                    </IconButton>\n                    Emoji\n                  </MenuItem>\n                </Menu>\n              </Hidden>\n            )}\n\n            {!isTicketPending() && (\n              <Hidden only={[\"md\", \"lg\", \"xl\"]}>\n                <IconButton\n                  aria-controls=\"simple-menu\"\n                  aria-haspopup=\"true\"\n                  onClick={handleOpenMenuClick}\n                >\n                  <MoreVert></MoreVert>\n                </IconButton>\n                <Menu\n                  id=\"simple-menu\"\n                  keepMounted\n                  anchorEl={anchorEl}\n                  open={Boolean(anchorEl)}\n                  onClose={handleMenuItemClick}\n                >\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <IconButton\n                      aria-label=\"emojiPicker\"\n                      component=\"span\"\n                      disabled={disableOption()}\n                      onClick={(e) => setShowEmoji((prevState) => !prevState)}\n                    >\n                      <Mood className={classes.sendMessageIcons} />\n                    </IconButton>\n                    Emoji\n                  </MenuItem>\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <input\n                      multiple\n                      type=\"file\"\n                      id=\"upload-img-button-mobile\"\n                      accept=\"image/*, video/*, audio/* \"\n                      disabled={disableOption()}\n                      className={classes.uploadInput}\n                      onChange={handleChangeMedias}\n                    />\n                    <label htmlFor=\"upload-img-button-mobile\">\n                      <Fab\n                        aria-label=\"upload-img\"\n                        component=\"span\"\n                        className={classes.invertedFabMenuMP}\n                        disabled={disableOption()}\n                      >\n                        <PermMedia />\n                      </Fab>\n                    </label>\n                    {i18n.t(\"messageInput.type.imageVideo\")}\n                  </MenuItem>\n                  <MenuItem onClick={handleCameraModalOpen}>\n                    <Fab className={classes.invertedFabMenuCamera} disabled={disableOption()}>\n                      <CameraAlt />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.cam\")}\n                  </MenuItem>\n                  <MenuItem onClick={handleMenuItemClick}>\n                    <input\n                      multiple\n                      type=\"file\"\n                      id=\"upload-doc-button-mobile\"\n                      accept=\"application/*, text/*, .odt, .ods, .odp, .odg, .xml, .ofx, .zip, .rar, .7z, .tar, .gz, .bz2, .msg, .key, .numbers, .pages\"\n                      disabled={disableOption()}\n                      className={classes.uploadInput}\n                      onChange={handleChangeMedias}\n                    />\n                    <label htmlFor=\"upload-doc-button-mobile\">\n                      <Fab\n                        aria-label=\"upload-img\"\n                        component=\"span\"\n                        className={classes.invertedFabMenuDoc}\n                        disabled={disableOption()}\n                      >\n                        <Description />\n                      </Fab>\n                    </label>\n                    Documento\n                  </MenuItem>\n                  <MenuItem onClick={handleSendContactModalOpen}>\n                    <Fab className={classes.invertedFabMenuCont} disabled={disableOption()}>\n                      <Person />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.contact\")}\n                  </MenuItem>\n                  <MenuItem onClick={handleSendLinkVideo}>\n                    <Fab className={classes.invertedFabMenuMeet} disabled={disableOption()}>\n                      <Duo />\n                    </Fab>\n                    {i18n.t(\"messageInput.type.meet\")}\n                  </MenuItem>\n                  {useWhatsappOfficial &&\n                    ticketChannel === \"whatsapp_oficial\" && (\n                      <MenuItem onClick={handleSendTemplate}>\n                        <Fab className={classes.invertedFabMenuMeet} disabled={disableOption()}>\n                          <WhatsApp />\n                        </Fab>\n                        {i18n.t(\"messageInput.type.template\")}\n                      </MenuItem>\n                    )}\n                  {signMessagePar && (\n                    <MenuItem onClick={handleChangeSign}>\n                      <Tooltip title=\"Habilitar/Desabilitar Assinatura\">\n                        <IconButton\n                          aria-label=\"send-upload\"\n                          component=\"span\"\n                        >\n                          {signMessage === true ? (\n                            <Create\n                              style={{\n                                color:\n                                  theme.mode === \"light\"\n                                    ? theme.palette.primary.main\n                                    : \"#EEE\",\n                              }}\n                            />\n                          ) : (\n                            <Create style={{ color: \"grey\" }} />\n                          )}\n                        </IconButton>\n                      </Tooltip>\n                      Assinatura\n                    </MenuItem>\n                  )}\n\n                  {/* NOVO ITEM DE MENU MOBILE PARA TRIGGER FLOW */}\n                  {ticketStatus === \"open\" && (\n                    <MenuItem onClick={() => {\n                      handleMenuItemClick();\n                      handleTriggerFlowClick();\n                    }}>\n                      <IconButton\n                        aria-label=\"trigger-flow\"\n                        component=\"span\"\n                      >\n                        <AccountTree\n                          style={{\n                            color: theme.mode === \"light\"\n                              ? theme.palette.secondary.main\n                              : \"#EEE\"\n                          }}\n                        />\n                      </IconButton>\n                      Disparar Fluxo\n                    </MenuItem>\n                  )}\n\n                  <MenuItem onClick={handlePrivateMessage}>\n                    <Tooltip title=\"Habilitar/Desabilitar ComentÃ¡rios\">\n                      <IconButton\n                        aria-label=\"send-upload\"\n                        component=\"span\"\n                      >\n                        {privateMessage === true ? (\n                          <Comment\n                            style={{\n                              color:\n                                theme.mode === \"light\"\n                                  ? theme.palette.primary.main\n                                  : \"#EEE\",\n                            }}\n                          />\n                        ) : (\n                          <Comment style={{ color: \"grey\" }} />\n                        )}\n                      </IconButton>\n                    </Tooltip>\n                    ComentÃ¡rios\n                  </MenuItem>\n                </Menu>\n              </Hidden>\n            )}\n\n            <div className={classes.flexContainer}>\n              {(privateMessageInputVisible || isTicketPending()) && (\n                <div className={classes.flexItem}>\n                  <div className={isTicketPending() ? classes.messageInputWrapperPending : classes.messageInputWrapperPrivate}>\n                    <InputBase\n                      inputRef={(input) => {\n                        input && input.focus();\n                        input && (inputRef.current = input);\n                      }}\n                      className={isTicketPending() ? classes.messageInputPending : classes.messageInputPrivate}\n                      placeholder={\n                        isTicketPending()\n                          ? \"Mensagem interna (ticket aguardando aceite)...\"\n                          : ticketStatus === \"open\" || ticketStatus === \"group\"\n                            ? i18n.t(\"messagesInput.placeholderPrivateMessage\")\n                            : i18n.t(\"messagesInput.placeholderClosed\")\n                      }\n                      multiline\n                      maxRows={5}\n                      value={safeCapitalizeFirstLetter(inputMessage)}\n                      onChange={handleChangeInput}\n                      disabled={disableOptionForPending()}\n                      onPaste={(e) => {\n                        (ticketStatus === \"open\" || ticketStatus === \"group\" || isTicketPending()) &&\n                          handleInputPaste(e);\n                      }}\n                      onKeyDown={handleKeyDown}\n                      onKeyUp={handleKeyUp}\n                      onMouseUp={handleMouseUp}\n                      onSelect={handleSelectText}\n                      onKeyPress={(e) => {\n                        if (loading || e.shiftKey) return;\n                        else if (e.key === \"Enter\" && !isNavigatingQuickAnswers) {\n                          handleSendMessage();\n                        }\n                      }}\n                      spellCheck={true}\n                    />\n                    {typeBar ? (\n                      <Box\n                        component=\"ul\"\n                        className={classes.messageQuickAnswersWrapper}\n                        style={{\n                          marginBottom: \"8px\" // âœ… Pequeno espaÃ§o entre input e lista\n                        }}\n                      >\n                        {typeBar.map((value, index) => {\n                          const isSelected = selectedQuickAnswerIndex === index;\n                          return (\n                            <li\n                              className={classes.messageQuickAnswersWrapperItem}\n                              key={index}\n                              style={{ listStyle: \"none\" }}\n                            >\n                              <div\n                                className={clsx(\n                                  classes.quickAnswerItem,\n                                  isSelected && classes.quickAnswerItemSelected\n                                )}\n                                style={{\n                                  ...getQuickAnswerItemStyle(index),\n                                  // âœ… Estilo adicional para item selecionado\n                                  ...(isSelected && {\n                                    backgroundColor: theme.palette.primary.light + \"20\",\n                                    borderLeft: `4px solid ${theme.palette.primary.main}`,\n                                    transform: \"translateX(2px)\" // âœ… Leve deslocamento visual\n                                  })\n                                }}\n                                onClick={() => handleQuickAnswersClick(value)}\n                              >\n                                <Box className={classes.quickAnswerText}>\n                                  {value.label}\n                                </Box>\n                                {value.mediaType && (\n                                  <Chip\n                                    size=\"small\"\n                                    label={`${getMediaTypeIcon(value.mediaType)} ${value.mediaType}`}\n                                    color={getMediaTypeColor(value.mediaType)}\n                                    className={classes.mediaTypeChip}\n                                  />\n                                )}\n                              </div>\n                            </li>\n                          );\n                        })}\n\n                        {/* âœ… Indicador de scroll apenas se necessÃ¡rio */}\n                        {typeBar.length > 4 && (\n                          <li style={{ listStyle: \"none\" }}>\n                            <div className={classes.quickAnswersScrollIndicator}>\n                              ðŸ“‹ {typeBar.length} respostas â€¢ use â†‘â†“ para navegar\n                            </div>\n                          </li>\n                        )}\n                      </Box>\n                    ) : null}\n                  </div>\n                </div>\n              )}\n              {!privateMessageInputVisible && !isTicketPending() && (\n                <div className={classes.flexItem}>\n                  <div className={classes.messageInputWrapper}>\n                    <InputBase\n                      inputRef={(input) => {\n                        input && input.focus();\n                        input && (inputRef.current = input);\n                      }}\n                      className={classes.messageInput}\n                      placeholder={placeholderText}\n                      multiline\n                      maxRows={5}\n                      value={safeCapitalizeFirstLetter(inputMessage)}\n                      onChange={handleChangeInput}\n                      disabled={disableOption()}\n                      onPaste={(e) => {\n                        (ticketStatus === \"open\" || ticketStatus === \"group\") &&\n                          handleInputPaste(e);\n                      }}\n                      onKeyDown={handleKeyDown}\n                      onKeyUp={handleKeyUp}\n                      onMouseUp={handleMouseUp}\n                      onSelect={handleSelectText}\n                      onKeyPress={(e) => {\n                        if (loading || e.shiftKey) return;\n                        else if (e.key === \"Enter\" && !isNavigatingQuickAnswers) {\n                          handleSendMessage();\n                        }\n                      }}\n                      spellCheck={true}\n                    />\n                    {typeBar ? (\n                      <ul className={classes.messageQuickAnswersWrapper}>\n                        {typeBar.map((value, index) => {\n                          const isSelected = selectedQuickAnswerIndex === index;\n                          return (\n                            <li\n                              className={classes.messageQuickAnswersWrapperItem}\n                              key={index}\n                            >\n                              <div\n                                className={`${classes.quickAnswerItem} ${isSelected ? 'selected' : ''}`}\n                                style={getQuickAnswerItemStyle(index)}\n                                onClick={() => handleQuickAnswersClick(value)}\n                              >\n                                <Box className={classes.quickAnswerText}>\n                                  {value.label}\n                                </Box>\n                                {value.mediaType && (\n                                  <Chip\n                                    size=\"small\"\n                                    label={`${getMediaTypeIcon(value.mediaType)} ${value.mediaType}`}\n                                    color={getMediaTypeColor(value.mediaType)}\n                                    className={classes.mediaTypeChip}\n                                  />\n                                )}\n                              </div>\n                            </li>\n                          );\n                        })}\n\n                        {typeBar.length > 5 && (\n                          <div className={classes.quickAnswersScrollIndicator}>\n                            {typeBar.length} respostas â€¢ role para ver mais\n                          </div>\n                        )}\n                      </ul>\n                    ) : (\n                      <div></div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n\n            {(!privateMessageInputVisible || isTicketPending()) && (\n              <>\n                {showSchedules && !isTicketPending() && (\n                  <Tooltip title={i18n.t(\"tickets.buttons.scredule\")}>\n                    <IconButton\n                      aria-label=\"scheduleMessage\"\n                      component=\"span\"\n                      onClick={() => setAppointmentModalOpen(true)}\n                      disabled={loading}\n                    >\n                      <Timer className={classes.sendMessageIcons} />\n                    </IconButton>\n                  </Tooltip>\n                )}\n                {inputMessage || showSelectMessageCheckbox ? (\n                  <>\n                    <IconButton\n                      aria-label=\"sendMessage\"\n                      component=\"span\"\n                      onClick={\n                        showSelectMessageCheckbox\n                          ? handleOpenModalForward\n                          : handleSendMessage\n                      }\n                      disabled={loading}\n                    >\n                      {showSelectMessageCheckbox ? (\n                        <Reply className={classes.ForwardMessageIcons} />\n                      ) : (\n                        <Send className={classes.sendMessageIcons} />\n                      )}\n                    </IconButton>\n                  </>\n                ) : recording ? (\n                  <div className={classes.recorderWrapper}>\n                    <IconButton\n                      aria-label=\"cancelRecording\"\n                      component=\"span\"\n                      fontSize=\"large\"\n                      disabled={loading}\n                      onClick={handleCancelAudio}\n                    >\n                      <HighlightOff className={classes.cancelAudioIcon} />\n                    </IconButton>\n                    {loading ? (\n                      <div>\n                        <CircularProgress className={classes.audioLoading} />\n                      </div>\n                    ) : (\n                      <RecordingTimer />\n                    )}\n\n                    <IconButton\n                      aria-label=\"sendRecordedAudio\"\n                      component=\"span\"\n                      onClick={handleUploadAudio}\n                      disabled={loading}\n                    >\n                      <CheckCircleOutline className={classes.sendAudioIcon} />\n                    </IconButton>\n                  </div>\n                ) : (\n                  <IconButton\n                    aria-label=\"showRecorder\"\n                    component=\"span\"\n                    disabled={disableOptionForPending()}\n                    onClick={handleStartRecording}\n                  >\n                    <Mic className={classes.sendMessageIcons} />\n                  </IconButton>\n                )}\n              </>\n            )}\n\n            {privateMessageInputVisible && !isTicketPending() && (\n              <>\n                <IconButton\n                  aria-label=\"sendMessage\"\n                  component=\"span\"\n                  onClick={\n                    showSelectMessageCheckbox\n                      ? handleOpenModalForward\n                      : handleSendMessage\n                  }\n                  disabled={loading}\n                >\n                  {showSelectMessageCheckbox ? (\n                    <Reply className={classes.ForwardMessageIcons} />\n                  ) : (\n                    <Send className={classes.sendMessageIcons} />\n                  )}\n                </IconButton>\n              </>\n            )}\n\n            {appointmentModalOpen && (\n              <ScheduleModal\n                open={appointmentModalOpen}\n                onClose={() => setAppointmentModalOpen(false)}\n                message={inputMessage}\n                contactId={contactId}\n                fromMessageInput={true}\n                user={user}\n              />\n            )}\n\n            {/* Menu de formataÃ§Ã£o que aparece quando texto Ã© selecionado */}\n            <TextFormatMenu />\n\n          </div>\n        </Paper>\n      </>\n    );\n  }\n};\n\nexport default MessageInput;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}