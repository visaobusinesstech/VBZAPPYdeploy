{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Dialog,DialogTitle,DialogContent,DialogContentText,DialogActions,Button}from'@mui/material';import{i18n}from'../../translate/i18n';import{Stepper,Step,StepLabel,Typography,Paper,Grid}from'@material-ui/core';import{format,parseISO}from'date-fns';import api from'../../services/api';import toastError from\"../../errors/toastError\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShowTicketLogModal=_ref=>{let{isOpen,handleClose,ticketId}=_ref;const[activeStep,setActiveStep]=useState(0);const[loading,setLoading]=useState(false);const[logs,setLogs]=useState([]);const typeDescriptions={create:i18n.t(\"showTicketLogModal.options.create\"),chatBot:i18n.t(\"showTicketLogModal.options.chatBot\"),queue:i18n.t(\"showTicketLogModal.options.queue\"),open:i18n.t(\"showTicketLogModal.options.open\"),access:i18n.t(\"showTicketLogModal.options.access\"),transfered:i18n.t(\"showTicketLogModal.options.transfered\"),receivedTransfer:i18n.t(\"showTicketLogModal.options.receivedTransfer\"),pending:i18n.t(\"showTicketLogModal.options.pending\"),closed:i18n.t(\"showTicketLogModal.options.closed\"),reopen:i18n.t(\"showTicketLogModal.options.reopen\"),redirect:i18n.t(\"showTicketLogModal.options.redirect\"),clientClosed:i18n.t(\"showTicketLogModal.options.clientClosed\")// Adicione outros mapeamentos conforme necessário\n};useEffect(()=>{setLoading(true);const delayDebounceFn=setTimeout(()=>{const fetchLogs=async()=>{try{const{data}=await api.get(\"/tickets-log/\".concat(ticketId));setLogs(data);setLoading(false);}catch(err){setLoading(false);toastError(err);}};fetchLogs();},500);return()=>clearTimeout(delayDebounceFn);},[ticketId]);return/*#__PURE__*/_jsxs(Dialog,{open:isOpen,onClose:handleClose,children:[/*#__PURE__*/_jsx(DialogTitle,{children:i18n.t('showTicketLogModal.title.header')}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Paper,{children:/*#__PURE__*/_jsx(DialogContentText,{children:/*#__PURE__*/_jsx(Stepper,{activeStep:activeStep,orientation:\"vertical\",children:logs.map((log,index)=>{var _log$user,_log$queue,_log$queue2,_log$user2;return/*#__PURE__*/_jsx(Step,{children:/*#__PURE__*/_jsx(StepLabel,{children:\"\".concat(log.type==='access'||log.type==='transfered'||log.type==='open'||log.type==='pending'||log.type===\"closed\"||log.type===\"reopen\"?log===null||log===void 0?void 0:(_log$user=log.user)===null||_log$user===void 0?void 0:_log$user.name:(log===null||log===void 0?void 0:log.type)==='queue'||(log===null||log===void 0?void 0:log.type)==='redirect'?log===null||log===void 0?void 0:(_log$queue=log.queue)===null||_log$queue===void 0?void 0:_log$queue.name:log.type==='receivedTransfer'?(log===null||log===void 0?void 0:(_log$queue2=log.queue)===null||_log$queue2===void 0?void 0:_log$queue2.name)+' - '+(log===null||log===void 0?void 0:(_log$user2=log.user)===null||_log$user2===void 0?void 0:_log$user2.name):'',\" \\n                    \").concat(typeDescriptions[log.type],\" - \").concat(format(parseISO(log===null||log===void 0?void 0:log.createdAt),'dd/MM/yyyy HH:mm'))})},index);})})})})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"primary\",children:\"Fechar\"})})]});};export default ShowTicketLogModal;","map":{"version":3,"names":["React","useState","useEffect","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","i18n","Stepper","Step","StepLabel","Typography","Paper","Grid","format","parseISO","api","toastError","jsx","_jsx","jsxs","_jsxs","ShowTicketLogModal","_ref","isOpen","handleClose","ticketId","activeStep","setActiveStep","loading","setLoading","logs","setLogs","typeDescriptions","create","t","chatBot","queue","open","access","transfered","receivedTransfer","pending","closed","reopen","redirect","clientClosed","delayDebounceFn","setTimeout","fetchLogs","data","get","concat","err","clearTimeout","onClose","children","orientation","map","log","index","_log$user","_log$queue","_log$queue2","_log$user2","type","user","name","createdAt","onClick","color"],"sources":["/home/deploy/atendechatop/frontend/src/components/ShowTicketLogModal/index.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Dialog, DialogTitle, DialogContent, DialogContentText, DialogActions, Button } from '@mui/material';\nimport { i18n } from '../../translate/i18n';\nimport { Stepper, Step, StepLabel, Typography, Paper, Grid } from '@material-ui/core';\nimport { format, parseISO } from 'date-fns';\nimport api from '../../services/api';\nimport toastError from \"../../errors/toastError\";\n\nconst ShowTicketLogModal = ({ isOpen, handleClose, ticketId }) => {\n  const [activeStep, setActiveStep] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [logs, setLogs] = useState([]);\n\n  const typeDescriptions = {\n    create: i18n.t(\"showTicketLogModal.options.create\"),\n    chatBot: i18n.t(\"showTicketLogModal.options.chatBot\"),\n    queue: i18n.t(\"showTicketLogModal.options.queue\"),\n    open: i18n.t(\"showTicketLogModal.options.open\"),\n    access: i18n.t(\"showTicketLogModal.options.access\"),\n    transfered: i18n.t(\"showTicketLogModal.options.transfered\"),\n    receivedTransfer: i18n.t(\"showTicketLogModal.options.receivedTransfer\"),\n    pending: i18n.t(\"showTicketLogModal.options.pending\"),\n    closed: i18n.t(\"showTicketLogModal.options.closed\"),\n    reopen: i18n.t(\"showTicketLogModal.options.reopen\"),\n    redirect: i18n.t(\"showTicketLogModal.options.redirect\"),\n    clientClosed: i18n.t(\"showTicketLogModal.options.clientClosed\")\n    // Adicione outros mapeamentos conforme necessário\n  };\n\n  useEffect(() => {\n    setLoading(true);\n    const delayDebounceFn = setTimeout(() => {\n      const fetchLogs = async () => {\n        try {\n          const { data } = await api.get(`/tickets-log/${ticketId}`);\n          setLogs(data);\n          setLoading(false);\n        } catch (err) {\n          setLoading(false);\n          toastError(err);\n        }\n      };\n      fetchLogs();\n    }, 500);\n    return () => clearTimeout(delayDebounceFn);\n  }, [ticketId]);\n\n  return (\n    <Dialog open={isOpen} onClose={handleClose}>\n      <DialogTitle>{i18n.t('showTicketLogModal.title.header')}</DialogTitle>\n      <DialogContent>\n        <Paper>\n          <DialogContentText>\n            <Stepper activeStep={activeStep} orientation=\"vertical\">\n              {logs.map((log, index) => (\n                <Step key={index}>\n                  <StepLabel>\n                    {`${log.type === 'access' ||\n                      log.type === 'transfered' ||\n                      log.type === 'open' || log.type === 'pending' || log.type === \"closed\" || log.type === \"reopen\"\n                      ? log?.user?.name\n                      : log?.type === 'queue' || log?.type === 'redirect'\n                        ? log?.queue?.name\n                        : log.type === 'receivedTransfer'\n                          ? log?.queue?.name + ' - ' + log?.user?.name\n                          : ''} \n                    ${typeDescriptions[log.type]} - ${format(\n                            parseISO(log?.createdAt),\n                            'dd/MM/yyyy HH:mm'\n                          )}`}\n                  </StepLabel>\n                </Step>\n              ))}\n            </Stepper>\n          </DialogContentText>\n        </Paper>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={handleClose} color=\"primary\">\n          Fechar\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default ShowTicketLogModal;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}