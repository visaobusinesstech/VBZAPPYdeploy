{"ast":null,"code":"import _objectSpread from\"/home/deploy/atendechatop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/components/ScheduleModal/index.js\nimport React,{useState,useEffect,useContext,useRef}from\"react\";import*as Yup from\"yup\";import{Formik,Form,Field,FieldArray}from\"formik\";import{toast}from\"react-toastify\";import{useHistory}from\"react-router-dom\";import{makeStyles}from\"@material-ui/core/styles\";import{green}from\"@material-ui/core/colors\";import Button from\"@material-ui/core/Button\";import TextField from\"@material-ui/core/TextField\";import Dialog from\"@material-ui/core/Dialog\";import DialogActions from\"@material-ui/core/DialogActions\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import CircularProgress from\"@material-ui/core/CircularProgress\";import{i18n}from\"../../translate/i18n\";import api from\"../../services/api\";import toastError from\"../../errors/toastError\";import{Chip,FormControl,FormControlLabel,Grid,IconButton,InputLabel,MenuItem,Select,Switch,Typography}from\"@material-ui/core\";import Autocomplete,{createFilterOptions}from\"@material-ui/lab/Autocomplete\";import moment from\"moment\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{isArray,capitalize}from\"lodash\";import DeleteOutline from\"@material-ui/icons/DeleteOutline\";import AttachFile from\"@material-ui/icons/AttachFile\";import{head}from\"lodash\";import ConfirmationModal from\"../ConfirmationModal\";import MessageVariablesPicker from\"../MessageVariablesPicker\";import useQueues from\"../../hooks/useQueues\";import UserStatusIcon from\"../UserModal/statusIcon\";import{Facebook,Instagram,WhatsApp,FlashOn}from\"@material-ui/icons\";import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const useStyles=makeStyles(theme=>({root:{display:\"flex\",flexWrap:\"wrap\"},btnWrapper:{position:\"relative\"},buttonProgress:{color:green[500],position:\"absolute\",top:\"50%\",left:\"50%\",marginTop:-12,marginLeft:-12}}));const ScheduleSchema=Yup.object().shape({body:Yup.string().min(5,\"Mensagem muito curta\").required(\"ObrigatÃ³rio\"),contactId:Yup.number().required(\"ObrigatÃ³rio\"),sendAt:Yup.string().required(\"ObrigatÃ³rio\"),reminderDate:Yup.string().nullable()});const ScheduleModal=_ref=>{let{open,onClose,scheduleId,contactId,cleanContact,reload,message,// âœ… Nova prop para pre-popular mensagem\nfromMessageInput=false,// âœ… Nova prop para identificar origem\nuser}=_ref;const classes=useStyles();const history=useHistory();const isMounted=useRef(true);const{companyId}=user;const isAdmin=user.profile==='admin';const initialState={body:message||\"\",// âœ… Pre-popular com mensagem se fornecida\ncontactId:contactId||\"\",// âœ… Pre-popular com contactId se fornecido\nsendAt:moment().add(1,\"hour\").format(\"YYYY-MM-DDTHH:mm\"),sentAt:\"\",openTicket:\"enabled\",ticketUserId:user.id,queueId:\"\",statusTicket:\"open\",// âœ… Status baseado na origem\nintervalo:1,valorIntervalo:0,enviarQuantasVezes:1,tipoDias:4,assinar:false,// âœ… Novos campos para lembrete\nreminderDate:\"\"};const initialContact={id:\"\",name:\"\",channel:\"\"};const[schedule,setSchedule]=useState(initialState);const[currentContact,setCurrentContact]=useState(initialContact);const[contacts,setContacts]=useState([initialContact]);const[intervalo,setIntervalo]=useState(1);const[tipoDias,setTipoDias]=useState(4);const[attachment,setAttachment]=useState(null);const attachmentFile=useRef(null);const[confirmationOpen,setConfirmationOpen]=useState(false);const messageInputRef=useRef();const[channelFilter,setChannelFilter]=useState(\"whatsapp\");const[whatsapps,setWhatsapps]=useState([]);const[selectedWhatsapps,setSelectedWhatsapps]=useState([]);const[loading,setLoading]=useState(false);const[queues,setQueues]=useState([]);const[allQueues,setAllQueues]=useState([]);const[selectedUser,setSelectedUser]=useState(null);const[selectedQueue,setSelectedQueue]=useState(null);const{findAll:findAllQueues}=useQueues();const[options,setOptions]=useState([]);const[searchParam,setSearchParam]=useState(\"\");// Estados para quickMessages\nconst[quickMessages,setQuickMessages]=useState([]);const[filteredQuickMessages,setFilteredQuickMessages]=useState([]);const[loadingQuickMessages,setLoadingQuickMessages]=useState(false);const[selectedQuickMessage,setSelectedQuickMessage]=useState(\"\");const[quickMessageSearch,setQuickMessageSearch]=useState(\"\");const[showAllQuickMessages,setShowAllQuickMessages]=useState(false);const[quickMessageMedia,setQuickMessageMedia]=useState(null);useEffect(()=>{return()=>{isMounted.current=false;};},[]);useEffect(()=>{if(isMounted.current){const loadQueues=async()=>{const list=await findAllQueues();setAllQueues(list);setQueues(list);};loadQueues();}},[]);// Buscar quickMessages quando o modal abrir\nuseEffect(()=>{if(open&&user!==null&&user!==void 0&&user.companyId){fetchQuickMessages();}},[open,user===null||user===void 0?void 0:user.companyId,user===null||user===void 0?void 0:user.id]);// Filtrar respostas rÃ¡pidas baseado na busca\nuseEffect(()=>{if(quickMessageSearch.trim()===\"\"&&!showAllQuickMessages){setFilteredQuickMessages([]);}else if(quickMessageSearch.trim()===\"\"&&showAllQuickMessages){setFilteredQuickMessages(quickMessages);}else{const filtered=quickMessages.filter(qm=>qm.message.toLowerCase().includes(quickMessageSearch.toLowerCase())||qm.shortcode.toLowerCase().includes(quickMessageSearch.toLowerCase()));setFilteredQuickMessages(filtered);}},[quickMessageSearch,quickMessages,showAllQuickMessages]);const fetchQuickMessages=async()=>{setLoadingQuickMessages(true);try{console.log(\"ðŸ” Buscando quickMessages com params:\",{companyId:user===null||user===void 0?void 0:user.companyId,userId:user===null||user===void 0?void 0:user.id,isOficial:\"false\"});const{data}=await api.get(\"/quick-messages/list\",{params:{companyId:user===null||user===void 0?void 0:user.companyId,userId:user===null||user===void 0?void 0:user.id,isOficial:\"false\"}});console.log(\"ðŸ“‹ Resposta da API quickMessages:\",data);setQuickMessages(data||[]);setFilteredQuickMessages(data||[]);}catch(err){console.error(\"âŒ Erro ao buscar respostas rÃ¡pidas:\",err);toastError(err);setQuickMessages([]);setFilteredQuickMessages([]);}finally{setLoadingQuickMessages(false);}};// FunÃ§Ã£o para baixar mÃ­dia da quickMessage\nconst downloadQuickMessageMedia=async(mediaPath,mediaName,mediaType)=>{try{// console.log(\"ðŸ“Ž Baixando mÃ­dia da quickMessage:\", { mediaPath, mediaName, mediaType });\n// Construir URL correta usando a URL base do backend\nconst backendUrl=process.env.REACT_APP_BACKEND_URL||'http://localhost:8080';const downloadUrl=\"\".concat(backendUrl,\"/public/company\").concat(user===null||user===void 0?void 0:user.companyId,\"/quickMessage/\").concat(mediaName);// console.log(\"ðŸ”— URL de download:\", downloadUrl);\nconst response=await fetch(downloadUrl,{method:'GET',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('token'))}});if(!response.ok){throw new Error(\"Erro ao baixar m\\xEDdia: \".concat(response.status));}const blob=await response.blob();const file=new File([blob],mediaName,{type:blob.type||getMediaTypeFromExtension(mediaName,mediaType)});// console.log(\"âœ… MÃ­dia baixada com sucesso:\", file);\nreturn file;}catch(err){console.error(\"âŒ Erro ao baixar mÃ­dia da quickMessage:\",err);toastError(err);return null;}};// FunÃ§Ã£o auxiliar para determinar o tipo MIME baseado na extensÃ£o\nconst getMediaTypeFromExtension=(fileName,mediaType)=>{const extension=fileName.split('.').pop().toLowerCase();switch(mediaType){case'image':return\"image/\".concat(extension==='jpg'?'jpeg':extension);case'audio':return\"audio/\".concat(extension);case'video':return\"video/\".concat(extension);default:return'application/octet-stream';}};useEffect(()=>{if(searchParam.length<3){setLoading(false);setSelectedQueue(\"\");return;}const delayDebounceFn=setTimeout(()=>{setLoading(true);const fetchUsers=async()=>{try{const{data}=await api.get(\"/users/\");setOptions(data.users);setLoading(false);}catch(err){setLoading(false);toastError(err);}};fetchUsers();},500);return()=>clearTimeout(delayDebounceFn);},[searchParam]);useEffect(()=>{api.get(\"/whatsapp/filter\",{params:{session:0,channel:channelFilter}}).then(_ref2=>{let{data}=_ref2;const mappedWhatsapps=data.map(whatsapp=>_objectSpread(_objectSpread({},whatsapp),{},{selected:false}));setWhatsapps(mappedWhatsapps);if(mappedWhatsapps.length&&(mappedWhatsapps===null||mappedWhatsapps===void 0?void 0:mappedWhatsapps.length)===1){setSelectedWhatsapps(mappedWhatsapps[0].id);}});},[currentContact,channelFilter]);useEffect(()=>{if(contactId&&contacts.length){const contact=contacts.find(c=>c.id===contactId);if(contact){setCurrentContact(contact);}}},[contactId,contacts]);// âœ… MELHORIA: UseEffect otimizado com melhor lÃ³gica de inicializaÃ§Ã£o\nuseEffect(()=>{const{companyId}=user;if(open){try{(async()=>{// Carregar lista de contatos\nconst{data:contactList}=await api.get(\"/contacts/list\",{params:{companyId:companyId}});let customList=contactList.map(c=>({id:c.id,name:c.name,channel:c.channel}));if(isArray(customList)){setContacts([{id:\"\",name:\"\",channel:\"\"},...customList]);}// âœ… MELHORIA: LÃ³gica de inicializaÃ§Ã£o aprimorada\nif(!scheduleId){// Modal sendo aberto para criar novo agendamento\nconst newScheduleState=_objectSpread(_objectSpread({},initialState),{},{body:message||\"\",// âœ… Pre-popular mensagem\ncontactId:contactId||\"\"// âœ… Pre-popular contato\n});setSchedule(newScheduleState);// âœ… MELHORIA: Se contactId foi fornecido, definir contato atual\nif(contactId&&customList.length>0){const foundContact=customList.find(c=>c.id.toString()===contactId.toString());if(foundContact){setCurrentContact(foundContact);setChannelFilter(foundContact.channel||\"whatsapp\");console.log(\"âœ… Contato auto-selecionado:\",foundContact.name);}}return;}// âœ… Carregamento de agendamento existente (lÃ³gica original)\nconst{data}=await api.get(\"/schedules/\".concat(scheduleId));setSchedule(prevState=>{return _objectSpread(_objectSpread(_objectSpread({},prevState),data),{},{sendAt:moment(data.sendAt).format(\"YYYY-MM-DDTHH:mm\"),// âœ… Incluir campos de lembrete no carregamento\nreminderDate:data.reminderDate?moment(data.reminderDate).format(\"YYYY-MM-DDTHH:mm\"):\"\"});});console.log(\"ðŸ“… Agendamento carregado:\",data);if(data.whatsapp){setSelectedWhatsapps(data.whatsapp.id);}if(!isAdmin&&data.ticketUser){setSelectedUser(data.ticketUser);}if(data.queueId){setSelectedQueue(data.queueId);}if(data.intervalo){setIntervalo(data.intervalo);}if(data.tipoDias){setTipoDias(data.tipoDias);}setCurrentContact(data.contact);})();}catch(err){toastError(err);}}},[scheduleId,contactId,open,user,message,fromMessageInput]);const filterOptions=createFilterOptions({trim:true});const handleClose=()=>{onClose();setAttachment(null);setSchedule(initialState);// âœ… MELHORIA: Reset do contato atual ao fechar\nsetCurrentContact(initialContact);// Reset do dropdown de quickMessages\nsetSelectedQuickMessage(\"\");setQuickMessageSearch(\"\");setShowAllQuickMessages(false);setFilteredQuickMessages([]);setQuickMessageMedia(null);// âœ… Reset dos campos de lembrete\nsetSchedule(prevState=>_objectSpread(_objectSpread({},prevState),{},{reminderDate:\"\"}));};const handleAttachmentFile=e=>{const file=head(e.target.files);if(file){setAttachment(file);}};const IconChannel=channel=>{switch(channel){case\"facebook\":return/*#__PURE__*/_jsx(Facebook,{style:{color:\"#3b5998\",verticalAlign:\"middle\"}});case\"instagram\":return/*#__PURE__*/_jsx(Instagram,{style:{color:\"#e1306c\",verticalAlign:\"middle\"}});case\"whatsapp\":return/*#__PURE__*/_jsx(WhatsApp,{style:{color:\"#25d366\",verticalAlign:\"middle\"}});default:return\"error\";}};const renderOption=option=>{if(option.name){return/*#__PURE__*/_jsxs(_Fragment,{children:[IconChannel(option.channel),/*#__PURE__*/_jsx(Typography,{component:\"span\",style:{fontSize:14,marginLeft:\"10px\",display:\"inline-flex\",alignItems:\"center\",lineHeight:\"2\"},children:option.name})]});}else{return\"\".concat(i18n.t(\"newTicketModal.add\"),\" \").concat(option.name);}};const handleSaveSchedule=async values=>{const scheduleData=_objectSpread(_objectSpread({},values),{},{userId:user.id,whatsappId:selectedWhatsapps,ticketUserId:(selectedUser===null||selectedUser===void 0?void 0:selectedUser.id)||null,queueId:selectedQueue||null,intervalo:intervalo||1,tipoDias:tipoDias||4,// âœ… Incluir dados do lembrete\nreminderDate:values.reminderDate||null});try{if(scheduleId){await api.put(\"/schedules/\".concat(scheduleId),scheduleData);if(attachment!=null){const formData=new FormData();formData.append(\"file\",attachment);await api.post(\"/schedules/\".concat(scheduleId,\"/media-upload\"),formData);}}else{const{data}=await api.post(\"/schedules\",scheduleData);if(attachment!=null){const formData=new FormData();formData.append(\"file\",attachment);await api.post(\"/schedules/\".concat(data.id,\"/media-upload\"),formData);}}toast.success(i18n.t(\"scheduleModal.success\"));if(typeof reload==\"function\"){reload();}if(contactId){if(typeof cleanContact===\"function\"){cleanContact();history.push(\"/schedules\");}}}catch(err){toastError(err);}setCurrentContact(initialContact);setSchedule(initialState);// âœ… Reset dos campos de lembrete apÃ³s salvar\nsetSchedule(prevState=>_objectSpread(_objectSpread({},prevState),{},{reminderDate:\"\"}));handleClose();};const handleClickMsgVar=async(msgVar,setValueFunc)=>{const el=messageInputRef.current;const firstHalfText=el.value.substring(0,el.selectionStart);const secondHalfText=el.value.substring(el.selectionEnd);const newCursorPos=el.selectionStart+msgVar.length;setValueFunc(\"body\",\"\".concat(firstHalfText).concat(msgVar).concat(secondHalfText));await new Promise(r=>setTimeout(r,100));messageInputRef.current.setSelectionRange(newCursorPos,newCursorPos);};// FunÃ§Ã£o para lidar com seleÃ§Ã£o de resposta rÃ¡pida\nconst handleQuickMessageSelect=async(selectedMessage,setFieldValue)=>{console.log(\"ðŸŽ¯ Mensagem selecionada:\",selectedMessage);if(selectedMessage){console.log(\"âœ… Preenchendo campo body com:\",selectedMessage.message);setFieldValue(\"body\",selectedMessage.message||\"\");setQuickMessageSearch(selectedMessage.message||\"\");// Se a mensagem tem mÃ­dia, baixar e definir como attachment\nif(selectedMessage.mediaPath){console.log(\"ðŸ“Ž Mensagem com mÃ­dia:\",selectedMessage.mediaPath);try{const mediaFile=await downloadQuickMessageMedia(selectedMessage.mediaPath,selectedMessage.mediaName,selectedMessage.mediaType);if(mediaFile){setAttachment(mediaFile);setQuickMessageMedia({path:selectedMessage.mediaPath,name:selectedMessage.mediaName,type:selectedMessage.mediaType});console.log(\"âœ… MÃ­dia da quickMessage definida como attachment:\",mediaFile);}}catch(err){console.error(\"âŒ Erro ao processar mÃ­dia da quickMessage:\",err);}}else{// Limpar mÃ­dia anterior se nÃ£o hÃ¡ mÃ­dia na nova seleÃ§Ã£o\nsetQuickMessageMedia(null);setAttachment(null);if(attachmentFile.current){attachmentFile.current.value=null;}}}};const deleteMedia=async()=>{if(attachment){setAttachment(null);attachmentFile.current.value=null;}// Limpar mÃ­dia da quickMessage se existir\nif(quickMessageMedia){setQuickMessageMedia(null);}if(schedule.mediaPath){await api.delete(\"/schedules/\".concat(schedule.id,\"/media-upload\"));setSchedule(prev=>_objectSpread(_objectSpread({},prev),{},{mediaPath:null}));toast.success(i18n.t(\"scheduleModal.toasts.deleted\"));if(typeof reload==\"function\"){console.log(reload);console.log(\"1\");reload();}}};return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(ConfirmationModal,{title:i18n.t(\"scheduleModal.confirmationModal.deleteTitle\"),open:confirmationOpen,onClose:()=>setConfirmationOpen(false),onConfirm:deleteMedia,children:i18n.t(\"scheduleModal.confirmationModal.deleteMessage\")}),/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,maxWidth:\"md\",fullWidth:true,scroll:\"paper\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"form-dialog-title\",children:schedule.status===\"ERRO\"?\"Erro de Envio\":\"Mensagem \".concat(capitalize(schedule.status))}),/*#__PURE__*/_jsx(\"div\",{style:{display:\"none\"},children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".png,.jpg,.jpeg\",ref:attachmentFile,onChange:e=>handleAttachmentFile(e)})}),/*#__PURE__*/_jsx(Formik,{initialValues:schedule,enableReinitialize:true,validationSchema:ScheduleSchema,onSubmit:(values,actions)=>{setTimeout(()=>{handleSaveSchedule(values);actions.setSubmitting(false);},400);},children:_ref3=>{let{touched,errors,isSubmitting,values,setFieldValue}=_ref3;return/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsx(\"div\",{className:classes.multFieldLine,children:/*#__PURE__*/_jsx(FormControl,{variant:\"outlined\",fullWidth:true,children:/*#__PURE__*/_jsx(Autocomplete,{fullWidth:true,value:currentContact,options:contacts,onChange:(e,contact)=>{const contactId=contact?contact.id:\"\";setSchedule(_objectSpread(_objectSpread({},schedule),{},{contactId}));setCurrentContact(contact?contact:initialContact);setChannelFilter(contact?contact.channel:\"whatsapp\");},getOptionLabel:option=>option.name,renderOption:renderOption,getOptionSelected:(option,value)=>{return value.id===option.id;},renderInput:params=>/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{variant:\"outlined\",placeholder:\"Contato\"}))})})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsx(Field,{as:TextField,label:i18n.t(\"scheduleModal.form.sendAt\"),type:\"datetime-local\",name:\"sendAt\",error:touched.sendAt&&Boolean(errors.sendAt),helperText:touched.sendAt&&errors.sendAt,variant:\"outlined\",fullWidth:true,size:\"small\",style:{marginTop:\"8px\"}})})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.multFieldLine,children:/*#__PURE__*/_jsx(Field,{as:TextField,rows:9,multiline:true,label:i18n.t(\"scheduleModal.form.body\"),name:\"body\",inputRef:messageInputRef,error:touched.body&&Boolean(errors.body),helperText:touched.body&&errors.body,variant:\"outlined\",margin:\"dense\",fullWidth:true})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.multFieldLine,children:[/*#__PURE__*/_jsx(TextField,{variant:\"outlined\",fullWidth:true,margin:\"dense\",label:i18n.t(\"ticketInfo.quickMessages\"),placeholder:\"Digite para buscar respostas r\\xE1pidas...\",value:quickMessageSearch,onChange:e=>{setQuickMessageSearch(e.target.value);if(e.target.value.trim()===\"\"){setShowAllQuickMessages(false);}},onFocus:()=>{if(quickMessageSearch.trim()===\"\"&&!showAllQuickMessages){setShowAllQuickMessages(true);}},onClick:()=>{if(quickMessageSearch.trim()===\"\"&&!showAllQuickMessages){setShowAllQuickMessages(true);}},disabled:loadingQuickMessages,InputProps:{startAdornment:/*#__PURE__*/_jsx(FlashOn,{style:{marginRight:'8px',color:'#1976d2'}})}}),(quickMessageSearch&&filteredQuickMessages.length>0||showAllQuickMessages&&filteredQuickMessages.length>0)&&/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'200px',overflowY:'auto',border:'1px solid #e0e0e0',borderRadius:'4px',marginTop:'4px',backgroundColor:'white',zIndex:1000,position:'relative'},children:filteredQuickMessages.map(quickMessage=>/*#__PURE__*/_jsxs(\"div\",{onClick:()=>handleQuickMessageSelect(quickMessage,setFieldValue),style:{padding:'12px',cursor:'pointer',borderBottom:'1px solid #f0f0f0',display:'flex',alignItems:'center',gap:'8px'},onMouseEnter:e=>e.target.style.backgroundColor='#f5f5f5',onMouseLeave:e=>e.target.style.backgroundColor='white',children:[/*#__PURE__*/_jsx(FlashOn,{style:{fontSize:'16px',color:'#1976d2'}}),/*#__PURE__*/_jsxs(\"div\",{style:{flex:1},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold',fontSize:'14px'},children:quickMessage.shortcode}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#666',maxWidth:'300px',overflow:'hidden',textOverflow:'ellipsis',whiteSpace:'nowrap'},children:quickMessage.message})]}),quickMessage.mediaPath&&/*#__PURE__*/_jsx(AttachFile,{style:{fontSize:'14px',color:'#666'}})]},quickMessage.id))}),quickMessageSearch&&filteredQuickMessages.length===0&&!loadingQuickMessages&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'12px',textAlign:'center',color:'#666',fontStyle:'italic',border:'1px solid #e0e0e0',borderRadius:'4px',marginTop:'4px'},children:\"Nenhuma resposta r\\xE1pida encontrada\"})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,xl:12,children:/*#__PURE__*/_jsx(MessageVariablesPicker,{disabled:isSubmitting,showSchedulingVars:true,onClick:value=>handleClickMsgVar(value,setFieldValue)})}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:3,children:/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,className:classes.formControl,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"whatsapp-selection-label\",children:i18n.t(\"campaigns.dialog.form.whatsapp\")}),/*#__PURE__*/_jsx(Field,{as:Select,label:i18n.t(\"campaigns.dialog.form.whatsapp\"),placeholder:i18n.t(\"campaigns.dialog.form.whatsapp\"),labelId:\"whatsapp-selection-label\",id:\"whatsappIds\",name:\"whatsappIds\",required:true,error:touched.whatsappId&&Boolean(errors.whatsappId),value:selectedWhatsapps,onChange:event=>setSelectedWhatsapps(event.target.value),children:whatsapps&&whatsapps.map(whatsapp=>/*#__PURE__*/_jsx(MenuItem,{value:whatsapp.id,children:whatsapp.name},whatsapp.id))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,xl:3,children:/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,className:classes.formControl,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"openTicket-selection-label\",children:i18n.t(\"campaigns.dialog.form.openTicket\")}),/*#__PURE__*/_jsxs(Field,{as:Select,label:i18n.t(\"campaigns.dialog.form.openTicket\"),placeholder:i18n.t(\"campaigns.dialog.form.openTicket\"),labelId:\"openTicket-selection-label\",id:\"openTicket\",name:\"openTicket\",error:touched.openTicket&&Boolean(errors.openTicket),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"enabled\",children:i18n.t(\"campaigns.dialog.form.enabledOpenTicket\")}),/*#__PURE__*/_jsx(MenuItem,{value:\"disabled\",children:i18n.t(\"campaigns.dialog.form.disabledOpenTicket\")})]})]})})]}),/*#__PURE__*/_jsxs(Grid,{spacing:1,container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:4,children:/*#__PURE__*/_jsx(Autocomplete,{style:{marginTop:\"8px\"},variant:\"outlined\",margin:\"dense\",className:classes.formControl,getOptionLabel:option=>\"\".concat(option.name),value:isAdmin?selectedUser:user,size:\"small\",onChange:(e,newValue)=>{if(isAdmin){setSelectedUser(newValue);if(newValue!=null&&Array.isArray(newValue.queues)){if(newValue.queues.length===1){setSelectedQueue(newValue.queues[0].id);}setQueues(newValue.queues);}else{setQueues(allQueues);setSelectedQueue(\"\");}}},options:isAdmin?options:[user],filterOptions:filterOptions,freeSolo:isAdmin,fullWidth:true,disabled:values.openTicket===\"disabled\"||!isAdmin,autoHighlight:true,noOptionsText:i18n.t(\"transferTicketModal.noOptions\"),loading:loading,renderOption:option=>/*#__PURE__*/_jsxs(\"span\",{children:[\" \",/*#__PURE__*/_jsx(UserStatusIcon,{user:option}),\" \",option.name]}),renderInput:params=>/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:i18n.t(\"transferTicketModal.fieldLabel\"),variant:\"outlined\",onChange:isAdmin?e=>setSearchParam(e.target.value):undefined// SÃ³ busca se for admin\n,InputProps:_objectSpread(_objectSpread({},params.InputProps),{},{endAdornment:/*#__PURE__*/_jsxs(React.Fragment,{children:[loading?/*#__PURE__*/_jsx(CircularProgress,{color:\"inherit\",size:20}):null,params.InputProps.endAdornment]}),readOnly:!isAdmin// Modo somente leitura se nÃ£o for admin\n})}))})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,className:classes.formControl,children:[/*#__PURE__*/_jsx(InputLabel,{children:i18n.t(\"transferTicketModal.fieldQueueLabel\")}),/*#__PURE__*/_jsx(Select,{value:selectedQueue,onChange:e=>setSelectedQueue(e.target.value),label:i18n.t(\"transferTicketModal.fieldQueuePlaceholder\"),disabled:values.openTicket===\"disabled\",children:queues.map(queue=>/*#__PURE__*/_jsx(MenuItem,{value:queue.id,children:queue.name},queue.id))})]})})]}),/*#__PURE__*/_jsxs(Grid,{spacing:1,container:true,style:{marginTop:\"-10px\"},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",margin:\"dense\",fullWidth:true,className:classes.formControl,children:[/*#__PURE__*/_jsx(InputLabel,{id:\"statusTicket-selection-label\",children:i18n.t(\"campaigns.dialog.form.statusTicket\")}),/*#__PURE__*/_jsxs(Field,{as:Select,disabled:values.openTicket===\"disabled\",label:i18n.t(\"campaigns.dialog.form.statusTicket\"),placeholder:i18n.t(\"campaigns.dialog.form.statusTicket\"),labelId:\"statusTicket-selection-label\",id:\"statusTicket\",name:\"statusTicket\",error:touched.statusTicket&&Boolean(errors.statusTicket),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"closed\",children:i18n.t(\"campaigns.dialog.form.closedTicketStatus\")}),/*#__PURE__*/_jsx(MenuItem,{value:\"open\",children:i18n.t(\"campaigns.dialog.form.openTicketStatus\")})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Field,{as:Switch,color:\"primary\",name:\"assinar\",checked:values.assinar,disabled:values.openTicket===\"disabled\"}),label:i18n.t(\"scheduleModal.form.assinar\")})})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Lembrete (Opcional)\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Defina uma data de lembrete. A mensagem ser\\xE1 enviada no hor\\xE1rio do lembrete em vez do hor\\xE1rio original do agendamento\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsx(Field,{as:TextField,label:\"Data do Lembrete\",type:\"datetime-local\",name:\"reminderDate\",error:touched.reminderDate&&Boolean(errors.reminderDate),helperText:touched.reminderDate&&errors.reminderDate,variant:\"outlined\",fullWidth:true,size:\"small\",InputLabelProps:{shrink:true}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,xl:6,children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"textSecondary\",style:{padding:'16px',backgroundColor:'#f5f5f5',borderRadius:'4px',marginTop:'8px'},children:\"A mensagem do lembrete ser\\xE1 a mesma da mensagem agendada.\"})})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h3\",{children:i18n.t(\"recurrenceSection.title\")}),/*#__PURE__*/_jsx(\"p\",{children:i18n.t(\"recurrenceSection.description\")}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,xl:4,children:/*#__PURE__*/_jsxs(FormControl,{size:\"small\",fullWidth:true,variant:\"outlined\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"demo-simple-select-label\",children:i18n.t(\"recurrenceSection.labelInterval\")}),/*#__PURE__*/_jsxs(Select,{labelId:\"demo-simple-select-label\",id:\"demo-simple-select\",value:intervalo,onChange:e=>setIntervalo(e.target.value||1),label:i18n.t(\"recurrenceSection.labelInterval\"),children:[/*#__PURE__*/_jsx(MenuItem,{value:1,children:i18n.t(\"recurrenceSection.options.days\")}),/*#__PURE__*/_jsx(MenuItem,{value:2,children:i18n.t(\"recurrenceSection.options.weeks\")}),/*#__PURE__*/_jsx(MenuItem,{value:3,children:i18n.t(\"recurrenceSection.options.months\")}),/*#__PURE__*/_jsx(MenuItem,{value:4,children:i18n.t(\"recurrenceSection.options.minutes\")})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,xl:4,children:/*#__PURE__*/_jsx(Field,{as:TextField,label:i18n.t(\"recurrenceSection.intervalFilterValue\"),name:\"valorIntervalo\",size:\"small\",error:touched.valorIntervalo&&Boolean(errors.valorIntervalo),InputLabelProps:{shrink:true},variant:\"outlined\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:4,xl:4,children:/*#__PURE__*/_jsx(Field,{as:TextField,label:i18n.t(\"recurrenceSection.sendAsManyTimes\"),name:\"enviarQuantasVezes\",size:\"small\",error:touched.enviarQuantasVezes&&Boolean(errors.enviarQuantasVezes),variant:\"outlined\",fullWidth:true})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,xl:12,children:/*#__PURE__*/_jsxs(FormControl,{size:\"small\",fullWidth:true,variant:\"outlined\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"demo-simple-select-label\",children:i18n.t(\"recurrenceSection.sendAsManyTimes\")}),/*#__PURE__*/_jsxs(Select,{labelId:\"demo-simple-select-label\",id:\"demo-simple-select\",value:tipoDias,onChange:e=>setTipoDias(e.target.value||4),label:\"Enviar quantas vezes\",children:[/*#__PURE__*/_jsx(MenuItem,{value:4,children:i18n.t(\"recurrenceSection.shipNormallyOnNonbusinessDays\")}),/*#__PURE__*/_jsx(MenuItem,{value:5,children:i18n.t(\"recurrenceSection.sendOneBusinessDayBefore\")}),/*#__PURE__*/_jsxs(MenuItem,{value:6,children:[\" \",i18n.t(\"recurrenceSection.sendOneBusinessDayLater\")]})]})]})})]}),(schedule.mediaPath||attachment||quickMessageMedia)&&/*#__PURE__*/_jsx(Grid,{xs:12,item:true,children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(AttachFile,{}),children:attachment?attachment.name:quickMessageMedia?quickMessageMedia.name:schedule.mediaName}),quickMessageMedia&&/*#__PURE__*/_jsx(Chip,{label:\"Da Resposta R\\xE1pida\",size:\"small\",color:\"primary\",variant:\"outlined\"}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>setConfirmationOpen(true),color:\"secondary\",children:/*#__PURE__*/_jsx(DeleteOutline,{color:\"secondary\"})})]})})]}),/*#__PURE__*/_jsxs(DialogActions,{children:[!attachment&&!schedule.mediaPath&&!quickMessageMedia&&/*#__PURE__*/_jsx(Button,{color:\"primary\",onClick:()=>attachmentFile.current.click(),disabled:isSubmitting,variant:\"outlined\",children:i18n.t(\"quickMessages.buttons.attach\")}),/*#__PURE__*/_jsx(Button,{onClick:handleClose,color:\"secondary\",disabled:isSubmitting,variant:\"outlined\",children:i18n.t(\"scheduleModal.buttons.cancel\")}),(schedule.sentAt===null||schedule.sentAt===\"\")&&/*#__PURE__*/_jsxs(Button,{type:\"submit\",color:\"primary\",disabled:isSubmitting,variant:\"contained\",className:classes.btnWrapper,children:[scheduleId?\"\".concat(i18n.t(\"scheduleModal.buttons.okEdit\")):\"\".concat(i18n.t(\"scheduleModal.buttons.okAdd\")),isSubmitting&&/*#__PURE__*/_jsx(CircularProgress,{size:24,className:classes.buttonProgress})]})]})]});}})]})]});};export default ScheduleModal;","map":{"version":3,"names":["React","useState","useEffect","useContext","useRef","Yup","Formik","Form","Field","FieldArray","toast","useHistory","makeStyles","green","Button","TextField","Dialog","DialogActions","DialogContent","DialogTitle","CircularProgress","i18n","api","toastError","Chip","FormControl","FormControlLabel","Grid","IconButton","InputLabel","MenuItem","Select","Switch","Typography","Autocomplete","createFilterOptions","moment","AuthContext","isArray","capitalize","DeleteOutline","AttachFile","head","ConfirmationModal","MessageVariablesPicker","useQueues","UserStatusIcon","Facebook","Instagram","WhatsApp","FlashOn","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","useStyles","theme","root","display","flexWrap","btnWrapper","position","buttonProgress","color","top","left","marginTop","marginLeft","ScheduleSchema","object","shape","body","string","min","required","contactId","number","sendAt","reminderDate","nullable","ScheduleModal","_ref","open","onClose","scheduleId","cleanContact","reload","message","fromMessageInput","user","classes","history","isMounted","companyId","isAdmin","profile","initialState","add","format","sentAt","openTicket","ticketUserId","id","queueId","statusTicket","intervalo","valorIntervalo","enviarQuantasVezes","tipoDias","assinar","initialContact","name","channel","schedule","setSchedule","currentContact","setCurrentContact","contacts","setContacts","setIntervalo","setTipoDias","attachment","setAttachment","attachmentFile","confirmationOpen","setConfirmationOpen","messageInputRef","channelFilter","setChannelFilter","whatsapps","setWhatsapps","selectedWhatsapps","setSelectedWhatsapps","loading","setLoading","queues","setQueues","allQueues","setAllQueues","selectedUser","setSelectedUser","selectedQueue","setSelectedQueue","findAll","findAllQueues","options","setOptions","searchParam","setSearchParam","quickMessages","setQuickMessages","filteredQuickMessages","setFilteredQuickMessages","loadingQuickMessages","setLoadingQuickMessages","selectedQuickMessage","setSelectedQuickMessage","quickMessageSearch","setQuickMessageSearch","showAllQuickMessages","setShowAllQuickMessages","quickMessageMedia","setQuickMessageMedia","current","loadQueues","list","fetchQuickMessages","trim","filtered","filter","qm","toLowerCase","includes","shortcode","console","log","userId","isOficial","data","get","params","err","error","downloadQuickMessageMedia","mediaPath","mediaName","mediaType","backendUrl","process","env","REACT_APP_BACKEND_URL","downloadUrl","concat","response","fetch","method","headers","localStorage","getItem","ok","Error","status","blob","file","File","type","getMediaTypeFromExtension","fileName","extension","split","pop","length","delayDebounceFn","setTimeout","fetchUsers","users","clearTimeout","session","then","_ref2","mappedWhatsapps","map","whatsapp","_objectSpread","selected","contact","find","c","contactList","customList","newScheduleState","foundContact","toString","prevState","ticketUser","filterOptions","handleClose","handleAttachmentFile","e","target","files","IconChannel","style","verticalAlign","renderOption","option","children","component","fontSize","alignItems","lineHeight","t","handleSaveSchedule","values","scheduleData","whatsappId","put","formData","FormData","append","post","success","push","handleClickMsgVar","msgVar","setValueFunc","el","firstHalfText","value","substring","selectionStart","secondHalfText","selectionEnd","newCursorPos","Promise","r","setSelectionRange","handleQuickMessageSelect","selectedMessage","setFieldValue","mediaFile","path","deleteMedia","delete","prev","className","title","onConfirm","maxWidth","fullWidth","scroll","accept","ref","onChange","initialValues","enableReinitialize","validationSchema","onSubmit","actions","setSubmitting","_ref3","touched","errors","isSubmitting","dividers","container","spacing","item","xs","md","xl","multFieldLine","variant","getOptionLabel","getOptionSelected","renderInput","placeholder","as","label","Boolean","helperText","size","rows","multiline","inputRef","margin","onFocus","onClick","disabled","InputProps","startAdornment","marginRight","maxHeight","overflowY","border","borderRadius","backgroundColor","zIndex","quickMessage","padding","cursor","borderBottom","gap","onMouseEnter","onMouseLeave","flex","fontWeight","overflow","textOverflow","whiteSpace","textAlign","fontStyle","showSchedulingVars","formControl","labelId","event","newValue","Array","freeSolo","autoHighlight","noOptionsText","undefined","endAdornment","readOnly","queue","control","checked","InputLabelProps","shrink","startIcon","click"],"sources":["/home/deploy/atendechatop/frontend/src/components/ScheduleModal/index.js"],"sourcesContent":["// src/components/ScheduleModal/index.js\n\nimport React, { useState, useEffect, useContext, useRef } from \"react\";\n\nimport * as Yup from \"yup\";\nimport { Formik, Form, Field, FieldArray } from \"formik\";\nimport { toast } from \"react-toastify\";\nimport { useHistory } from \"react-router-dom\";\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { green } from \"@material-ui/core/colors\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\nimport { i18n } from \"../../translate/i18n\";\n\nimport api from \"../../services/api\";\nimport toastError from \"../../errors/toastError\";\nimport {\n  Chip,\n  FormControl,\n  FormControlLabel,\n  Grid,\n  IconButton,\n  InputLabel,\n  MenuItem,\n  Select,\n  Switch,\n  Typography,\n} from \"@material-ui/core\";\nimport Autocomplete, {\n  createFilterOptions,\n} from \"@material-ui/lab/Autocomplete\";\nimport moment from \"moment\";\nimport { AuthContext } from \"../../context/Auth/AuthContext\";\nimport { isArray, capitalize } from \"lodash\";\nimport DeleteOutline from \"@material-ui/icons/DeleteOutline\";\nimport AttachFile from \"@material-ui/icons/AttachFile\";\nimport { head } from \"lodash\";\nimport ConfirmationModal from \"../ConfirmationModal\";\nimport MessageVariablesPicker from \"../MessageVariablesPicker\";\nimport useQueues from \"../../hooks/useQueues\";\nimport UserStatusIcon from \"../UserModal/statusIcon\";\nimport { Facebook, Instagram, WhatsApp, FlashOn } from \"@material-ui/icons\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n  },\n  btnWrapper: {\n    position: \"relative\",\n  },\n  buttonProgress: {\n    color: green[500],\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    marginTop: -12,\n    marginLeft: -12,\n  },\n}));\n\nconst ScheduleSchema = Yup.object().shape({\n  body: Yup.string().min(5, \"Mensagem muito curta\").required(\"ObrigatÃ³rio\"),\n  contactId: Yup.number().required(\"ObrigatÃ³rio\"),\n  sendAt: Yup.string().required(\"ObrigatÃ³rio\"),\n  reminderDate: Yup.string().nullable()\n});\n\nconst ScheduleModal = ({\n  open,\n  onClose,\n  scheduleId,\n  contactId,\n  cleanContact,\n  reload,\n  message, // âœ… Nova prop para pre-popular mensagem\n  fromMessageInput = false, // âœ… Nova prop para identificar origem\n  user\n}) => {\n  const classes = useStyles();\n  const history = useHistory();\n  const isMounted = useRef(true);\n  const { companyId } = user;\n  const isAdmin = user.profile === 'admin';\n\n  const initialState = {\n    body: message || \"\", // âœ… Pre-popular com mensagem se fornecida\n    contactId: contactId || \"\", // âœ… Pre-popular com contactId se fornecido\n    sendAt: moment().add(1, \"hour\").format(\"YYYY-MM-DDTHH:mm\"),\n    sentAt: \"\",\n    openTicket: \"enabled\",\n    ticketUserId: user.id,\n    queueId: \"\",\n    statusTicket: \"open\", // âœ… Status baseado na origem\n    intervalo: 1,\n    valorIntervalo: 0,\n    enviarQuantasVezes: 1,\n    tipoDias: 4,\n    assinar: false,\n    // âœ… Novos campos para lembrete\n    reminderDate: \"\",\n  };\n\n  const initialContact = {\n    id: \"\",\n    name: \"\",\n    channel: \"\",\n  };\n\n  const [schedule, setSchedule] = useState(initialState);\n  const [currentContact, setCurrentContact] = useState(initialContact);\n  const [contacts, setContacts] = useState([initialContact]);\n  const [intervalo, setIntervalo] = useState(1);\n  const [tipoDias, setTipoDias] = useState(4);\n  const [attachment, setAttachment] = useState(null);\n  const attachmentFile = useRef(null);\n  const [confirmationOpen, setConfirmationOpen] = useState(false);\n  const messageInputRef = useRef();\n  const [channelFilter, setChannelFilter] = useState(\"whatsapp\");\n  const [whatsapps, setWhatsapps] = useState([]);\n  const [selectedWhatsapps, setSelectedWhatsapps] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [queues, setQueues] = useState([]);\n  const [allQueues, setAllQueues] = useState([]);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [selectedQueue, setSelectedQueue] = useState(null);\n  const { findAll: findAllQueues } = useQueues();\n  const [options, setOptions] = useState([]);\n  const [searchParam, setSearchParam] = useState(\"\");\n\n  // Estados para quickMessages\n  const [quickMessages, setQuickMessages] = useState([]);\n  const [filteredQuickMessages, setFilteredQuickMessages] = useState([]);\n  const [loadingQuickMessages, setLoadingQuickMessages] = useState(false);\n  const [selectedQuickMessage, setSelectedQuickMessage] = useState(\"\");\n  const [quickMessageSearch, setQuickMessageSearch] = useState(\"\");\n  const [showAllQuickMessages, setShowAllQuickMessages] = useState(false);\n  const [quickMessageMedia, setQuickMessageMedia] = useState(null);\n\n  useEffect(() => {\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isMounted.current) {\n      const loadQueues = async () => {\n        const list = await findAllQueues();\n        setAllQueues(list);\n        setQueues(list);\n      };\n      loadQueues();\n    }\n  }, []);\n\n  // Buscar quickMessages quando o modal abrir\n  useEffect(() => {\n    if (open && user?.companyId) {\n      fetchQuickMessages();\n    }\n  }, [open, user?.companyId, user?.id]);\n\n  // Filtrar respostas rÃ¡pidas baseado na busca\n  useEffect(() => {\n    if (quickMessageSearch.trim() === \"\" && !showAllQuickMessages) {\n      setFilteredQuickMessages([]);\n    } else if (quickMessageSearch.trim() === \"\" && showAllQuickMessages) {\n      setFilteredQuickMessages(quickMessages);\n    } else {\n      const filtered = quickMessages.filter(qm => \n        qm.message.toLowerCase().includes(quickMessageSearch.toLowerCase()) ||\n        qm.shortcode.toLowerCase().includes(quickMessageSearch.toLowerCase())\n      );\n      setFilteredQuickMessages(filtered);\n    }\n  }, [quickMessageSearch, quickMessages, showAllQuickMessages]);\n\n  const fetchQuickMessages = async () => {\n    setLoadingQuickMessages(true);\n    try {\n      console.log(\"ðŸ” Buscando quickMessages com params:\", {\n        companyId: user?.companyId,\n        userId: user?.id,\n        isOficial: \"false\"\n      });\n\n      const { data } = await api.get(\"/quick-messages/list\", {\n        params: {\n          companyId: user?.companyId,\n          userId: user?.id,\n          isOficial: \"false\"\n        }\n      });\n\n      console.log(\"ðŸ“‹ Resposta da API quickMessages:\", data);\n      setQuickMessages(data || []);\n      setFilteredQuickMessages(data || []);\n    } catch (err) {\n      console.error(\"âŒ Erro ao buscar respostas rÃ¡pidas:\", err);\n      toastError(err);\n      setQuickMessages([]);\n      setFilteredQuickMessages([]);\n    } finally {\n      setLoadingQuickMessages(false);\n    }\n  };\n\n  // FunÃ§Ã£o para baixar mÃ­dia da quickMessage\n  const downloadQuickMessageMedia = async (mediaPath, mediaName, mediaType) => {\n    try {\n      // console.log(\"ðŸ“Ž Baixando mÃ­dia da quickMessage:\", { mediaPath, mediaName, mediaType });\n\n      // Construir URL correta usando a URL base do backend\n      const backendUrl = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8080';\n      const downloadUrl = `${backendUrl}/public/company${user?.companyId}/quickMessage/${mediaName}`;\n\n      // console.log(\"ðŸ”— URL de download:\", downloadUrl);\n\n      const response = await fetch(downloadUrl, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`Erro ao baixar mÃ­dia: ${response.status}`);\n      }\n\n      const blob = await response.blob();\n      const file = new File([blob], mediaName, {\n        type: blob.type || getMediaTypeFromExtension(mediaName, mediaType)\n      });\n\n      // console.log(\"âœ… MÃ­dia baixada com sucesso:\", file);\n      return file;\n    } catch (err) {\n      console.error(\"âŒ Erro ao baixar mÃ­dia da quickMessage:\", err);\n      toastError(err);\n      return null;\n    }\n  };\n\n  // FunÃ§Ã£o auxiliar para determinar o tipo MIME baseado na extensÃ£o\n  const getMediaTypeFromExtension = (fileName, mediaType) => {\n    const extension = fileName.split('.').pop().toLowerCase();\n\n    switch (mediaType) {\n      case 'image':\n        return `image/${extension === 'jpg' ? 'jpeg' : extension}`;\n      case 'audio':\n        return `audio/${extension}`;\n      case 'video':\n        return `video/${extension}`;\n      default:\n        return 'application/octet-stream';\n    }\n  };\n\n  useEffect(() => {\n    if (searchParam.length < 3) {\n      setLoading(false);\n      setSelectedQueue(\"\");\n      return;\n    }\n    const delayDebounceFn = setTimeout(() => {\n      setLoading(true);\n      const fetchUsers = async () => {\n        try {\n          const { data } = await api.get(\"/users/\");\n          setOptions(data.users);\n          setLoading(false);\n        } catch (err) {\n          setLoading(false);\n          toastError(err);\n        }\n      };\n\n      fetchUsers();\n    }, 500);\n    return () => clearTimeout(delayDebounceFn);\n  }, [searchParam]);\n\n  useEffect(() => {\n    api\n      .get(`/whatsapp/filter`, {\n        params: { session: 0, channel: channelFilter },\n      })\n      .then(({ data }) => {\n        const mappedWhatsapps = data.map((whatsapp) => ({\n          ...whatsapp,\n          selected: false,\n        }));\n\n        setWhatsapps(mappedWhatsapps);\n        if (mappedWhatsapps.length && mappedWhatsapps?.length === 1) {\n          setSelectedWhatsapps(mappedWhatsapps[0].id);\n        }\n      });\n  }, [currentContact, channelFilter]);\n\n  useEffect(() => {\n    if (contactId && contacts.length) {\n      const contact = contacts.find((c) => c.id === contactId);\n      if (contact) {\n        setCurrentContact(contact);\n      }\n    }\n  }, [contactId, contacts]);\n\n  // âœ… MELHORIA: UseEffect otimizado com melhor lÃ³gica de inicializaÃ§Ã£o\n  useEffect(() => {\n    const { companyId } = user;\n    if (open) {\n      try {\n        (async () => {\n          // Carregar lista de contatos\n          const { data: contactList } = await api.get(\"/contacts/list\", {\n            params: { companyId: companyId },\n          });\n\n          let customList = contactList.map((c) => ({\n            id: c.id,\n            name: c.name,\n            channel: c.channel,\n          }));\n\n          if (isArray(customList)) {\n            setContacts([{ id: \"\", name: \"\", channel: \"\" }, ...customList]);\n          }\n\n          // âœ… MELHORIA: LÃ³gica de inicializaÃ§Ã£o aprimorada\n          if (!scheduleId) {\n            // Modal sendo aberto para criar novo agendamento\n            const newScheduleState = {\n              ...initialState,\n              body: message || \"\", // âœ… Pre-popular mensagem\n              contactId: contactId || \"\", // âœ… Pre-popular contato\n            };\n\n            setSchedule(newScheduleState);\n\n            // âœ… MELHORIA: Se contactId foi fornecido, definir contato atual\n            if (contactId && customList.length > 0) {\n              const foundContact = customList.find((c) => c.id.toString() === contactId.toString());\n              if (foundContact) {\n                setCurrentContact(foundContact);\n                setChannelFilter(foundContact.channel || \"whatsapp\");\n                console.log(\"âœ… Contato auto-selecionado:\", foundContact.name);\n              }\n            }\n\n            return;\n          }\n\n          // âœ… Carregamento de agendamento existente (lÃ³gica original)\n          const { data } = await api.get(`/schedules/${scheduleId}`);\n          setSchedule((prevState) => {\n            return {\n              ...prevState,\n              ...data,\n              sendAt: moment(data.sendAt).format(\"YYYY-MM-DDTHH:mm\"),\n              // âœ… Incluir campos de lembrete no carregamento\n              reminderDate: data.reminderDate ? moment(data.reminderDate).format(\"YYYY-MM-DDTHH:mm\") : \"\",\n            };\n          });\n\n          console.log(\"ðŸ“… Agendamento carregado:\", data);\n\n          if (data.whatsapp) {\n            setSelectedWhatsapps(data.whatsapp.id);\n          }\n\n          if (!isAdmin && data.ticketUser) {\n            setSelectedUser(data.ticketUser);\n          }\n\n          if (data.queueId) {\n            setSelectedQueue(data.queueId);\n          }\n\n          if (data.intervalo) {\n            setIntervalo(data.intervalo);\n          }\n\n          if (data.tipoDias) {\n            setTipoDias(data.tipoDias);\n          }\n\n          setCurrentContact(data.contact);\n        })();\n      } catch (err) {\n        toastError(err);\n      }\n    }\n  }, [scheduleId, contactId, open, user, message, fromMessageInput]);\n\n  const filterOptions = createFilterOptions({\n    trim: true,\n  });\n\n  const handleClose = () => {\n    onClose();\n    setAttachment(null);\n    setSchedule(initialState);\n    // âœ… MELHORIA: Reset do contato atual ao fechar\n    setCurrentContact(initialContact);\n    // Reset do dropdown de quickMessages\n    setSelectedQuickMessage(\"\");\n    setQuickMessageSearch(\"\");\n    setShowAllQuickMessages(false);\n    setFilteredQuickMessages([]);\n    setQuickMessageMedia(null);\n    // âœ… Reset dos campos de lembrete\n    setSchedule(prevState => ({\n      ...prevState,\n      reminderDate: \"\",\n    }));\n  };\n\n  const handleAttachmentFile = (e) => {\n    const file = head(e.target.files);\n    if (file) {\n      setAttachment(file);\n    }\n  };\n\n  const IconChannel = (channel) => {\n    switch (channel) {\n      case \"facebook\":\n        return (\n          <Facebook style={{ color: \"#3b5998\", verticalAlign: \"middle\" }} />\n        );\n      case \"instagram\":\n        return (\n          <Instagram style={{ color: \"#e1306c\", verticalAlign: \"middle\" }} />\n        );\n      case \"whatsapp\":\n        return (\n          <WhatsApp style={{ color: \"#25d366\", verticalAlign: \"middle\" }} />\n        );\n      default:\n        return \"error\";\n    }\n  };\n\n  const renderOption = (option) => {\n    if (option.name) {\n      return (\n        <>\n          {IconChannel(option.channel)}\n          <Typography\n            component=\"span\"\n            style={{\n              fontSize: 14,\n              marginLeft: \"10px\",\n              display: \"inline-flex\",\n              alignItems: \"center\",\n              lineHeight: \"2\",\n            }}\n          >\n            {option.name}\n          </Typography>\n        </>\n      );\n    } else {\n      return `${i18n.t(\"newTicketModal.add\")} ${option.name}`;\n    }\n  };\n\n  const handleSaveSchedule = async (values) => {\n    const scheduleData = {\n      ...values,\n      userId: user.id,\n      whatsappId: selectedWhatsapps,\n      ticketUserId: selectedUser?.id || null,\n      queueId: selectedQueue || null,\n      intervalo: intervalo || 1,\n      tipoDias: tipoDias || 4,\n      // âœ… Incluir dados do lembrete\n      reminderDate: values.reminderDate || null,\n    };\n\n    try {\n      if (scheduleId) {\n        await api.put(`/schedules/${scheduleId}`, scheduleData);\n        if (attachment != null) {\n          const formData = new FormData();\n          formData.append(\"file\", attachment);\n          await api.post(`/schedules/${scheduleId}/media-upload`, formData);\n        }\n      } else {\n        const { data } = await api.post(\"/schedules\", scheduleData);\n        if (attachment != null) {\n          const formData = new FormData();\n          formData.append(\"file\", attachment);\n          await api.post(`/schedules/${data.id}/media-upload`, formData);\n        }\n      }\n\n      toast.success(i18n.t(\"scheduleModal.success\"));\n\n      if (typeof reload == \"function\") {\n        reload();\n      }\n\n      if (contactId) {\n        if (typeof cleanContact === \"function\") {\n          cleanContact();\n          history.push(\"/schedules\");\n        }\n      }\n    } catch (err) {\n      toastError(err);\n    }\n\n    setCurrentContact(initialContact);\n    setSchedule(initialState);\n    // âœ… Reset dos campos de lembrete apÃ³s salvar\n    setSchedule(prevState => ({\n      ...prevState,\n      reminderDate: \"\",\n    }));\n    handleClose();\n  };\n\n  const handleClickMsgVar = async (msgVar, setValueFunc) => {\n    const el = messageInputRef.current;\n    const firstHalfText = el.value.substring(0, el.selectionStart);\n    const secondHalfText = el.value.substring(el.selectionEnd);\n    const newCursorPos = el.selectionStart + msgVar.length;\n\n    setValueFunc(\"body\", `${firstHalfText}${msgVar}${secondHalfText}`);\n\n    await new Promise((r) => setTimeout(r, 100));\n    messageInputRef.current.setSelectionRange(newCursorPos, newCursorPos);\n  };\n\n  // FunÃ§Ã£o para lidar com seleÃ§Ã£o de resposta rÃ¡pida\n  const handleQuickMessageSelect = async (selectedMessage, setFieldValue) => {\n    console.log(\"ðŸŽ¯ Mensagem selecionada:\", selectedMessage);\n    \n    if (selectedMessage) {\n      console.log(\"âœ… Preenchendo campo body com:\", selectedMessage.message);\n      setFieldValue(\"body\", selectedMessage.message || \"\");\n      setQuickMessageSearch(selectedMessage.message || \"\");\n\n      // Se a mensagem tem mÃ­dia, baixar e definir como attachment\n      if (selectedMessage.mediaPath) {\n        console.log(\"ðŸ“Ž Mensagem com mÃ­dia:\", selectedMessage.mediaPath);\n\n        try {\n          const mediaFile = await downloadQuickMessageMedia(\n            selectedMessage.mediaPath,\n            selectedMessage.mediaName,\n            selectedMessage.mediaType\n          );\n\n          if (mediaFile) {\n            setAttachment(mediaFile);\n            setQuickMessageMedia({\n              path: selectedMessage.mediaPath,\n              name: selectedMessage.mediaName,\n              type: selectedMessage.mediaType\n            });\n            console.log(\"âœ… MÃ­dia da quickMessage definida como attachment:\", mediaFile);\n          }\n        } catch (err) {\n          console.error(\"âŒ Erro ao processar mÃ­dia da quickMessage:\", err);\n        }\n      } else {\n        // Limpar mÃ­dia anterior se nÃ£o hÃ¡ mÃ­dia na nova seleÃ§Ã£o\n        setQuickMessageMedia(null);\n        setAttachment(null);\n        if (attachmentFile.current) {\n          attachmentFile.current.value = null;\n        }\n      }\n    }\n  };\n\n  const deleteMedia = async () => {\n    if (attachment) {\n      setAttachment(null);\n      attachmentFile.current.value = null;\n    }\n\n    // Limpar mÃ­dia da quickMessage se existir\n    if (quickMessageMedia) {\n      setQuickMessageMedia(null);\n    }\n\n    if (schedule.mediaPath) {\n      await api.delete(`/schedules/${schedule.id}/media-upload`);\n      setSchedule((prev) => ({\n        ...prev,\n        mediaPath: null,\n      }));\n      toast.success(i18n.t(\"scheduleModal.toasts.deleted\"));\n      if (typeof reload == \"function\") {\n        console.log(reload);\n        console.log(\"1\");\n        reload();\n      }\n    }\n  };\n\n  return (\n    <div className={classes.root}>\n      <ConfirmationModal\n        title={i18n.t(\"scheduleModal.confirmationModal.deleteTitle\")}\n        open={confirmationOpen}\n        onClose={() => setConfirmationOpen(false)}\n        onConfirm={deleteMedia}\n      >\n        {i18n.t(\"scheduleModal.confirmationModal.deleteMessage\")}\n      </ConfirmationModal>\n      <Dialog\n        open={open}\n        onClose={handleClose}\n        maxWidth=\"md\"\n        fullWidth\n        scroll=\"paper\"\n      >\n        <DialogTitle id=\"form-dialog-title\">\n          {schedule.status === \"ERRO\"\n            ? \"Erro de Envio\"\n            : `Mensagem ${capitalize(schedule.status)}`}\n        </DialogTitle>\n        <div style={{ display: \"none\" }}>\n          <input\n            type=\"file\"\n            accept=\".png,.jpg,.jpeg\"\n            ref={attachmentFile}\n            onChange={(e) => handleAttachmentFile(e)}\n          />\n        </div>\n        <Formik\n          initialValues={schedule}\n          enableReinitialize={true}\n          validationSchema={ScheduleSchema}\n          onSubmit={(values, actions) => {\n            setTimeout(() => {\n              handleSaveSchedule(values);\n              actions.setSubmitting(false);\n            }, 400);\n          }}\n        >\n          {({ touched, errors, isSubmitting, values, setFieldValue }) => (\n            <Form>\n              <DialogContent dividers>\n                <Grid container spacing={1}>\n                  <Grid item xs={12} md={6} xl={6}>\n                    <div className={classes.multFieldLine}>\n                      <FormControl variant=\"outlined\" fullWidth>\n                        <Autocomplete\n                          fullWidth\n                          value={currentContact}\n                          options={contacts}\n                          onChange={(e, contact) => {\n                            const contactId = contact ? contact.id : \"\";\n                            setSchedule({ ...schedule, contactId });\n                            setCurrentContact(contact ? contact : initialContact);\n                            setChannelFilter(\n                              contact ? contact.channel : \"whatsapp\"\n                            );\n                          }}\n                          getOptionLabel={(option) => option.name}\n                          renderOption={renderOption}\n                          getOptionSelected={(option, value) => {\n                            return value.id === option.id;\n                          }}\n                          renderInput={(params) => (\n                            <TextField\n                              {...params}\n                              variant=\"outlined\"\n                              placeholder=\"Contato\"\n                            />\n                          )}\n                        />\n                      </FormControl>\n                    </div>\n                  </Grid>\n                  <Grid item xs={12} md={6} xl={6}>\n                    <Field\n                      as={TextField}\n                      label={i18n.t(\"scheduleModal.form.sendAt\")}\n                      type=\"datetime-local\"\n                      name=\"sendAt\"\n                      error={touched.sendAt && Boolean(errors.sendAt)}\n                      helperText={touched.sendAt && errors.sendAt}\n                      variant=\"outlined\"\n                      fullWidth\n                      size=\"small\"\n                      style={{ marginTop: \"8px\" }}\n                    />\n                  </Grid>\n                </Grid>\n                <div className={classes.multFieldLine}>\n                  <Field\n                    as={TextField}\n                    rows={9}\n                    multiline={true}\n                    label={i18n.t(\"scheduleModal.form.body\")}\n                    name=\"body\"\n                    inputRef={messageInputRef}\n                    error={touched.body && Boolean(errors.body)}\n                    helperText={touched.body && errors.body}\n                    variant=\"outlined\"\n                    margin=\"dense\"\n                    fullWidth\n                  />\n                </div>\n\n                {/* Campo de Busca de Respostas RÃ¡pidas */}\n                <div className={classes.multFieldLine}>\n                  <TextField\n                    variant=\"outlined\"\n                    fullWidth\n                    margin=\"dense\"\n                    label={i18n.t(\"ticketInfo.quickMessages\")}\n                    placeholder=\"Digite para buscar respostas rÃ¡pidas...\"\n                    value={quickMessageSearch}\n                    onChange={(e) => {\n                      setQuickMessageSearch(e.target.value);\n                      if (e.target.value.trim() === \"\") {\n                        setShowAllQuickMessages(false);\n                      }\n                    }}\n                    onFocus={() => {\n                      if (quickMessageSearch.trim() === \"\" && !showAllQuickMessages) {\n                        setShowAllQuickMessages(true);\n                      }\n                    }}\n                    onClick={() => {\n                      if (quickMessageSearch.trim() === \"\" && !showAllQuickMessages) {\n                        setShowAllQuickMessages(true);\n                      }\n                    }}\n                    disabled={loadingQuickMessages}\n                    InputProps={{\n                      startAdornment: <FlashOn style={{ marginRight: '8px', color: '#1976d2' }} />,\n                    }}\n                  />\n                  \n                  {/* Lista de sugestÃµes */}\n                  {((quickMessageSearch && filteredQuickMessages.length > 0) || (showAllQuickMessages && filteredQuickMessages.length > 0)) && (\n                    <div style={{ \n                      maxHeight: '200px', \n                      overflowY: 'auto', \n                      border: '1px solid #e0e0e0', \n                      borderRadius: '4px', \n                      marginTop: '4px',\n                      backgroundColor: 'white',\n                      zIndex: 1000,\n                      position: 'relative'\n                    }}>\n                      {filteredQuickMessages.map((quickMessage) => (\n                        <div\n                          key={quickMessage.id}\n                          onClick={() => handleQuickMessageSelect(quickMessage, setFieldValue)}\n                          style={{\n                            padding: '12px',\n                            cursor: 'pointer',\n                            borderBottom: '1px solid #f0f0f0',\n                            display: 'flex',\n                            alignItems: 'center',\n                            gap: '8px'\n                          }}\n                          onMouseEnter={(e) => e.target.style.backgroundColor = '#f5f5f5'}\n                          onMouseLeave={(e) => e.target.style.backgroundColor = 'white'}\n                        >\n                          <FlashOn style={{ fontSize: '16px', color: '#1976d2' }} />\n                          <div style={{ flex: 1 }}>\n                            <div style={{ fontWeight: 'bold', fontSize: '14px' }}>\n                              {quickMessage.shortcode}\n                            </div>\n                            <div style={{ \n                              fontSize: '12px', \n                              color: '#666', \n                              maxWidth: '300px', \n                              overflow: 'hidden', \n                              textOverflow: 'ellipsis', \n                              whiteSpace: 'nowrap' \n                            }}>\n                              {quickMessage.message}\n                            </div>\n                          </div>\n                          {quickMessage.mediaPath && (\n                            <AttachFile style={{ fontSize: '14px', color: '#666' }} />\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  \n                  {/* Mensagem quando nÃ£o hÃ¡ resultados */}\n                  {quickMessageSearch && filteredQuickMessages.length === 0 && !loadingQuickMessages && (\n                    <div style={{ \n                      padding: '12px', \n                      textAlign: 'center', \n                      color: '#666', \n                      fontStyle: 'italic',\n                      border: '1px solid #e0e0e0', \n                      borderRadius: '4px', \n                      marginTop: '4px'\n                    }}>\n                      Nenhuma resposta rÃ¡pida encontrada\n                    </div>\n                  )}\n                </div>\n\n                <Grid item xs={12} md={12} xl={12}>\n                  <MessageVariablesPicker\n                    disabled={isSubmitting}\n                    showSchedulingVars={true}\n                    onClick={(value) => handleClickMsgVar(value, setFieldValue)}\n                  />\n                </Grid>\n                <Grid container spacing={1}>\n                  <Grid item xs={12} md={6} xl={3}>\n                    <FormControl\n                      variant=\"outlined\"\n                      margin=\"dense\"\n                      fullWidth\n                      className={classes.formControl}\n                    >\n                      <InputLabel id=\"whatsapp-selection-label\">\n                        {i18n.t(\"campaigns.dialog.form.whatsapp\")}\n                      </InputLabel>\n                      <Field\n                        as={Select}\n                        label={i18n.t(\"campaigns.dialog.form.whatsapp\")}\n                        placeholder={i18n.t(\"campaigns.dialog.form.whatsapp\")}\n                        labelId=\"whatsapp-selection-label\"\n                        id=\"whatsappIds\"\n                        name=\"whatsappIds\"\n                        required\n                        error={touched.whatsappId && Boolean(errors.whatsappId)}\n                        value={selectedWhatsapps}\n                        onChange={(event) =>\n                          setSelectedWhatsapps(event.target.value)\n                        }\n                      >\n                        {whatsapps &&\n                          whatsapps.map((whatsapp) => (\n                            <MenuItem key={whatsapp.id} value={whatsapp.id}>\n                              {whatsapp.name}\n                            </MenuItem>\n                          ))}\n                      </Field>\n                    </FormControl>\n                  </Grid>\n                  <Grid item xs={12} md={12} xl={3}>\n                    <FormControl\n                      variant=\"outlined\"\n                      margin=\"dense\"\n                      fullWidth\n                      className={classes.formControl}\n                    >\n                      <InputLabel id=\"openTicket-selection-label\">\n                        {i18n.t(\"campaigns.dialog.form.openTicket\")}\n                      </InputLabel>\n                      <Field\n                        as={Select}\n                        label={i18n.t(\"campaigns.dialog.form.openTicket\")}\n                        placeholder={i18n.t(\"campaigns.dialog.form.openTicket\")}\n                        labelId=\"openTicket-selection-label\"\n                        id=\"openTicket\"\n                        name=\"openTicket\"\n                        error={touched.openTicket && Boolean(errors.openTicket)}\n                      >\n                        <MenuItem value={\"enabled\"}>\n                          {i18n.t(\"campaigns.dialog.form.enabledOpenTicket\")}\n                        </MenuItem>\n                        <MenuItem value={\"disabled\"}>\n                          {i18n.t(\"campaigns.dialog.form.disabledOpenTicket\")}\n                        </MenuItem>\n                      </Field>\n                    </FormControl>\n                  </Grid>\n                </Grid>\n                <Grid spacing={1} container>\n                  <Grid item xs={12} md={6} xl={4}>\n                    <Autocomplete\n                      style={{ marginTop: \"8px\" }}\n                      variant=\"outlined\"\n                      margin=\"dense\"\n                      className={classes.formControl}\n                      getOptionLabel={(option) => `${option.name}`}\n                      value={isAdmin ? selectedUser : user}\n                      size=\"small\"\n                      onChange={(e, newValue) => {\n                        if (isAdmin) {\n                          setSelectedUser(newValue);\n                          if (newValue != null && Array.isArray(newValue.queues)) {\n                            if (newValue.queues.length === 1) {\n                              setSelectedQueue(newValue.queues[0].id);\n                            }\n                            setQueues(newValue.queues);\n                          } else {\n                            setQueues(allQueues);\n                            setSelectedQueue(\"\");\n                          }\n                        }\n                      }}\n                      options={isAdmin ? options : [user]}\n                      filterOptions={filterOptions}\n                      freeSolo={isAdmin}\n                      fullWidth\n                      disabled={values.openTicket === \"disabled\" || !isAdmin}\n                      autoHighlight\n                      noOptionsText={i18n.t(\"transferTicketModal.noOptions\")}\n                      loading={loading}\n                      renderOption={(option) => (\n                        <span>\n                          {\" \"}\n                          <UserStatusIcon user={option} /> {option.name}\n                        </span>\n                      )}\n                      renderInput={(params) => (\n                        <TextField\n                          {...params}\n                          label={i18n.t(\"transferTicketModal.fieldLabel\")}\n                          variant=\"outlined\"\n                          onChange={isAdmin ? (e) => setSearchParam(e.target.value) : undefined} // SÃ³ busca se for admin\n                          InputProps={{\n                            ...params.InputProps,\n                            endAdornment: (\n                              <React.Fragment>\n                                {loading ? (\n                                  <CircularProgress color=\"inherit\" size={20} />\n                                ) : null}\n                                {params.InputProps.endAdornment}\n                              </React.Fragment>\n                            ),\n                            readOnly: !isAdmin, // Modo somente leitura se nÃ£o for admin\n                          }}\n                        />\n                      )}\n                    />\n                  </Grid>\n\n                  <Grid item xs={12} md={6} xl={6}>\n                    <FormControl\n                      variant=\"outlined\"\n                      margin=\"dense\"\n                      fullWidth\n                      className={classes.formControl}\n                    >\n                      <InputLabel>\n                        {i18n.t(\"transferTicketModal.fieldQueueLabel\")}\n                      </InputLabel>\n                      <Select\n                        value={selectedQueue}\n                        onChange={(e) => setSelectedQueue(e.target.value)}\n                        label={i18n.t(\n                          \"transferTicketModal.fieldQueuePlaceholder\"\n                        )}\n                        disabled={values.openTicket === \"disabled\"}\n                      >\n                        {queues.map((queue) => (\n                          <MenuItem key={queue.id} value={queue.id}>\n                            {queue.name}\n                          </MenuItem>\n                        ))}\n                      </Select>\n                    </FormControl>\n                  </Grid>\n                </Grid>\n                <Grid spacing={1} container style={{ marginTop: \"-10px\" }}>\n                  <Grid item xs={12} md={6} xl={6}>\n                    <FormControl\n                      variant=\"outlined\"\n                      margin=\"dense\"\n                      fullWidth\n                      className={classes.formControl}\n                    >\n                      <InputLabel id=\"statusTicket-selection-label\">\n                        {i18n.t(\"campaigns.dialog.form.statusTicket\")}\n                      </InputLabel>\n                      <Field\n                        as={Select}\n                        disabled={values.openTicket === \"disabled\"}\n                        label={i18n.t(\"campaigns.dialog.form.statusTicket\")}\n                        placeholder={i18n.t(\n                          \"campaigns.dialog.form.statusTicket\"\n                        )}\n                        labelId=\"statusTicket-selection-label\"\n                        id=\"statusTicket\"\n                        name=\"statusTicket\"\n                        error={\n                          touched.statusTicket && Boolean(errors.statusTicket)\n                        }\n                      >\n                        <MenuItem value={\"closed\"}>\n                          {i18n.t(\"campaigns.dialog.form.closedTicketStatus\")}\n                        </MenuItem>\n                        <MenuItem value={\"open\"}>\n                          {i18n.t(\"campaigns.dialog.form.openTicketStatus\")}\n                        </MenuItem>\n                      </Field>\n                    </FormControl>\n                  </Grid>\n\n                  <Grid item xs={12} md={6} xl={6}>\n                    <FormControlLabel\n                      control={\n                        <Field\n                          as={Switch}\n                          color=\"primary\"\n                          name=\"assinar\"\n                          checked={values.assinar}\n                          disabled={values.openTicket === \"disabled\"}\n                        />\n                      }\n                      label={i18n.t(\"scheduleModal.form.assinar\")}\n                    />\n                  </Grid>\n                </Grid>\n                <br />\n                <Grid container spacing={1}>\n                  {/* SeÃ§Ã£o de Lembrete */}\n                  <h3>Lembrete (Opcional)</h3>\n                  <p>Defina uma data de lembrete. A mensagem serÃ¡ enviada no horÃ¡rio do lembrete em vez do horÃ¡rio original do agendamento</p>\n                  <br />\n                  <Grid container spacing={1}>\n                    <Grid item xs={12} md={6} xl={6}>\n                      <Field\n                        as={TextField}\n                        label=\"Data do Lembrete\"\n                        type=\"datetime-local\"\n                        name=\"reminderDate\"\n                        error={touched.reminderDate && Boolean(errors.reminderDate)}\n                        helperText={touched.reminderDate && errors.reminderDate}\n                        variant=\"outlined\"\n                        fullWidth\n                        size=\"small\"\n                        InputLabelProps={{ shrink: true }}\n                      />\n                    </Grid>\n                    <Grid item xs={12} md={6} xl={6}>\n                      <Typography variant=\"body2\" color=\"textSecondary\" style={{ padding: '16px', backgroundColor: '#f5f5f5', borderRadius: '4px', marginTop: '8px' }}>\n                        A mensagem do lembrete serÃ¡ a mesma da mensagem agendada.\n                      </Typography>\n                    </Grid>\n                  </Grid>\n                </Grid>\n                <br />\n\n                <h3>{i18n.t(\"recurrenceSection.title\")}</h3>\n                <p>{i18n.t(\"recurrenceSection.description\")}</p>\n                <br />\n                <Grid container spacing={1}>\n                  <Grid item xs={12} md={4} xl={4}>\n                    <FormControl size=\"small\" fullWidth variant=\"outlined\">\n                      <InputLabel id=\"demo-simple-select-label\">\n                        {i18n.t(\"recurrenceSection.labelInterval\")}\n                      </InputLabel>\n                      <Select\n                        labelId=\"demo-simple-select-label\"\n                        id=\"demo-simple-select\"\n                        value={intervalo}\n                        onChange={(e) => setIntervalo(e.target.value || 1)}\n                        label={i18n.t(\"recurrenceSection.labelInterval\")}\n                      >\n                        <MenuItem value={1}>\n                          {i18n.t(\"recurrenceSection.options.days\")}\n                        </MenuItem>\n                        <MenuItem value={2}>\n                          {i18n.t(\"recurrenceSection.options.weeks\")}\n                        </MenuItem>\n                        <MenuItem value={3}>\n                          {i18n.t(\"recurrenceSection.options.months\")}\n                        </MenuItem>\n                        <MenuItem value={4}>\n                          {i18n.t(\"recurrenceSection.options.minutes\")}\n                        </MenuItem>\n                      </Select>\n                    </FormControl>\n                  </Grid>\n\n                  <Grid item xs={12} md={4} xl={4}>\n                    <Field\n                      as={TextField}\n                      label={i18n.t(\"recurrenceSection.intervalFilterValue\")}\n                      name=\"valorIntervalo\"\n                      size=\"small\"\n                      error={\n                        touched.valorIntervalo && Boolean(errors.valorIntervalo)\n                      }\n                      InputLabelProps={{ shrink: true }}\n                      variant=\"outlined\"\n                      fullWidth\n                    />\n                  </Grid>\n                  <Grid item xs={12} md={4} xl={4}>\n                    <Field\n                      as={TextField}\n                      label={i18n.t(\"recurrenceSection.sendAsManyTimes\")}\n                      name=\"enviarQuantasVezes\"\n                      size=\"small\"\n                      error={\n                        touched.enviarQuantasVezes &&\n                        Boolean(errors.enviarQuantasVezes)\n                      }\n                      variant=\"outlined\"\n                      fullWidth\n                    />\n                  </Grid>\n                  <Grid item xs={12} md={12} xl={12}>\n                    <FormControl size=\"small\" fullWidth variant=\"outlined\">\n                      <InputLabel id=\"demo-simple-select-label\">\n                        {i18n.t(\"recurrenceSection.sendAsManyTimes\")}\n                      </InputLabel>\n                      <Select\n                        labelId=\"demo-simple-select-label\"\n                        id=\"demo-simple-select\"\n                        value={tipoDias}\n                        onChange={(e) => setTipoDias(e.target.value || 4)}\n                        label=\"Enviar quantas vezes\"\n                      >\n                        <MenuItem value={4}>\n                          {i18n.t(\n                            \"recurrenceSection.shipNormallyOnNonbusinessDays\"\n                          )}\n                        </MenuItem>\n                        <MenuItem value={5}>\n                          {i18n.t(\"recurrenceSection.sendOneBusinessDayBefore\")}\n                        </MenuItem>\n                        <MenuItem value={6}>\n                          {\" \"}\n                          {i18n.t(\"recurrenceSection.sendOneBusinessDayLater\")}\n                        </MenuItem>\n                      </Select>\n                    </FormControl>\n                  </Grid>\n                </Grid>\n                {(schedule.mediaPath || attachment || quickMessageMedia) && (\n                  <Grid xs={12} item>\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                      <Button startIcon={<AttachFile />}>\n                        {attachment ? attachment.name :\n                          quickMessageMedia ? quickMessageMedia.name :\n                            schedule.mediaName}\n                      </Button>\n                      {quickMessageMedia && (\n                        <Chip\n                          label=\"Da Resposta RÃ¡pida\"\n                          size=\"small\"\n                          color=\"primary\"\n                          variant=\"outlined\"\n                        />\n                      )}\n                      <IconButton\n                        onClick={() => setConfirmationOpen(true)}\n                        color=\"secondary\"\n                      >\n                        <DeleteOutline color=\"secondary\" />\n                      </IconButton>\n                    </div>\n                  </Grid>\n                )}\n              </DialogContent>\n              <DialogActions>\n                {!attachment && !schedule.mediaPath && !quickMessageMedia && (\n                  <Button\n                    color=\"primary\"\n                    onClick={() => attachmentFile.current.click()}\n                    disabled={isSubmitting}\n                    variant=\"outlined\"\n                  >\n                    {i18n.t(\"quickMessages.buttons.attach\")}\n                  </Button>\n                )}\n                <Button\n                  onClick={handleClose}\n                  color=\"secondary\"\n                  disabled={isSubmitting}\n                  variant=\"outlined\"\n                >\n                  {i18n.t(\"scheduleModal.buttons.cancel\")}\n                </Button>\n                {(schedule.sentAt === null || schedule.sentAt === \"\") && (\n                  <Button\n                    type=\"submit\"\n                    color=\"primary\"\n                    disabled={isSubmitting}\n                    variant=\"contained\"\n                    className={classes.btnWrapper}\n                  >\n                    {scheduleId\n                      ? `${i18n.t(\"scheduleModal.buttons.okEdit\")}`\n                      : `${i18n.t(\"scheduleModal.buttons.okAdd\")}`}\n                    {isSubmitting && (\n                      <CircularProgress\n                        size={24}\n                        className={classes.buttonProgress}\n                      />\n                    )}\n                  </Button>\n                )}\n              </DialogActions>\n            </Form>\n          )}\n        </Formik>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default ScheduleModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}