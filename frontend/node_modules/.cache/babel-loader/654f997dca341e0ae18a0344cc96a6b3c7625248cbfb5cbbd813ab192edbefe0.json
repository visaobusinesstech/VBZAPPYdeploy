{"ast":null,"code":"import _objectSpread from\"/home/deploy/codigologlow/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/pages/Contacts/index.js (versão corrigida)\nimport React,{useState,useEffect,useReducer,useContext,useRef}from\"react\";import{toast}from\"react-toastify\";import{useHistory}from\"react-router-dom\";import{makeStyles}from\"@material-ui/core/styles\";import Table from\"@material-ui/core/Table\";import TableBody from\"@material-ui/core/TableBody\";import TableCell from\"@material-ui/core/TableCell\";import TableHead from\"@material-ui/core/TableHead\";import TableRow from\"@material-ui/core/TableRow\";import Paper from\"@material-ui/core/Paper\";import Button from\"@material-ui/core/Button\";import Avatar from\"@material-ui/core/Avatar\";import Dialog from\"@material-ui/core/Dialog\";import DialogContent from\"@material-ui/core/DialogContent\";import DialogTitle from\"@material-ui/core/DialogTitle\";import{Facebook,Instagram,WhatsApp,Close}from\"@material-ui/icons\";import SearchIcon from\"@material-ui/icons/Search\";import TextField from\"@material-ui/core/TextField\";import InputAdornment from\"@material-ui/core/InputAdornment\";import IconButton from\"@material-ui/core/IconButton\";import DeleteOutlineIcon from\"@material-ui/icons/DeleteOutline\";import EditIcon from\"@material-ui/icons/Edit\";import CheckCircleIcon from\"@material-ui/icons/CheckCircle\";import CancelIcon from\"@material-ui/icons/Cancel\";import BlockIcon from\"@material-ui/icons/Block\";import Checkbox from\"@material-ui/core/Checkbox\";import Toolbar from\"@material-ui/core/Toolbar\";import Typography from\"@material-ui/core/Typography\";import Tooltip from\"@material-ui/core/Tooltip\";import{alpha}from\"@material-ui/core/styles\";import api from\"../../services/api\";import TableRowSkeleton from\"../../components/TableRowSkeleton\";import ContactModal from\"../../components/ContactModal\";import ConfirmationModal from\"../../components/ConfirmationModal/\";import ContactDeleteConfirmModal from\"../../components/ContactDeleteConfirmModal\";import{i18n}from\"../../translate/i18n\";import MainHeader from\"../../components/MainHeader\";import Title from\"../../components/Title\";import MainHeaderButtonsWrapper from\"../../components/MainHeaderButtonsWrapper\";import MainContainer from\"../../components/MainContainer\";import toastError from\"../../errors/toastError\";import{AuthContext}from\"../../context/Auth/AuthContext\";import{Can}from\"../../components/Can\";import NewTicketModal from\"../../components/NewTicketModal\";import{TagsFilter}from\"../../components/TagsFilter\";import PopupState,{bindTrigger,bindMenu}from\"material-ui-popup-state\";import formatSerializedId from\"../../utils/formatSerializedId\";import{v4 as uuidv4}from\"uuid\";import{ArrowDropDown,Backup,ContactPhone,DeleteSweep}from\"@material-ui/icons\";import{Menu,MenuItem}from\"@material-ui/core\";import ContactImportWpModal from\"../../components/ContactImportWpModal\";import useCompanySettings from\"../../hooks/useSettings/companySettings\";import{TicketsContext}from\"../../context/Tickets/TicketsContext\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const reducer=(state,action)=>{if(action.type===\"LOAD_CONTACTS\"){const contacts=action.payload;const newContacts=[];contacts.forEach(contact=>{const contactIndex=state.findIndex(c=>c.id===contact.id);if(contactIndex!==-1){state[contactIndex]=contact;}else{newContacts.push(contact);}});return[...state,...newContacts];}if(action.type===\"UPDATE_CONTACTS\"){const contact=action.payload;const contactIndex=state.findIndex(c=>c.id===contact.id);if(contactIndex!==-1){state[contactIndex]=contact;return[...state];}else{return[contact,...state];}}if(action.type===\"DELETE_CONTACT\"){const contactId=action.payload;const contactIndex=state.findIndex(c=>c.id===contactId);if(contactIndex!==-1){state.splice(contactIndex,1);}return[...state];}if(action.type===\"BULK_DELETE_CONTACTS\"){const contactIds=action.payload;return state.filter(contact=>!contactIds.includes(contact.id));}if(action.type===\"DELETE_ALL_CONTACTS\"){const{excludeIds=[]}=action.payload;return state.filter(contact=>excludeIds.includes(contact.id));}if(action.type===\"RESET\"){return[];}if(action.type===\"SET_TOTAL_COUNT\"){// Não altera o estado, mas permite rastrear o total\nreturn state;}};const useStyles=makeStyles(theme=>({mainPaper:_objectSpread({flex:1,padding:theme.spacing(1),overflowY:\"scroll\"},theme.scrollbarStyles),avatarCell:{width:'60px',padding:theme.spacing(1)},idCell:{width:'80px'},checkboxCell:{width:'48px',padding:theme.spacing(0,1)},clickableAvatar:{cursor:'pointer',transition:'transform 0.2s ease-in-out','&:hover':{transform:'scale(1.1)'}},imageDialog:{'& .MuiDialog-paper':{maxWidth:'500px',maxHeight:'500px'}},dialogTitle:{display:'flex',justifyContent:'space-between',alignItems:'center',paddingBottom:theme.spacing(1)},profileImage:{width:'100%',height:'auto',maxWidth:'400px',maxHeight:'400px',objectFit:'contain'},toolbar:{paddingLeft:theme.spacing(2),paddingRight:theme.spacing(1),backgroundColor:alpha(theme.palette.primary.main,0.12),minHeight:48},toolbarHighlight:{backgroundColor:alpha(theme.palette.primary.main,0.25)},toolbarTitle:{flex:'1 1 100%',fontWeight:600},bulkActions:{display:'flex',gap:theme.spacing(1)}}));const Contacts=()=>{const classes=useStyles();const history=useHistory();const{user,socket}=useContext(AuthContext);const[loading,setLoading]=useState(false);const[pageNumber,setPageNumber]=useState(1);const[searchParam,setSearchParam]=useState(\"\");const[contacts,dispatch]=useReducer(reducer,[]);const[selectedContactId,setSelectedContactId]=useState(null);const[contactModalOpen,setContactModalOpen]=useState(false);const[totalContactsCount,setTotalContactsCount]=useState(0);// Estados para seleção múltipla\nconst[selectedContacts,setSelectedContacts]=useState(new Set());const[selectAllMode,setSelectAllMode]=useState(false);// true = todos da empresa, false = apenas da página\nconst[importContactModalOpen,setImportContactModalOpen]=useState(false);const[deletingContact,setDeletingContact]=useState(null);const[ImportContacts,setImportContacts]=useState(null);const[blockingContact,setBlockingContact]=useState(null);const[unBlockingContact,setUnBlockingContact]=useState(null);const[confirmOpen,setConfirmOpen]=useState(false);const[exportContact,setExportContact]=useState(false);const[confirmChatsOpen,setConfirmChatsOpen]=useState(false);const[hasMore,setHasMore]=useState(false);const[newTicketModalOpen,setNewTicketModalOpen]=useState(false);const[contactTicket,setContactTicket]=useState({});// Estados para exclusão múltipla com confirmação tipada\nconst[deleteConfirmModalOpen,setDeleteConfirmModalOpen]=useState(false);const[deleteType,setDeleteType]=useState('');// 'selected' ou 'all'\nconst fileUploadRef=useRef(null);const[selectedTags,setSelectedTags]=useState([]);const{setCurrentTicket}=useContext(TicketsContext);// Estados para o modal de imagem\nconst[imageModalOpen,setImageModalOpen]=useState(false);const[selectedImage,setSelectedImage]=useState('');const[selectedContactName,setSelectedContactName]=useState('');const{getAll:getAllSettings}=useCompanySettings();const[hideNum,setHideNum]=useState(false);const[enableLGPD,setEnableLGPD]=useState(false);useEffect(()=>{async function fetchData(){const settingList=await getAllSettings(user.companyId);for(const[key,value]of Object.entries(settingList)){if(key===\"enableLGPD\")setEnableLGPD(value===\"enabled\");if(key===\"lgpdHideNumber\")setHideNum(value===\"enabled\");}}fetchData();},[]);// Funções para seleção múltipla CORRIGIDAS\nconst handleSelectContact=contactId=>{const newSelected=new Set(selectedContacts);if(newSelected.has(contactId)){newSelected.delete(contactId);}else{newSelected.add(contactId);}setSelectedContacts(newSelected);setSelectAllMode(false);// Desativa modo \"todos da empresa\" quando seleciona individualmente\n};const handleSelectAllContacts=()=>{if(selectAllMode){// Se já está em modo \"todos\", desmarcar tudo\nsetSelectedContacts(new Set());setSelectAllMode(false);}else{// Verificar se todos da página atual estão selecionados\nconst currentPageIds=contacts.map(contact=>contact.id);const allCurrentSelected=currentPageIds.every(id=>selectedContacts.has(id));if(allCurrentSelected&&selectedContacts.size===currentPageIds.length){// Se todos da página estão selecionados, ativar modo \"todos da empresa\"\nsetSelectAllMode(true);setSelectedContacts(new Set());// Limpar seleção individual\n}else{// Selecionar todos da página atual\nsetSelectedContacts(new Set(currentPageIds));setSelectAllMode(false);}}};// Limpar seleção quando contatos mudam\nuseEffect(()=>{setSelectedContacts(new Set());setSelectAllMode(false);},[searchParam,selectedTags]);// Função para obter contagem correta\nconst getSelectedCount=()=>{if(selectAllMode){return totalContactsCount;}return selectedContacts.size;};// Função para obter texto do botão\nconst getSelectionButtonText=()=>{if(selectAllMode){return\"Excluir Todos (\".concat(totalContactsCount,\")\");}if(selectedContacts.size>0){return\"Excluir Selecionados (\".concat(selectedContacts.size,\")\");}return\"Excluir\";};// Funções para exclusão múltipla CORRIGIDAS\nconst handleBulkDeleteClick=()=>{if(selectAllMode){setDeleteType('all');}else if(selectedContacts.size>0){setDeleteType('selected');}else{toast.warning(\"Selecione pelo menos um contato para excluir\");return;}setDeleteConfirmModalOpen(true);};const handleBulkDeleteConfirm=async()=>{try{if(deleteType==='all'){await api.delete(\"/contacts/all\",{data:{confirmation:\"DELETE_ALL_CONTACTS\",excludeIds:[]}});toast.success(\"Todos os \".concat(totalContactsCount,\" contatos foram exclu\\xEDdos\"));}else{const contactIds=Array.from(selectedContacts);await api.post(\"/contacts/bulk-delete\",{contactIds});toast.success(\"\".concat(contactIds.length,\" contatos exclu\\xEDdos com sucesso\"));}// Resetar seleções\nsetSelectedContacts(new Set());setSelectAllMode(false);// Atualizar lista\nsetSearchParam(\"\");setPageNumber(1);}catch(err){toastError(err);}finally{setDeleteConfirmModalOpen(false);setDeleteType('');}};const handleDeleteAllClick=()=>{setDeleteType('all');setDeleteConfirmModalOpen(true);};// Função para abrir modal da imagem\nconst handleOpenImageModal=(imageUrl,contactName)=>{setSelectedImage(imageUrl);setSelectedContactName(contactName);setImageModalOpen(true);};// Função para fechar modal da imagem\nconst handleCloseImageModal=()=>{setImageModalOpen(false);setSelectedImage('');setSelectedContactName('');};const handleImportExcel=async()=>{try{const formData=new FormData();formData.append(\"file\",fileUploadRef.current.files[0]);await api.request({url:\"/contacts/upload\",method:\"POST\",data:formData});history.go(0);}catch(err){toastError(err);}};useEffect(()=>{dispatch({type:\"RESET\"});setPageNumber(1);},[searchParam,selectedTags]);useEffect(()=>{setLoading(true);const delayDebounceFn=setTimeout(()=>{const fetchContacts=async()=>{try{const{data}=await api.get(\"/contacts/\",{params:{searchParam,pageNumber,contactTag:JSON.stringify(selectedTags)}});dispatch({type:\"LOAD_CONTACTS\",payload:data.contacts});setHasMore(data.hasMore);setTotalContactsCount(data.count);// Armazenar contagem total\nsetLoading(false);}catch(err){toastError(err);}};fetchContacts();},500);return()=>clearTimeout(delayDebounceFn);},[searchParam,pageNumber,selectedTags]);useEffect(()=>{const companyId=user.companyId;const onContactEvent=data=>{if(data.action===\"update\"||data.action===\"create\"){dispatch({type:\"UPDATE_CONTACTS\",payload:data.contact});}if(data.action===\"delete\"){dispatch({type:\"DELETE_CONTACT\",payload:+data.contactId});setTotalContactsCount(prev=>Math.max(0,prev-1));}if(data.action===\"bulk-delete\"){dispatch({type:\"BULK_DELETE_CONTACTS\",payload:data.contactIds});setTotalContactsCount(prev=>Math.max(0,prev-data.contactIds.length));}if(data.action===\"delete-all\"){dispatch({type:\"DELETE_ALL_CONTACTS\",payload:{excludeIds:data.excludeIds}});setTotalContactsCount(data.excludeIds.length);}};socket.on(\"company-\".concat(companyId,\"-contact\"),onContactEvent);return()=>{socket.off(\"company-\".concat(companyId,\"-contact\"),onContactEvent);};},[socket]);const handleSelectTicket=ticket=>{const code=uuidv4();const{id,uuid}=ticket;setCurrentTicket({id,uuid,code});};const handleCloseOrOpenTicket=ticket=>{setNewTicketModalOpen(false);if(ticket!==undefined&&ticket.uuid!==undefined){handleSelectTicket(ticket);history.push(\"/tickets/\".concat(ticket.uuid));}};const handleSelectedTags=selecteds=>{const tags=selecteds.map(t=>t.id);setSelectedTags(tags);};const handleSearch=event=>{setSearchParam(event.target.value.toLowerCase());};const handleOpenContactModal=()=>{setSelectedContactId(null);setContactModalOpen(true);};const handleCloseContactModal=()=>{setSelectedContactId(null);setContactModalOpen(false);};const hadleEditContact=contactId=>{setSelectedContactId(contactId);setContactModalOpen(true);};const handleDeleteContact=async contactId=>{try{await api.delete(\"/contacts/\".concat(contactId));toast.success(i18n.t(\"contacts.toasts.deleted\"));}catch(err){toastError(err);}setDeletingContact(null);setSearchParam(\"\");setPageNumber(1);};const handleBlockContact=async contactId=>{try{await api.put(\"/contacts/block/\".concat(contactId),{active:false});toast.success(\"Contato bloqueado\");}catch(err){toastError(err);}setDeletingContact(null);setSearchParam(\"\");setPageNumber(1);setBlockingContact(null);};const handleUnBlockContact=async contactId=>{try{await api.put(\"/contacts/block/\".concat(contactId),{active:true});toast.success(\"Contato desbloqueado\");}catch(err){toastError(err);}setDeletingContact(null);setSearchParam(\"\");setPageNumber(1);setUnBlockingContact(null);};const handleimportContact=async()=>{try{await api.post(\"/contacts/import\");history.go(0);setImportContacts(false);}catch(err){toastError(err);setImportContacts(false);}};const handleimportChats=async()=>{try{await api.post(\"/contacts/import/chats\");history.go(0);}catch(err){toastError(err);}};const loadMore=()=>{setPageNumber(prevState=>prevState+1);};const handleScroll=e=>{if(!hasMore||loading)return;const{scrollTop,scrollHeight,clientHeight}=e.currentTarget;if(scrollHeight-(scrollTop+100)<clientHeight){loadMore();}};// Determinar qual ação de confirmação executar para modais simples\nconst getConfirmAction=()=>{if(deletingContact)return()=>handleDeleteContact(deletingContact.id);if(blockingContact)return()=>handleBlockContact(blockingContact.id);if(unBlockingContact)return()=>handleUnBlockContact(unBlockingContact.id);if(ImportContacts)return handleimportContact;return handleImportExcel;};// Determinar título do modal de confirmação simples\nconst getConfirmTitle=()=>{if(deletingContact)return\"\".concat(i18n.t(\"contacts.confirmationModal.deleteTitle\"),\" \").concat(deletingContact.name,\"?\");if(blockingContact)return\"Bloquear Contato \".concat(blockingContact.name,\"?\");if(unBlockingContact)return\"Desbloquear Contato \".concat(unBlockingContact.name,\"?\");if(ImportContacts)return i18n.t(\"contacts.confirmationModal.importTitlte\");return i18n.t(\"contactListItems.confirmationModal.importTitlte\");};// Determinar mensagem do modal de confirmação simples\nconst getConfirmMessage=()=>{if(exportContact)return i18n.t(\"contacts.confirmationModal.exportContact\");if(deletingContact)return i18n.t(\"contacts.confirmationModal.deleteMessage\");if(blockingContact)return i18n.t(\"contacts.confirmationModal.blockContact\");if(unBlockingContact)return i18n.t(\"contacts.confirmationModal.unblockContact\");if(ImportContacts)return i18n.t(\"contacts.confirmationModal.importMessage\");return i18n.t(\"contactListItems.confirmationModal.importMessage\");};const selectedCount=getSelectedCount();const isAnyContactSelected=selectAllMode||selectedContacts.size>0;// Status do checkbox \"selecionar todos\"\nconst selectAllCheckboxStatus=()=>{if(selectAllMode)return{checked:true,indeterminate:false};const currentPageIds=contacts.map(contact=>contact.id);const selectedInCurrentPage=currentPageIds.filter(id=>selectedContacts.has(id)).length;if(selectedInCurrentPage===0){return{checked:false,indeterminate:false};}else if(selectedInCurrentPage===currentPageIds.length){return{checked:true,indeterminate:false};}else{return{checked:false,indeterminate:true};}};const checkboxStatus=selectAllCheckboxStatus();return/*#__PURE__*/_jsxs(MainContainer,{className:classes.mainContainer,children:[/*#__PURE__*/_jsx(NewTicketModal,{modalOpen:newTicketModalOpen,initialContact:contactTicket,onClose:ticket=>{handleCloseOrOpenTicket(ticket);}}),/*#__PURE__*/_jsx(ContactModal,{open:contactModalOpen,onClose:handleCloseContactModal,\"aria-labelledby\":\"form-dialog-title\",contactId:selectedContactId}),/*#__PURE__*/_jsx(ContactDeleteConfirmModal,{open:deleteConfirmModalOpen,onClose:()=>setDeleteConfirmModalOpen(false),onConfirm:handleBulkDeleteConfirm,deleteType:deleteType,selectedCount:selectedContacts.size,totalCount:totalContactsCount}),/*#__PURE__*/_jsxs(Dialog,{open:imageModalOpen,onClose:handleCloseImageModal,className:classes.imageDialog,maxWidth:\"md\",children:[/*#__PURE__*/_jsxs(DialogTitle,{className:classes.dialogTitle,children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Foto de Perfil - \",selectedContactName]}),/*#__PURE__*/_jsx(IconButton,{onClick:handleCloseImageModal,size:\"small\",children:/*#__PURE__*/_jsx(Close,{})})]}),/*#__PURE__*/_jsx(DialogContent,{children:selectedImage?/*#__PURE__*/_jsx(\"img\",{src:selectedImage,alt:\"Foto de perfil de \".concat(selectedContactName),className:classes.profileImage,onError:e=>{e.target.style.display='none';}}):/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'200px',color:'#666'},children:\"Imagem n\\xE3o dispon\\xEDvel\"})})]}),/*#__PURE__*/_jsx(ConfirmationModal,{title:getConfirmTitle(),open:confirmOpen,onClose:setConfirmOpen,onConfirm:getConfirmAction(),children:getConfirmMessage()}),/*#__PURE__*/_jsx(ConfirmationModal,{title:i18n.t(\"contacts.confirmationModal.importChat\"),open:confirmChatsOpen,onClose:setConfirmChatsOpen,onConfirm:e=>handleimportChats(),children:i18n.t(\"contacts.confirmationModal.wantImport\")}),/*#__PURE__*/_jsxs(MainHeader,{children:[/*#__PURE__*/_jsxs(Title,{children:[i18n.t(\"contacts.title\"),\" (\",totalContactsCount,\")\",isAnyContactSelected&&/*#__PURE__*/_jsxs(\"span\",{style:{color:'#f50057',marginLeft:8},children:[\"- \",selectedCount,\" selecionado(s) \",selectAllMode&&'(TODOS)']})]}),/*#__PURE__*/_jsxs(MainHeaderButtonsWrapper,{children:[/*#__PURE__*/_jsx(TagsFilter,{onFiltered:handleSelectedTags}),/*#__PURE__*/_jsx(TextField,{placeholder:i18n.t(\"contacts.searchPlaceholder\"),type:\"search\",value:searchParam,onChange:handleSearch,InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsx(SearchIcon,{color:\"secondary\"})})}}),isAnyContactSelected&&/*#__PURE__*/_jsx(\"div\",{className:classes.bulkActions,children:/*#__PURE__*/_jsx(Tooltip,{title:selectAllMode?\"Excluir todos os contatos\":\"Excluir contatos selecionados\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",startIcon:/*#__PURE__*/_jsx(DeleteOutlineIcon,{}),onClick:handleBulkDeleteClick,children:getSelectionButtonText()})})}),/*#__PURE__*/_jsx(PopupState,{variant:\"popover\",popupId:\"demo-popup-menu\",children:popupState=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(Button,_objectSpread(_objectSpread({variant:\"contained\",color:\"primary\"},bindTrigger(popupState)),{},{children:[i18n.t(\"contacts.menu.importexport\"),/*#__PURE__*/_jsx(ArrowDropDown,{})]})),/*#__PURE__*/_jsxs(Menu,_objectSpread(_objectSpread({},bindMenu(popupState)),{},{children:[/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>{setConfirmOpen(true);setImportContacts(true);popupState.close();},children:[/*#__PURE__*/_jsx(ContactPhone,{fontSize:\"small\",color:\"primary\",style:{marginRight:10}}),i18n.t(\"contacts.menu.importYourPhone\")]}),/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>{setImportContactModalOpen(true);},children:[/*#__PURE__*/_jsx(Backup,{fontSize:\"small\",color:\"primary\",style:{marginRight:10}}),i18n.t(\"contacts.menu.importToExcel\")]}),/*#__PURE__*/_jsx(Can,{role:user.profile,perform:\"contacts-page:deleteAllContacts\",yes:()=>/*#__PURE__*/_jsxs(MenuItem,{onClick:()=>{handleDeleteAllClick();popupState.close();},style:{color:'#f44336'},children:[/*#__PURE__*/_jsx(DeleteSweep,{fontSize:\"small\",style:{marginRight:10,color:'#f44336'}}),\"Excluir Todos os Contatos\"]})})]}))]})}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleOpenContactModal,children:i18n.t(\"contacts.buttons.add\")})]})]}),importContactModalOpen&&/*#__PURE__*/_jsx(ContactImportWpModal,{isOpen:importContactModalOpen,handleClose:()=>setImportContactModalOpen(false),selectedTags:selectedTags,hideNum:hideNum,userProfile:user.profile}),/*#__PURE__*/_jsxs(Paper,{className:classes.mainPaper,variant:\"outlined\",onScroll:handleScroll,children:[/*#__PURE__*/_jsx(\"input\",{style:{display:\"none\"},id:\"upload\",name:\"file\",type:\"file\",accept:\".xls,.xlsx\",onChange:()=>{setConfirmOpen(true);},ref:fileUploadRef}),isAnyContactSelected&&/*#__PURE__*/_jsxs(Toolbar,{className:\"\".concat(classes.toolbar,\" \").concat(classes.toolbarHighlight),children:[/*#__PURE__*/_jsxs(Typography,{className:classes.toolbarTitle,color:\"inherit\",variant:\"subtitle1\",children:[selectedCount,\" contato(s) selecionado(s) \",selectAllMode&&'(TODOS OS CONTATOS)']}),/*#__PURE__*/_jsxs(\"div\",{className:classes.bulkActions,children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Cancelar sele\\xE7\\xE3o\",children:/*#__PURE__*/_jsx(Button,{size:\"small\",onClick:()=>{setSelectedContacts(new Set());setSelectAllMode(false);},children:\"Cancelar\"})}),/*#__PURE__*/_jsx(Tooltip,{title:selectAllMode?\"Excluir todos os contatos\":\"Excluir selecionados\",children:/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",onClick:handleBulkDeleteClick,children:/*#__PURE__*/_jsx(DeleteOutlineIcon,{})})})]})]}),/*#__PURE__*/_jsxs(Table,{size:\"small\",children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{className:classes.checkboxCell,children:/*#__PURE__*/_jsx(Checkbox,{indeterminate:checkboxStatus.indeterminate,checked:checkboxStatus.checked,onChange:handleSelectAllContacts,disabled:contacts.length===0,inputProps:{'aria-label':'Selecionar todos os contatos'}})}),/*#__PURE__*/_jsx(TableCell,{className:classes.idCell,children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{className:classes.avatarCell,align:\"center\",children:\"Foto\"}),/*#__PURE__*/_jsx(TableCell,{children:i18n.t(\"contacts.table.name\")}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:i18n.t(\"contacts.table.whatsapp\")}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:i18n.t(\"contacts.table.email\")}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Status\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:i18n.t(\"contacts.table.wallet\")}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:i18n.t(\"contacts.table.actions\")})]})}),/*#__PURE__*/_jsx(TableBody,{children:/*#__PURE__*/_jsxs(_Fragment,{children:[contacts.map(contact=>{var _formatSerializedId,_contact$number,_contact$contactWalle;const isSelected=selectAllMode||selectedContacts.has(contact.id);return/*#__PURE__*/_jsxs(TableRow,{selected:isSelected,children:[/*#__PURE__*/_jsx(TableCell,{className:classes.checkboxCell,children:/*#__PURE__*/_jsx(Checkbox,{checked:isSelected,onChange:()=>handleSelectContact(contact.id),disabled:selectAllMode,inputProps:{'aria-label':\"Selecionar contato \".concat(contact.name)}})}),/*#__PURE__*/_jsx(TableCell,{className:classes.idCell,children:contact.id}),/*#__PURE__*/_jsx(TableCell,{className:classes.avatarCell,align:\"center\",children:/*#__PURE__*/_jsx(Avatar,{src:\"\".concat(contact===null||contact===void 0?void 0:contact.urlPicture),className:classes.clickableAvatar,onClick:()=>handleOpenImageModal(contact===null||contact===void 0?void 0:contact.urlPicture,contact.name)})}),/*#__PURE__*/_jsx(TableCell,{children:contact.name}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:enableLGPD&&hideNum&&user.profile===\"user\"?contact.isGroup?contact.number:formatSerializedId(contact===null||contact===void 0?void 0:contact.number)===null?contact.number.slice(0,-6)+\"**-**\"+(contact===null||contact===void 0?void 0:contact.number.slice(-2)):((_formatSerializedId=formatSerializedId(contact===null||contact===void 0?void 0:contact.number))===null||_formatSerializedId===void 0?void 0:_formatSerializedId.slice(0,-6))+\"**-**\"+(contact===null||contact===void 0?void 0:(_contact$number=contact.number)===null||_contact$number===void 0?void 0:_contact$number.slice(-2)):contact.isGroup?contact.number:formatSerializedId(contact===null||contact===void 0?void 0:contact.number)}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:contact.email}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:contact.active?/*#__PURE__*/_jsx(CheckCircleIcon,{style:{color:\"green\"},fontSize:\"small\"}):/*#__PURE__*/_jsx(CancelIcon,{style:{color:\"red\"},fontSize:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:contact.contactWallets&&contact.contactWallets.length>0?((_contact$contactWalle=contact.contactWallets[0].wallet)===null||_contact$contactWalle===void 0?void 0:_contact$contactWalle.name)||\"Usuário não encontrado\":\"Não atribuído\"}),/*#__PURE__*/_jsxs(TableCell,{align:\"center\",children:[/*#__PURE__*/_jsxs(IconButton,{size:\"small\",disabled:!contact.active,onClick:()=>{setContactTicket(contact);setNewTicketModalOpen(true);},children:[contact.channel===\"whatsapp\"&&/*#__PURE__*/_jsx(WhatsApp,{style:{color:\"green\"}}),contact.channel===\"instagram\"&&/*#__PURE__*/_jsx(Instagram,{style:{color:\"purple\"}}),contact.channel===\"facebook\"&&/*#__PURE__*/_jsx(Facebook,{style:{color:\"blue\"}})]}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:()=>hadleEditContact(contact.id),children:/*#__PURE__*/_jsx(EditIcon,{color:\"secondary\"})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:contact.active?()=>{setConfirmOpen(true);setBlockingContact(contact);}:()=>{setConfirmOpen(true);setUnBlockingContact(contact);},children:contact.active?/*#__PURE__*/_jsx(BlockIcon,{color:\"secondary\"}):/*#__PURE__*/_jsx(CheckCircleIcon,{color:\"secondary\"})}),/*#__PURE__*/_jsx(Can,{role:user.profile,perform:\"contacts-page:deleteContact\",yes:()=>/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>{setConfirmOpen(true);setDeletingContact(contact);},children:/*#__PURE__*/_jsx(DeleteOutlineIcon,{color:\"secondary\"})})})]})]},contact.id);}),loading&&/*#__PURE__*/_jsx(TableRowSkeleton,{avatar:true,columns:9})]})})]})]})]});};export default Contacts;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}